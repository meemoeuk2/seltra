#include "seltra.bmx.gui.release.win32.x64.h"
static BBString _s23={
	&bbStringClass,
	1,
	{32}
};
static BBString _s1={
	&bbStringClass,
	2,
	{32,32}
};
static BBString _s3={
	&bbStringClass,
	34,
	{32,98,103,114,111,117,112,32,58,32,98,111,116,104,32,120,118
	,32,97,110,100,32,121,118,32,110,111,110,32,122,101,114,111
	,32}
};
static BBString _s2={
	&bbStringClass,
	40,
	{32,98,103,114,111,117,112,44,32,109,111,118,101,32,44,32,98
	,111,116,104,32,120,118,32,97,110,100,32,121,118,32,110,111
	,110,32,122,101,114,111,32}
};
static BBString _s25={
	&bbStringClass,
	8,
	{32,108,101,32,102,105,110,32}
};
static BBString _s4={
	&bbStringClass,
	39,
	{32,115,103,114,111,117,112,44,32,109,111,118,101,44,32,120,118
	,32,97,110,100,32,121,118,32,98,111,116,104,32,110,111,110
	,32,122,101,114,111,32}
};
static BBString _s6={
	&bbStringClass,
	4,
	{46,112,110,103}
};
static BBString _s0={
	&bbStringClass,
	35,
	{78,111,32,115,112,97,99,101,32,116,111,32,105,110,99,114,101
	,97,115,101,32,100,101,113,117,101,32,99,97,112,97,99,105
	,116,121}
};
static BBString _s20={
	&bbStringClass,
	10,
	{97,114,114,111,119,101,46,112,110,103}
};
static BBString _s21={
	&bbStringClass,
	10,
	{97,114,114,111,119,110,46,112,110,103}
};
static BBString _s22={
	&bbStringClass,
	10,
	{97,114,114,111,119,115,46,112,110,103}
};
static BBString _s19={
	&bbStringClass,
	10,
	{97,114,114,111,119,119,46,112,110,103}
};
static BBString _s18={
	&bbStringClass,
	9,
	{98,108,97,110,107,46,112,110,103}
};
static BBString _s5={
	&bbStringClass,
	16,
	{98,108,111,99,107,115,50,92,98,108,111,99,107,97,114,116}
};
static BBString _s14={
	&bbStringClass,
	18,
	{98,108,111,99,107,115,50,92,98,108,111,99,107,98,46,112,110
	,103}
};
static BBString _s9={
	&bbStringClass,
	18,
	{98,108,111,99,107,115,50,92,98,108,111,99,107,99,46,112,110
	,103}
};
static BBString _s13={
	&bbStringClass,
	18,
	{98,108,111,99,107,115,50,92,98,108,111,99,107,100,46,112,110
	,103}
};
static BBString _s8={
	&bbStringClass,
	18,
	{98,108,111,99,107,115,50,92,98,108,111,99,107,111,46,112,110
	,103}
};
static BBString _s11={
	&bbStringClass,
	18,
	{98,108,111,99,107,115,50,92,98,108,111,99,107,113,46,112,110
	,103}
};
static BBString _s10={
	&bbStringClass,
	18,
	{98,108,111,99,107,115,50,92,98,108,111,99,107,115,46,112,110
	,103}
};
static BBString _s7={
	&bbStringClass,
	18,
	{98,108,111,99,107,115,50,92,98,108,111,99,107,119,46,112,110
	,103}
};
static BBString _s12={
	&bbStringClass,
	18,
	{98,108,111,99,107,115,50,92,98,108,111,99,107,120,46,112,110
	,103}
};
static BBString _s24={
	&bbStringClass,
	8,
	{102,105,110,105,115,104,101,100}
};
static BBString _s15={
	&bbStringClass,
	8,
	{103,101,110,101,46,112,110,103}
};
static BBString _s16={
	&bbStringClass,
	9,
	{109,111,117,115,101,46,112,110,103}
};
static BBString _s17={
	&bbStringClass,
	13,
	{109,111,117,115,101,99,101,108,108,46,112,110,103}
};
static BBString _s26={
	&bbStringClass,
	13,
	{115,101,108,116,114,97,77,97,112,46,115,101,109}
};
static BBString _s27={
	&bbStringClass,
	8,
	{115,117,98,48,46,112,110,103}
};
static BBString _s28={
	&bbStringClass,
	8,
	{115,117,98,100,46,112,110,103}
};
struct BBDebugScope_12{int kind; const char *name; BBDebugDecl decls[13]; };
struct BBDebugScope_13{int kind; const char *name; BBDebugDecl decls[14]; };
struct BBDebugScope_14{int kind; const char *name; BBDebugDecl decls[15]; };
struct BBDebugScope_15{int kind; const char *name; BBDebugDecl decls[16]; };
struct BBDebugScope_28{int kind; const char *name; BBDebugDecl decls[29]; };
struct BBDebugScope_29{int kind; const char *name; BBDebugDecl decls[30]; };
struct BBDebugScope_3{int kind; const char *name; BBDebugDecl decls[4]; };
struct BBDebugScope_4{int kind; const char *name; BBDebugDecl decls[5]; };
struct BBDebugScope_5{int kind; const char *name; BBDebugDecl decls[6]; };
struct BBDebugScope_6{int kind; const char *name; BBDebugDecl decls[7]; };
struct BBDebugScope_9{int kind; const char *name; BBDebugDecl decls[10]; };
BBINT _m_seltra_gw=0;
BBINT _m_seltra_gh=0;
BBARRAY _m_seltra_imagelist=(&bbEmptyArray);
BBARRAY _m_seltra_blockart=(&bbEmptyArray);
struct brl_max2d_image_TImage_obj* _m_seltra_blockw=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
BBINT _m_seltra_noi=0;
struct brl_max2d_image_TImage_obj* _m_seltra_loadimage3(BBSTRING bbt_fn){
	((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)_m_seltra_noi)]=(struct brl_max2d_image_TImage_obj*)brl_max2d_LoadImage((BBOBJECT)brl_pixmap_MaskPixmap((struct brl_pixmap_TPixmap_obj*)brl_pixmap_LoadPixmap((BBOBJECT)bbt_fn),255,255,255),-1);
	_m_seltra_noi=(_m_seltra_noi+1);
	return (struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)(_m_seltra_noi-1))];
}
struct brl_max2d_image_TImage_obj* _m_seltra_blocko=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_blockc=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_blocks=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_blockq=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_blockx=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_blockd=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_blockb=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_gencell=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
void __m_seltra_btemplate_New(struct _m_seltra_btemplate_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_btemplate;
	o->__m_seltra_btemplate_btype = 0;
	o->__m_seltra_btemplate_ch = 0;
	o->__m_seltra_btemplate_id = 0;
	o->__m_seltra_btemplate_maxbonds = 0;
	o->__m_seltra_btemplate_bonds2 = 0;
}
BBINT __m_seltra_btemplate_create_block_image_i(struct _m_seltra_btemplate_obj* o,BBINT bbt_grey){
	BBINT bbt_bred=0;
	BBINT bbt_bgre=0;
	BBINT bbt_bblu=0;
	struct brl_max2d_image_TImage_obj* bbt_blockart=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
	bbt_bred=((BBINT)(((100.0f*_m_seltra_colfunc(((BBFLOAT)o->__m_seltra_btemplate_maxbonds )/7.0f))+((BBFLOAT)brl_random_Rand(20,1)))+120.000000f));
	bbt_bgre=((BBINT)((150.0f*_m_seltra_colfunc((2.3f+((BBFLOAT)o->__m_seltra_btemplate_maxbonds ))/7.0f))+30.0000000f));
	bbt_bblu=((BBINT)((150.0f*_m_seltra_colfunc((4.7f+((BBFLOAT)o->__m_seltra_btemplate_maxbonds ))/7.0f))+50.0000000f));
	if(bbt_grey!=0){
		bbt_bred=(((bbt_bred+bbt_bgre)+bbt_bblu)/3);
		bbt_bgre=(((bbt_bred+bbt_bgre)+bbt_bblu)/3);
		bbt_bblu=(((bbt_bred+bbt_bgre)+bbt_bblu)/3);
	}
	brl_max2d_SetViewport(0,0,30,30);
	brl_max2d_SetMaskColor(0,0,0);
	brl_max2d_SetColor(0,0,0);
	brl_max2d_DrawRect(0.000000000f,0.000000000f,30.0000000f,30.0000000f);
	bbt_blockart=(struct brl_max2d_image_TImage_obj*)brl_max2d_LoadImage((BBOBJECT)brl_pixmap_MaskPixmap((struct brl_pixmap_TPixmap_obj*)brl_pixmap_LoadPixmap((BBOBJECT)bbStringConcat(bbStringConcat(&_s5,bbStringFromInt(o->__m_seltra_btemplate_ch )),&_s6)),255,255,255),-1);
	brl_max2d_SetColor((bbt_bred+20),(bbt_bgre+40),(bbt_bblu+40));
	brl_max2d_DrawRect(0.000000000f,0.000000000f,30.0000000f,30.0000000f);
	brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)bbt_blockart,0.000000000f,0.000000000f,0);
	brl_max2d_SetMaskColor(0,0,0);
	brl_max2d_GrabImage((struct brl_max2d_image_TImage_obj*)bbt_blockart,0,0,0);
	brl_max2d_Cls();
	((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)_m_seltra_noi)]=(struct brl_max2d_image_TImage_obj*)brl_max2d_CreateImage(30,30,1,0);
	brl_max2d_SetColor(bbt_bred,bbt_bgre,bbt_bblu);
	brl_max2d_DrawRect(0.000000000f,0.000000000f,30.0000000f,30.0000000f);
	brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)bbt_blockart,0.000000000f,0.000000000f,0);
	brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)o->__m_seltra_btemplate_btype )],0.000000000f,0.000000000f,0);
	brl_max2d_SetColor(200,50,50);
	if(((unsigned int)(o->__m_seltra_btemplate_bonds2 )&(unsigned int)(1))!=0){
		brl_max2d_DrawRect(13.0000000f,0.000000000f,3.00000000f,10.0000000f);
	}
	if(((unsigned int)(o->__m_seltra_btemplate_bonds2 )&(unsigned int)(4))!=0){
		brl_max2d_DrawRect(13.0000000f,20.0000000f,3.00000000f,10.0000000f);
	}
	if(((unsigned int)(o->__m_seltra_btemplate_bonds2 )&(unsigned int)(2))!=0){
		brl_max2d_DrawRect(0.000000000f,13.0000000f,10.0000000f,3.00000000f);
	}
	if(((unsigned int)(o->__m_seltra_btemplate_bonds2 )&(unsigned int)(8))!=0){
		brl_max2d_DrawRect(20.0000000f,13.0000000f,10.0000000f,3.00000000f);
	}
	brl_max2d_GrabImage((struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)_m_seltra_noi)],0,0,0);
	_m_seltra_noi=(_m_seltra_noi+1);
	return 0;
}
struct _m_seltra_bgroup_obj* __m_seltra_btemplate_createsingleblock_iiii(struct _m_seltra_btemplate_obj* o,BBINT bbt_x,BBINT bbt_y,BBINT bbt_xv,BBINT bbt_yv){
	if(((BBObject*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_x+(bbt_y<<10))))!= &bbNullObject){
		return (struct _m_seltra_bgroup_obj*)(&bbNullObject);
	}
	if(o->__m_seltra_btemplate_btype ==0){
		_m_seltra_wallblock(bbt_x,bbt_y,o->__m_seltra_btemplate_id );
		return (struct _m_seltra_bgroup_obj*)(&bbNullObject);
	}
	struct _m_seltra_bgroup_obj* bbt_bg=(struct _m_seltra_bgroup_obj*)(struct _m_seltra_bgroup_obj*)bbObjectNew((BBClass *)&_m_seltra_bgroup);
	bbt_bg->__m_seltra_bgroup_xv =bbt_xv;
	bbt_bg->__m_seltra_bgroup_yv =bbt_yv;
	_m_seltra_bgc=(_m_seltra_bgc+1);
	(_m_seltra_garray)->clas->m_add_Tbgroup((struct _m_seltra_grouparray_obj*)_m_seltra_garray,(struct _m_seltra_bgroup_obj*)bbt_bg);
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(struct _m_seltra_block_obj*)bbObjectNew((BBClass *)&_m_seltra_block);
	bbt_b->__m_seltra_block_x =bbt_x;
	bbt_b->__m_seltra_block_y =bbt_y;
	bbt_b->__m_seltra_block_btype =o->__m_seltra_btemplate_btype ;
	bbt_b->__m_seltra_block_bt =o->__m_seltra_btemplate_id ;
	bbt_b->__m_seltra_block_maxbonds =o->__m_seltra_btemplate_maxbonds ;
	bbt_b->__m_seltra_block_bonds =o->__m_seltra_btemplate_maxbonds ;
	bbt_b->__m_seltra_block_bonds2 =o->__m_seltra_btemplate_bonds2 ;
	bbt_b->__m_seltra_block_image =(struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)o->__m_seltra_btemplate_id )];
	(bbt_bg)->clas->m_add_Tblock((struct _m_seltra_bgroup_obj*)bbt_bg,(struct _m_seltra_block_obj*)bbt_b);
	(_m_seltra_barray)->clas->m_add_Tblock((struct _m_seltra_blockarray_obj*)_m_seltra_barray,(struct _m_seltra_block_obj*)bbt_b);
	(_m_seltra_bmap)->clas->m_insert_iTblock((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +(bbt_b->__m_seltra_block_y <<10)),(struct _m_seltra_block_obj*)bbt_b);
	return (struct _m_seltra_bgroup_obj*)bbt_bg;
}
BBINT __m_seltra_btemplate_setbindingblock_ii(struct _m_seltra_btemplate_obj* o,BBINT bbt_x,BBINT bbt_y){
	struct _m_seltra_bgroup_obj* bbt_bg=(struct _m_seltra_bgroup_obj*)(&bbNullObject);
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_x+(bbt_y<<10)));
	struct _m_seltra_block_obj* bbt_b2=(struct _m_seltra_block_obj*)(&bbNullObject);
	if(bbt_b==&bbNullObject){
		bbt_bg=(struct _m_seltra_bgroup_obj*)((struct _m_seltra_btemplate_obj*)o)->clas->m_createsingleblock_iiii((struct _m_seltra_btemplate_obj*)o,bbt_x,bbt_y,0,0);
	}else{
		bbt_bg=(struct _m_seltra_bgroup_obj*)bbt_b->__m_seltra_block_group ;
	}
	bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_bg->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	if(bbt_x>0){
		bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((bbt_x-1)+(bbt_y<<10)));
	}
	if(((((BBObject*)bbt_b2)!= &bbNullObject) && (bbt_b2->__m_seltra_block_btype >0)) && ((bbt_b)->clas->m_checkchem2_Tblock((struct _m_seltra_block_obj*)bbt_b,(struct _m_seltra_block_obj*)bbt_b2)!=0)){
		(bbt_bg)->clas->m_merge_Tbgroup((struct _m_seltra_bgroup_obj*)bbt_bg,(struct _m_seltra_bgroup_obj*)bbt_b2->__m_seltra_block_group );
		(bbt_b)->clas->m_get_moli_chem((struct _m_seltra_block_obj*)bbt_b);
		(bbt_b2)->clas->m_get_moli_chem((struct _m_seltra_block_obj*)bbt_b2);
	}
	if(bbt_y>0){
		bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_x+((bbt_y-1)<<10)));
	}
	if(((((BBObject*)bbt_b2)!= &bbNullObject) && (bbt_b2->__m_seltra_block_btype >0)) && ((bbt_b)->clas->m_checkchem2_Tblock((struct _m_seltra_block_obj*)bbt_b,(struct _m_seltra_block_obj*)bbt_b2)!=0)){
		(bbt_bg)->clas->m_merge_Tbgroup((struct _m_seltra_bgroup_obj*)bbt_bg,(struct _m_seltra_bgroup_obj*)bbt_b2->__m_seltra_block_group );
		(bbt_b)->clas->m_get_moli_chem((struct _m_seltra_block_obj*)bbt_b);
		(bbt_b2)->clas->m_get_moli_chem((struct _m_seltra_block_obj*)bbt_b2);
	}
	bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((bbt_x+1)+(bbt_y<<10)));
	if(((((BBObject*)bbt_b2)!= &bbNullObject) && (bbt_b2->__m_seltra_block_btype >0)) && ((bbt_b)->clas->m_checkchem2_Tblock((struct _m_seltra_block_obj*)bbt_b,(struct _m_seltra_block_obj*)bbt_b2)!=0)){
		(bbt_bg)->clas->m_merge_Tbgroup((struct _m_seltra_bgroup_obj*)bbt_bg,(struct _m_seltra_bgroup_obj*)bbt_b2->__m_seltra_block_group );
		(bbt_b)->clas->m_get_moli_chem((struct _m_seltra_block_obj*)bbt_b);
		(bbt_b2)->clas->m_get_moli_chem((struct _m_seltra_block_obj*)bbt_b2);
	}
	bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_x+((bbt_y+1)<<10)));
	if(((((BBObject*)bbt_b2)!= &bbNullObject) && (bbt_b2->__m_seltra_block_btype >0)) && ((bbt_b)->clas->m_checkchem2_Tblock((struct _m_seltra_block_obj*)bbt_b,(struct _m_seltra_block_obj*)bbt_b2)!=0)){
		(bbt_bg)->clas->m_merge_Tbgroup((struct _m_seltra_bgroup_obj*)bbt_bg,(struct _m_seltra_bgroup_obj*)bbt_b2->__m_seltra_block_group );
		(bbt_b)->clas->m_get_moli_chem((struct _m_seltra_block_obj*)bbt_b);
		(bbt_b2)->clas->m_get_moli_chem((struct _m_seltra_block_obj*)bbt_b2);
	}
	return 0;
}
struct BBDebugScope_9 _m_seltra_btemplate_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"btemplate",
	{
		{
			BBDEBUGDECL_FIELD,
			"btype",
			"i",
			.field_offset=offsetof(struct _m_seltra_btemplate_obj,__m_seltra_btemplate_btype)
		},
		{
			BBDEBUGDECL_FIELD,
			"ch",
			"i",
			.field_offset=offsetof(struct _m_seltra_btemplate_obj,__m_seltra_btemplate_ch)
		},
		{
			BBDEBUGDECL_FIELD,
			"id",
			"i",
			.field_offset=offsetof(struct _m_seltra_btemplate_obj,__m_seltra_btemplate_id)
		},
		{
			BBDEBUGDECL_FIELD,
			"maxbonds",
			"i",
			.field_offset=offsetof(struct _m_seltra_btemplate_obj,__m_seltra_btemplate_maxbonds)
		},
		{
			BBDEBUGDECL_FIELD,
			"bonds2",
			"i",
			.field_offset=offsetof(struct _m_seltra_btemplate_obj,__m_seltra_btemplate_bonds2)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_btemplate_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"create_block_image",
			"(i)i",
			.var_address=(void*)&__m_seltra_btemplate_create_block_image_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"createsingleblock",
			"(i,i,i,i):bgroup",
			.var_address=(void*)&__m_seltra_btemplate_createsingleblock_iiii
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"setbindingblock",
			"(i,i)i",
			.var_address=(void*)&__m_seltra_btemplate_setbindingblock_ii
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_btemplate _m_seltra_btemplate={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_btemplate_scope,
	sizeof(struct _m_seltra_btemplate_obj),
	(void (*)(BBOBJECT))__m_seltra_btemplate_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_btemplate_obj,__m_seltra_btemplate_bonds2) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_btemplate_create_block_image_i
	,__m_seltra_btemplate_createsingleblock_iiii
	,__m_seltra_btemplate_setbindingblock_ii
};

BBARRAY _m_seltra_btarray=(&bbEmptyArray);
struct brl_max2d_image_TImage_obj* _m_seltra_mousep=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_mousec=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_blank=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_arroww=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_arrowe=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_arrown=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_arrows=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
BBBYTE _m_seltra_frame=0;
BBINT _m_seltra_mox=0;
BBINT _m_seltra_moy=0;
BBINT _m_seltra_moz=0;
BBARRAY _m_seltra_moxo=(&bbEmptyArray);
BBARRAY _m_seltra_moyo=(&bbEmptyArray);
struct brl_max2d_image_TImage_obj* _m_seltra_smi=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
BBINT _m_seltra_smt=0;
BBFLOAT _m_seltra_zoom=30.0f;
BBINT _m_seltra_mozo=0;
BBFLOAT _m_seltra_mozu=.00000000f;
BBINT _m_seltra_moxc=0;
BBINT _m_seltra_moyc=0;
BBARRAY _m_seltra_moxco=(&bbEmptyArray);
BBARRAY _m_seltra_moyco=(&bbEmptyArray);
BBINT _m_seltra_redraw_map=3;
BBINT _m_seltra_bgc=0;
BBINT _m_seltra_bc=0;
BBINT _m_seltra_sgc=0;
BBINT _m_seltra_sc=0;
BBINT _m_seltra_camposx=0;
BBINT _m_seltra_camposy=0;
BBINT _m_seltra_time=0;
BBINT _m_seltra_gamespeedbrake=100;
BBINT _m_seltra_gamespeedbrake_setting=2;
void __m_seltra_grouparray_New(struct _m_seltra_grouparray_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_grouparray;
	o->__m_seltra_grouparray_ga = bbArrayNew1D(":bgroup", 2000000);
	o->__m_seltra_grouparray_le = 0;
}
BBINT __m_seltra_grouparray_add_Tbgroup(struct _m_seltra_grouparray_obj* o,struct _m_seltra_bgroup_obj* bbt_g){
	((struct _m_seltra_bgroup_obj**)BBARRAYDATA(o->__m_seltra_grouparray_ga ,1))[((BBUINT)o->__m_seltra_grouparray_le )]=(struct _m_seltra_bgroup_obj*)bbt_g;
	bbt_g->__m_seltra_bgroup_id =o->__m_seltra_grouparray_le ;
	o->__m_seltra_grouparray_le =(o->__m_seltra_grouparray_le +1);
	return 0;
}
BBINT __m_seltra_grouparray_ordered_sort_ii(struct _m_seltra_grouparray_obj* o,BBINT bbt_n,BBINT bbt_i){
	if(bbt_n==0){
		bbt_n=o->__m_seltra_grouparray_le ;
	}
	BBINT bbt_j=bbt_i;
	while(bbt_j<o->__m_seltra_grouparray_le ){
		((struct _m_seltra_bgroup_obj**)BBARRAYDATA(o->__m_seltra_grouparray_ga ,1))[((BBUINT)bbt_i)]=(struct _m_seltra_bgroup_obj*)((struct _m_seltra_bgroup_obj**)BBARRAYDATA(o->__m_seltra_grouparray_ga ,1))[((BBUINT)bbt_j)];
		if(((BBObject*)((struct _m_seltra_bgroup_obj**)BBARRAYDATA(o->__m_seltra_grouparray_ga ,1))[((BBUINT)bbt_i)])!= &bbNullObject){
			((struct _m_seltra_bgroup_obj**)BBARRAYDATA(o->__m_seltra_grouparray_ga ,1))[((BBUINT)bbt_i)]->__m_seltra_bgroup_id =bbt_i;
			bbt_i=(bbt_i+1);
		}
		bbt_j=(bbt_j+1);
	}
	o->__m_seltra_grouparray_le =bbt_i;
	return 0;
}
struct BBDebugScope_5 _m_seltra_grouparray_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"grouparray",
	{
		{
			BBDEBUGDECL_FIELD,
			"ga",
			"[]:bgroup",
			.field_offset=offsetof(struct _m_seltra_grouparray_obj,__m_seltra_grouparray_ga)
		},
		{
			BBDEBUGDECL_FIELD,
			"le",
			"i",
			.field_offset=offsetof(struct _m_seltra_grouparray_obj,__m_seltra_grouparray_le)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_grouparray_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"add",
			"(:bgroup)i",
			.var_address=(void*)&__m_seltra_grouparray_add_Tbgroup
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"ordered_sort",
			"(i,i)i",
			.var_address=(void*)&__m_seltra_grouparray_ordered_sort_ii
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_grouparray _m_seltra_grouparray={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_grouparray_scope,
	sizeof(struct _m_seltra_grouparray_obj),
	(void (*)(BBOBJECT))__m_seltra_grouparray_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_grouparray_obj,__m_seltra_grouparray_le) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_grouparray_add_Tbgroup
	,__m_seltra_grouparray_ordered_sort_ii
};

struct _m_seltra_grouparray_obj* _m_seltra_garray=(struct _m_seltra_grouparray_obj*)(&bbNullObject);
void __m_seltra_blockarray_New(struct _m_seltra_blockarray_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_blockarray;
	o->__m_seltra_blockarray_ba = bbArrayNew1D(":block", 50);
	o->__m_seltra_blockarray_le = 0;
}
BBINT __m_seltra_blockarray_add_Tblock(struct _m_seltra_blockarray_obj* o,struct _m_seltra_block_obj* bbt_b){
	((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_blockarray_ba ,1))[((BBUINT)o->__m_seltra_blockarray_le )]=(struct _m_seltra_block_obj*)bbt_b;
	if(o==_m_seltra_barray){
		bbt_b->__m_seltra_block_id =o->__m_seltra_blockarray_le ;
	}
	o->__m_seltra_blockarray_le =(o->__m_seltra_blockarray_le +1);
	return 0;
}
BBINT __m_seltra_blockarray_putLast_i(struct _m_seltra_blockarray_obj* o,BBINT bbt_i){
	((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_blockarray_ba ,1))[((BBUINT)o->__m_seltra_blockarray_le )]=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
	((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)]=(struct _m_seltra_block_obj*)&bbNullObject;
	o->__m_seltra_blockarray_le =(o->__m_seltra_blockarray_le +1);
	return 0;
}
BBINT __m_seltra_blockarray_ordered_sort_ii(struct _m_seltra_blockarray_obj* o,BBINT bbt_n,BBINT bbt_i){
	if(bbt_n==0){
		bbt_n=o->__m_seltra_blockarray_le ;
	}
	BBINT bbt_j=bbt_i;
	while(bbt_j<o->__m_seltra_blockarray_le ){
		((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)]=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_j)];
		if(((BBObject*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)])!= &bbNullObject){
			((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)]->__m_seltra_block_id =bbt_i;
			bbt_i=(bbt_i+1);
		}
		bbt_j=(bbt_j+1);
	}
	o->__m_seltra_blockarray_le =bbt_i;
	return 0;
}
struct BBDebugScope_6 _m_seltra_blockarray_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"blockarray",
	{
		{
			BBDEBUGDECL_FIELD,
			"ba",
			"[]:block",
			.field_offset=offsetof(struct _m_seltra_blockarray_obj,__m_seltra_blockarray_ba)
		},
		{
			BBDEBUGDECL_FIELD,
			"le",
			"i",
			.field_offset=offsetof(struct _m_seltra_blockarray_obj,__m_seltra_blockarray_le)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_blockarray_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"add",
			"(:block)i",
			.var_address=(void*)&__m_seltra_blockarray_add_Tblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"putLast",
			"(i)i",
			.var_address=(void*)&__m_seltra_blockarray_putLast_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"ordered_sort",
			"(i,i)i",
			.var_address=(void*)&__m_seltra_blockarray_ordered_sort_ii
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_blockarray _m_seltra_blockarray={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_blockarray_scope,
	sizeof(struct _m_seltra_blockarray_obj),
	(void (*)(BBOBJECT))__m_seltra_blockarray_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_blockarray_obj,__m_seltra_blockarray_le) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_blockarray_add_Tblock
	,__m_seltra_blockarray_putLast_i
	,__m_seltra_blockarray_ordered_sort_ii
};

struct _m_seltra_blockarray_obj* _m_seltra_barray=(struct _m_seltra_blockarray_obj*)(&bbNullObject);
void __m_seltra_subarray_New(struct _m_seltra_subarray_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_subarray;
	o->__m_seltra_subarray_sa = bbArrayNew1D(":substrate", 50);
	o->__m_seltra_subarray_le = 0;
}
BBINT __m_seltra_subarray_add_Tsubstrate(struct _m_seltra_subarray_obj* o,struct _m_seltra_substrate_obj* bbt_s){
	((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_subarray_sa ,1))[((BBUINT)o->__m_seltra_subarray_le )]=(struct _m_seltra_substrate_obj*)bbt_s;
	if(o==_m_seltra_sarray){
		bbt_s->__m_seltra_substrate_id =o->__m_seltra_subarray_le ;
	}
	o->__m_seltra_subarray_le =(o->__m_seltra_subarray_le +1);
	return 0;
}
BBINT __m_seltra_subarray_ordered_sort_ii(struct _m_seltra_subarray_obj* o,BBINT bbt_n,BBINT bbt_i){
	if(bbt_n==0){
		bbt_n=o->__m_seltra_subarray_le ;
	}
	BBINT bbt_j=bbt_i;
	while(bbt_j<o->__m_seltra_subarray_le ){
		((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)]=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_j)];
		if(((BBObject*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)])!= &bbNullObject){
			((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)]->__m_seltra_substrate_id =bbt_i;
			bbt_i=(bbt_i+1);
		}
		bbt_j=(bbt_j+1);
	}
	o->__m_seltra_subarray_le =bbt_i;
	return 0;
}
struct BBDebugScope_5 _m_seltra_subarray_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"subarray",
	{
		{
			BBDEBUGDECL_FIELD,
			"sa",
			"[]:substrate",
			.field_offset=offsetof(struct _m_seltra_subarray_obj,__m_seltra_subarray_sa)
		},
		{
			BBDEBUGDECL_FIELD,
			"le",
			"i",
			.field_offset=offsetof(struct _m_seltra_subarray_obj,__m_seltra_subarray_le)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_subarray_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"add",
			"(:substrate)i",
			.var_address=(void*)&__m_seltra_subarray_add_Tsubstrate
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"ordered_sort",
			"(i,i)i",
			.var_address=(void*)&__m_seltra_subarray_ordered_sort_ii
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_subarray _m_seltra_subarray={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_subarray_scope,
	sizeof(struct _m_seltra_subarray_obj),
	(void (*)(BBOBJECT))__m_seltra_subarray_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_subarray_obj,__m_seltra_subarray_le) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_subarray_add_Tsubstrate
	,__m_seltra_subarray_ordered_sort_ii
};

struct _m_seltra_subarray_obj* _m_seltra_sarray=(struct _m_seltra_subarray_obj*)(&bbNullObject);
void __m_seltra_subgrouparray_New(struct _m_seltra_subgrouparray_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_subgrouparray;
	o->__m_seltra_subgrouparray_sga = bbArrayNew1D(":sgroup", 50);
	o->__m_seltra_subgrouparray_le = 0;
}
BBINT __m_seltra_subgrouparray_add_Tsgroup(struct _m_seltra_subgrouparray_obj* o,struct _m_seltra_sgroup_obj* bbt_sg){
	((struct _m_seltra_sgroup_obj**)BBARRAYDATA(o->__m_seltra_subgrouparray_sga ,1))[((BBUINT)o->__m_seltra_subgrouparray_le )]=(struct _m_seltra_sgroup_obj*)bbt_sg;
	bbt_sg->__m_seltra_sgroup_id =o->__m_seltra_subgrouparray_le ;
	o->__m_seltra_subgrouparray_le =(o->__m_seltra_subgrouparray_le +1);
	return 0;
}
BBINT __m_seltra_subgrouparray_ordered_sort_ii(struct _m_seltra_subgrouparray_obj* o,BBINT bbt_n,BBINT bbt_i){
	if(bbt_n==0){
		bbt_n=o->__m_seltra_subgrouparray_le ;
	}
	BBINT bbt_j=bbt_i;
	while(bbt_j<o->__m_seltra_subgrouparray_le ){
		((struct _m_seltra_sgroup_obj**)BBARRAYDATA(o->__m_seltra_subgrouparray_sga ,1))[((BBUINT)bbt_i)]=(struct _m_seltra_sgroup_obj*)((struct _m_seltra_sgroup_obj**)BBARRAYDATA(o->__m_seltra_subgrouparray_sga ,1))[((BBUINT)bbt_j)];
		if(((BBObject*)((struct _m_seltra_sgroup_obj**)BBARRAYDATA(o->__m_seltra_subgrouparray_sga ,1))[((BBUINT)bbt_i)])!= &bbNullObject){
			((struct _m_seltra_sgroup_obj**)BBARRAYDATA(o->__m_seltra_subgrouparray_sga ,1))[((BBUINT)bbt_i)]->__m_seltra_sgroup_id =bbt_i;
			bbt_i=(bbt_i+1);
		}
		bbt_j=(bbt_j+1);
	}
	o->__m_seltra_subgrouparray_le =bbt_i;
	return 0;
}
struct BBDebugScope_5 _m_seltra_subgrouparray_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"subgrouparray",
	{
		{
			BBDEBUGDECL_FIELD,
			"sga",
			"[]:sgroup",
			.field_offset=offsetof(struct _m_seltra_subgrouparray_obj,__m_seltra_subgrouparray_sga)
		},
		{
			BBDEBUGDECL_FIELD,
			"le",
			"i",
			.field_offset=offsetof(struct _m_seltra_subgrouparray_obj,__m_seltra_subgrouparray_le)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_subgrouparray_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"add",
			"(:sgroup)i",
			.var_address=(void*)&__m_seltra_subgrouparray_add_Tsgroup
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"ordered_sort",
			"(i,i)i",
			.var_address=(void*)&__m_seltra_subgrouparray_ordered_sort_ii
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_subgrouparray _m_seltra_subgrouparray={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_subgrouparray_scope,
	sizeof(struct _m_seltra_subgrouparray_obj),
	(void (*)(BBOBJECT))__m_seltra_subgrouparray_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_subgrouparray_obj,__m_seltra_subgrouparray_le) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_subgrouparray_add_Tsgroup
	,__m_seltra_subgrouparray_ordered_sort_ii
};

struct _m_seltra_subgrouparray_obj* _m_seltra_sgarray=(struct _m_seltra_subgrouparray_obj*)(&bbNullObject);
void __m_seltra_block_New(struct _m_seltra_block_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_block;
	o->__m_seltra_block_btype = 0;
	o->__m_seltra_block_image = (struct brl_max2d_image_TImage_obj*)(&bbNullObject);
	o->__m_seltra_block_x = 0;
	o->__m_seltra_block_y = 0;
	o->__m_seltra_block_bit_tags = 0;
	o->__m_seltra_block_id = 0;
	o->__m_seltra_block_oldx = bbArrayNew1D("i", 2);
	o->__m_seltra_block_oldy = bbArrayNew1D("i", 2);
	o->__m_seltra_block_group = (struct _m_seltra_bgroup_obj*)(&bbNullObject);
	o->__m_seltra_block_ch = 0;
	o->__m_seltra_block_mch = 0;
	o->__m_seltra_block_bt = 0;
	o->__m_seltra_block_bonds = 0;
	o->__m_seltra_block_maxbonds = 0;
	o->__m_seltra_block_bond = bbArrayNew1D(":block", 4);
	o->__m_seltra_block_bonds2 = 0;
}
BBINT __m_seltra_block_Del(struct _m_seltra_block_obj* o){
	(o->__m_seltra_block_group )->clas->m_remove_block_Tblock((struct _m_seltra_bgroup_obj*)o->__m_seltra_block_group ,(struct _m_seltra_block_obj*)o);
	((struct _m_seltra_block_obj**)BBARRAYDATA(_m_seltra_barray->__m_seltra_blockarray_ba ,1))[((BBUINT)o->__m_seltra_block_id )]=(struct _m_seltra_block_obj*)&bbNullObject;
	(_m_seltra_bmap)->clas->m_remove_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(o->__m_seltra_block_x +(o->__m_seltra_block_y <<10)));
	struct _m_seltra_redraw_obj* bbt_re=(struct _m_seltra_redraw_obj*)(struct _m_seltra_redraw_obj*)bbObjectAtomicNew((BBClass *)&_m_seltra_redraw);
	bbt_re->__m_seltra_redraw_x =((BBINT*)BBARRAYDATA(o->__m_seltra_block_oldx ,1))[((BBUINT)_m_seltra_frame)];
	bbt_re->__m_seltra_redraw_y =((BBINT*)BBARRAYDATA(o->__m_seltra_block_oldy ,1))[((BBUINT)_m_seltra_frame)];
	bbt_re->__m_seltra_redraw_redraws =2;
	(_m_seltra_rarray)->clas->m_add_Tredraw((struct _m_seltra_redrawarray_obj*)_m_seltra_rarray,(struct _m_seltra_redraw_obj*)bbt_re);
	bbt_re=(struct _m_seltra_redraw_obj*)(struct _m_seltra_redraw_obj*)bbObjectAtomicNew((BBClass *)&_m_seltra_redraw);
	bbt_re->__m_seltra_redraw_x =((BBINT*)BBARRAYDATA(o->__m_seltra_block_oldx ,1))[((BBUINT)(1-((BBINT)_m_seltra_frame)))];
	bbt_re->__m_seltra_redraw_y =((BBINT*)BBARRAYDATA(o->__m_seltra_block_oldy ,1))[((BBUINT)(1-((BBINT)_m_seltra_frame)))];
	bbt_re->__m_seltra_redraw_redraws =2;
	(_m_seltra_rarray)->clas->m_add_Tredraw((struct _m_seltra_redrawarray_obj*)_m_seltra_rarray,(struct _m_seltra_redraw_obj*)bbt_re);
	return 0;
}
BBINT __m_seltra_block_draw(struct _m_seltra_block_obj* o){
	brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)_m_seltra_blank,(((BBFLOAT)(((BBINT*)BBARRAYDATA(o->__m_seltra_block_oldx ,1))[((BBUINT)_m_seltra_frame)]-_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(((BBINT*)BBARRAYDATA(o->__m_seltra_block_oldy ,1))[((BBUINT)_m_seltra_frame)]-_m_seltra_camposy))*_m_seltra_zoom),0);
	brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)o->__m_seltra_block_image ,(((BBFLOAT)(o->__m_seltra_block_x -_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(o->__m_seltra_block_y -_m_seltra_camposy))*_m_seltra_zoom),0);
	((BBINT*)BBARRAYDATA(o->__m_seltra_block_oldx ,1))[((BBUINT)_m_seltra_frame)]=o->__m_seltra_block_x ;
	((BBINT*)BBARRAYDATA(o->__m_seltra_block_oldy ,1))[((BBUINT)_m_seltra_frame)]=o->__m_seltra_block_y ;
	return 0;
}
BBINT __m_seltra_block_out_of_bounds(struct _m_seltra_block_obj* o){
	if((((o->__m_seltra_block_x <1) || (o->__m_seltra_block_x >1000)) || (o->__m_seltra_block_y <1)) || (o->__m_seltra_block_y >1000)){
		return 1;
	}
	return 0;
}
struct _m_seltra_block_obj* __m_seltra_block_spawn_ii(struct _m_seltra_block_obj* o,BBINT bbt_xs,BBINT bbt_ys){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(struct _m_seltra_block_obj*)bbObjectNew((BBClass *)&_m_seltra_block);
	bbt_b->__m_seltra_block_btype =o->__m_seltra_block_btype ;
	bbt_b->__m_seltra_block_bit_tags =(bbt_b->__m_seltra_block_bit_tags -1);
	bbt_b->__m_seltra_block_image =(struct brl_max2d_image_TImage_obj*)o->__m_seltra_block_image ;
	bbt_b->__m_seltra_block_x =(o->__m_seltra_block_x +bbt_xs);
	bbt_b->__m_seltra_block_y =(o->__m_seltra_block_y +bbt_ys);
	(_m_seltra_barray)->clas->m_add_Tblock((struct _m_seltra_blockarray_obj*)_m_seltra_barray,(struct _m_seltra_block_obj*)bbt_b);
	(_m_seltra_bmap)->clas->m_insert_iTblock((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +(bbt_b->__m_seltra_block_y <<10)),(struct _m_seltra_block_obj*)bbt_b);
	bbt_b->__m_seltra_block_id =_m_seltra_bc;
	_m_seltra_bc=(_m_seltra_bc+1);
	return (struct _m_seltra_block_obj*)bbt_b;
}
BBINT __m_seltra_block_checkchem_Tblock(struct _m_seltra_block_obj* o,struct _m_seltra_block_obj* bbt_b2){
	BBFLOAT bbt_d1=((BBFLOAT)_m_seltra_chem_dist(o->__m_seltra_block_ch ));
	BBFLOAT bbt_d2=((BBFLOAT)_m_seltra_chem_dist(bbt_b2->__m_seltra_block_ch ));
	BBFLOAT bbt_dc=((BBFLOAT)_m_seltra_chem_dist(o->__m_seltra_block_ch +bbt_b2->__m_seltra_block_ch ));
	brl_standardio_Print(bbStringConcat(bbStringConcat(bbStringConcat(bbStringConcat(bbStringConcat(bbStringConcat(bbStringFromFloat(bbt_d1),&_s1),bbStringFromFloat(bbt_d2)),&_s1),bbStringFromFloat(bbt_dc)),&_s1),bbStringFromFloat((bbt_d1+bbt_d2)/2.0f)));
	if(bbt_dc<(bbt_d1+bbt_d2)){
		return 1;
	}
	return 0;
}
BBINT __m_seltra_block_get_moli_chem(struct _m_seltra_block_obj* o){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(&bbNullObject);
	o->__m_seltra_block_mch =o->__m_seltra_block_ch ;
	if(o->__m_seltra_block_x >0){
		bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((o->__m_seltra_block_x -1)+(o->__m_seltra_block_y <<10)));
	}
	if((((BBObject*)bbt_b)!= &bbNullObject) && (bbt_b->__m_seltra_block_group ==o->__m_seltra_block_group )){
		o->__m_seltra_block_mch =(o->__m_seltra_block_mch +bbt_b->__m_seltra_block_ch );
	}
	bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((o->__m_seltra_block_x +1)+(o->__m_seltra_block_y <<10)));
	if((((BBObject*)bbt_b)!= &bbNullObject) && (bbt_b->__m_seltra_block_group ==o->__m_seltra_block_group )){
		o->__m_seltra_block_mch =(o->__m_seltra_block_mch +bbt_b->__m_seltra_block_ch );
	}
	if(o->__m_seltra_block_y >0){
		bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(o->__m_seltra_block_x +((o->__m_seltra_block_y -1)<<10)));
	}
	if((((BBObject*)bbt_b)!= &bbNullObject) && (bbt_b->__m_seltra_block_group ==o->__m_seltra_block_group )){
		o->__m_seltra_block_mch =(o->__m_seltra_block_mch +bbt_b->__m_seltra_block_ch );
	}
	bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(o->__m_seltra_block_x +((o->__m_seltra_block_y +1)<<10)));
	if((((BBObject*)bbt_b)!= &bbNullObject) && (bbt_b->__m_seltra_block_group ==o->__m_seltra_block_group )){
		o->__m_seltra_block_mch =(o->__m_seltra_block_mch +bbt_b->__m_seltra_block_ch );
	}
	return 0;
}
BBINT __m_seltra_block_bondcheck_Tblock(struct _m_seltra_block_obj* o,struct _m_seltra_block_obj* bbt_b2){
	if(((((((unsigned int)(o->__m_seltra_block_bonds2 )&(unsigned int)(1))!=0) && (((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )&(unsigned int)(4))!=0)) && ((o->__m_seltra_block_y -bbt_b2->__m_seltra_block_y )>0)) && !(((unsigned int)(o->__m_seltra_block_bonds2 )&(unsigned int)(16))!=0)) && !(((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )&(unsigned int)(32))!=0)){
		return 1;
	}
	if(((((((unsigned int)(o->__m_seltra_block_bonds2 )&(unsigned int)(4))!=0) && (((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )&(unsigned int)(1))!=0)) && ((o->__m_seltra_block_y -bbt_b2->__m_seltra_block_y )<0)) && !(((unsigned int)(o->__m_seltra_block_bonds2 )&(unsigned int)(64))!=0)) && !(((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )&(unsigned int)(8))!=0)){
		return 1;
	}
	if(((((((unsigned int)(o->__m_seltra_block_bonds2 )&(unsigned int)(2))!=0) && (((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )&(unsigned int)(8))!=0)) && ((o->__m_seltra_block_x -bbt_b2->__m_seltra_block_x )>0)) && !(((unsigned int)(o->__m_seltra_block_bonds2 )&(unsigned int)(32))!=0)) && !(((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )&(unsigned int)(64))!=0)){
		return 1;
	}
	if(((((((unsigned int)(o->__m_seltra_block_bonds2 )&(unsigned int)(8))!=0) && (((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )&(unsigned int)(2))!=0)) && ((o->__m_seltra_block_x -bbt_b2->__m_seltra_block_x )<0)) && !(((unsigned int)(o->__m_seltra_block_bonds2 )&(unsigned int)(128))!=0)) && !(((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )&(unsigned int)(16))!=0)){
		return 1;
	}
	return 0;
}
BBINT __m_seltra_block_checkchem2_Tblock(struct _m_seltra_block_obj* o,struct _m_seltra_block_obj* bbt_b2){
	BBINT bbt_ud=0;
	BBINT bbt_bd=0;
	BBINT bbt_diff=0;
	bbt_ud=(brl_blitz_Abs(_m_seltra_chem_dist(o->__m_seltra_block_mch ))+brl_blitz_Abs(_m_seltra_chem_dist(bbt_b2->__m_seltra_block_mch )));
	bbt_bd=(brl_blitz_Abs(_m_seltra_chem_dist(o->__m_seltra_block_mch +bbt_b2->__m_seltra_block_ch ))+brl_blitz_Abs(_m_seltra_chem_dist(bbt_b2->__m_seltra_block_mch +o->__m_seltra_block_ch )));
	if(bbt_bd<bbt_ud){
		return 1;
	}
	return 0;
}
BBARRAY __m_seltra_block_checkchem_detach_Tblock(struct _m_seltra_block_obj* o,struct _m_seltra_block_obj* bbt_b2){
	struct _m_seltra_block_obj* bbt_bw=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct _m_seltra_block_obj* bbt_be=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct _m_seltra_block_obj* bbt_bn=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct _m_seltra_block_obj* bbt_bs=(struct _m_seltra_block_obj*)(&bbNullObject);
	BBINT bbt_d=(_m_seltra_chem_dist(o->__m_seltra_block_mch +bbt_b2->__m_seltra_block_ch )+_m_seltra_chem_dist(bbt_b2->__m_seltra_block_mch +o->__m_seltra_block_ch ));
	if(bbt_d==0){
		return (&bbEmptyArray);
	}
	if(o->__m_seltra_block_x >0){
		bbt_bw=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((o->__m_seltra_block_x -1)+(o->__m_seltra_block_y <<10)));
	}
	bbt_be=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((o->__m_seltra_block_x +1)+(o->__m_seltra_block_y <<10)));
	if(o->__m_seltra_block_y >0){
		bbt_bn=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(o->__m_seltra_block_x +((o->__m_seltra_block_y -1)<<10)));
	}
	bbt_bs=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(o->__m_seltra_block_x +((o->__m_seltra_block_y +1)<<10)));
	if((((BBObject*)bbt_bw)!= &bbNullObject) && (bbt_bw->__m_seltra_block_group !=o->__m_seltra_block_group )){
		bbt_bw=(struct _m_seltra_block_obj*)&bbNullObject;
	}
	if((((BBObject*)bbt_be)!= &bbNullObject) && (bbt_be->__m_seltra_block_group !=o->__m_seltra_block_group )){
		bbt_be=(struct _m_seltra_block_obj*)&bbNullObject;
	}
	if((((BBObject*)bbt_bn)!= &bbNullObject) && (bbt_bn->__m_seltra_block_group !=o->__m_seltra_block_group )){
		bbt_bn=(struct _m_seltra_block_obj*)&bbNullObject;
	}
	if((((BBObject*)bbt_bs)!= &bbNullObject) && (bbt_bs->__m_seltra_block_group !=o->__m_seltra_block_group )){
		bbt_bs=(struct _m_seltra_block_obj*)&bbNullObject;
	}
	return (&bbEmptyArray);
}
BBARRAY __m_seltra_block_checkchem3_Tblock(struct _m_seltra_block_obj* o,struct _m_seltra_block_obj* bbt_b2){
	BBINT bbt_d=0;
	BBINT bbt_mch2=0;
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct _m_seltra_block_obj* bbt_b3=(struct _m_seltra_block_obj*)(&bbNullObject);
	BBARRAY volatile bbt_ba=bbArrayNew1D(":block", 5);
	struct _m_seltra_block_obj* bbt_bw=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct _m_seltra_block_obj* bbt_be=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct _m_seltra_block_obj* bbt_bn=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct _m_seltra_block_obj* bbt_bs=(struct _m_seltra_block_obj*)(&bbNullObject);
	bbt_mch2=o->__m_seltra_block_mch ;
	if(((BBObject*)bbt_b2)!= &bbNullObject){
		bbt_mch2=(o->__m_seltra_block_mch +bbt_b2->__m_seltra_block_ch );
	}
	BBINT bbt_ldsf=_m_seltra_chem_dist(bbt_mch2);
	if(o->__m_seltra_block_x >0){
		bbt_bw=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((o->__m_seltra_block_x -1)+(o->__m_seltra_block_y <<10)));
	}
	bbt_be=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((o->__m_seltra_block_x +1)+(o->__m_seltra_block_y <<10)));
	if(o->__m_seltra_block_y >0){
		bbt_bn=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(o->__m_seltra_block_x +((o->__m_seltra_block_y -1)<<10)));
	}
	bbt_bs=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(o->__m_seltra_block_x +((o->__m_seltra_block_y +1)<<10)));
	if((((BBObject*)bbt_bw)!= &bbNullObject) && (bbt_bw->__m_seltra_block_group !=o->__m_seltra_block_group )){
		bbt_bw=(struct _m_seltra_block_obj*)&bbNullObject;
	}
	if((((BBObject*)bbt_be)!= &bbNullObject) && (bbt_be->__m_seltra_block_group !=o->__m_seltra_block_group )){
		bbt_be=(struct _m_seltra_block_obj*)&bbNullObject;
	}
	if((((BBObject*)bbt_bn)!= &bbNullObject) && (bbt_bn->__m_seltra_block_group !=o->__m_seltra_block_group )){
		bbt_bn=(struct _m_seltra_block_obj*)&bbNullObject;
	}
	if((((BBObject*)bbt_bs)!= &bbNullObject) && (bbt_bs->__m_seltra_block_group !=o->__m_seltra_block_group )){
		bbt_bs=(struct _m_seltra_block_obj*)&bbNullObject;
	}
	if(((BBObject*)bbt_bw)!= &bbNullObject){
		bbt_d=_m_seltra_chem_dist(bbt_mch2-bbt_bw->__m_seltra_block_ch );
		if(bbt_ldsf>bbt_d){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_bw;
			bbt_ldsf=bbt_d;
		}
	}
	if(((BBObject*)bbt_be)!= &bbNullObject){
		bbt_d=_m_seltra_chem_dist(bbt_mch2-bbt_be->__m_seltra_block_ch );
		if(bbt_ldsf>bbt_d){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_be;
			bbt_ldsf=bbt_d;
		}
	}
	if(((BBObject*)bbt_bn)!= &bbNullObject){
		bbt_d=_m_seltra_chem_dist(bbt_mch2-bbt_bn->__m_seltra_block_ch );
		if(bbt_ldsf>bbt_d){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_bn;
			bbt_ldsf=bbt_d;
		}
	}
	if(((BBObject*)bbt_bs)!= &bbNullObject){
		bbt_d=_m_seltra_chem_dist(bbt_mch2-bbt_bs->__m_seltra_block_ch );
		if(bbt_ldsf>bbt_d){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_bs;
			bbt_ldsf=bbt_d;
		}
	}
	if((((BBObject*)bbt_bw)!= &bbNullObject) && (((BBObject*)bbt_be)!= &bbNullObject)){
		bbt_d=(((2*_m_seltra_chem_dist(bbt_mch2-(bbt_bw->__m_seltra_block_ch +bbt_be->__m_seltra_block_ch )))+_m_seltra_chem_dist(bbt_bw->__m_seltra_block_mch -o->__m_seltra_block_ch ))+_m_seltra_chem_dist(bbt_be->__m_seltra_block_mch -o->__m_seltra_block_ch ));
		if(bbt_ldsf>bbt_d){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_bw;
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[1U]=(struct _m_seltra_block_obj*)bbt_be;
			bbt_ldsf=bbt_d;
		}
	}
	if((((BBObject*)bbt_bw)!= &bbNullObject) && (((BBObject*)bbt_bn)!= &bbNullObject)){
		bbt_d=(((2*_m_seltra_chem_dist(bbt_mch2-(bbt_bw->__m_seltra_block_ch +bbt_bn->__m_seltra_block_ch )))+_m_seltra_chem_dist(bbt_bw->__m_seltra_block_mch -o->__m_seltra_block_ch ))+_m_seltra_chem_dist(bbt_bn->__m_seltra_block_mch -o->__m_seltra_block_ch ));
		if(bbt_ldsf>bbt_d){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_bw;
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[1U]=(struct _m_seltra_block_obj*)bbt_bn;
			bbt_ldsf=bbt_d;
		}
	}
	if((((BBObject*)bbt_bw)!= &bbNullObject) && (((BBObject*)bbt_bs)!= &bbNullObject)){
		bbt_d=(((2*_m_seltra_chem_dist(bbt_mch2-(bbt_bw->__m_seltra_block_ch +bbt_bs->__m_seltra_block_ch )))+_m_seltra_chem_dist(bbt_bw->__m_seltra_block_mch -o->__m_seltra_block_ch ))+_m_seltra_chem_dist(bbt_bs->__m_seltra_block_mch -o->__m_seltra_block_ch ));
		if(bbt_ldsf>bbt_d){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_bw;
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[1U]=(struct _m_seltra_block_obj*)bbt_bs;
			bbt_ldsf=bbt_d;
		}
	}
	if((((BBObject*)bbt_bn)!= &bbNullObject) && (((BBObject*)bbt_be)!= &bbNullObject)){
		bbt_d=(((2*_m_seltra_chem_dist(bbt_mch2-(bbt_bn->__m_seltra_block_ch +bbt_be->__m_seltra_block_ch )))+_m_seltra_chem_dist(bbt_bn->__m_seltra_block_mch -o->__m_seltra_block_ch ))+_m_seltra_chem_dist(bbt_be->__m_seltra_block_mch -o->__m_seltra_block_ch ));
		if(bbt_ldsf>bbt_d){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_bn;
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[1U]=(struct _m_seltra_block_obj*)bbt_be;
			bbt_ldsf=bbt_d;
		}
	}
	if((((BBObject*)bbt_bn)!= &bbNullObject) && (((BBObject*)bbt_bs)!= &bbNullObject)){
		bbt_d=(((2*_m_seltra_chem_dist(bbt_mch2-(bbt_bn->__m_seltra_block_ch +bbt_bs->__m_seltra_block_ch )))+_m_seltra_chem_dist(bbt_bn->__m_seltra_block_mch -o->__m_seltra_block_ch ))+_m_seltra_chem_dist(bbt_bs->__m_seltra_block_mch -o->__m_seltra_block_ch ));
		if(bbt_ldsf>bbt_d){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_bn;
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[1U]=(struct _m_seltra_block_obj*)bbt_bs;
			bbt_ldsf=bbt_d;
		}
	}
	if((((BBObject*)bbt_bs)!= &bbNullObject) && (((BBObject*)bbt_be)!= &bbNullObject)){
		bbt_d=(((2*_m_seltra_chem_dist(bbt_mch2-(bbt_bs->__m_seltra_block_ch +bbt_be->__m_seltra_block_ch )))+_m_seltra_chem_dist(bbt_bs->__m_seltra_block_mch -o->__m_seltra_block_ch ))+_m_seltra_chem_dist(bbt_be->__m_seltra_block_mch -o->__m_seltra_block_ch ));
		if(bbt_ldsf>bbt_d){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_bs;
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[1U]=(struct _m_seltra_block_obj*)bbt_be;
			bbt_ldsf=bbt_d;
		}
	}
	BBINT bbt_ch2=0;
	BBINT bbt_i=0;
	if(((BBObject*)bbt_bw)!= &bbNullObject){
		bbt_ch2=_m_seltra_chem_dist(bbt_bw->__m_seltra_block_mch -o->__m_seltra_block_ch );
		bbt_mch2=(bbt_mch2-bbt_bw->__m_seltra_block_ch );
	}
	if(((BBObject*)bbt_be)!= &bbNullObject){
		bbt_ch2=(bbt_ch2+_m_seltra_chem_dist(bbt_be->__m_seltra_block_mch -o->__m_seltra_block_ch ));
		bbt_mch2=(bbt_mch2-bbt_be->__m_seltra_block_ch );
	}
	if(((BBObject*)bbt_bn)!= &bbNullObject){
		bbt_ch2=(bbt_ch2+_m_seltra_chem_dist(bbt_bn->__m_seltra_block_mch -o->__m_seltra_block_ch ));
		bbt_mch2=(bbt_mch2-bbt_bn->__m_seltra_block_ch );
	}
	if(((BBObject*)bbt_bs)!= &bbNullObject){
		bbt_ch2=(bbt_ch2+_m_seltra_chem_dist(bbt_bs->__m_seltra_block_mch -o->__m_seltra_block_ch ));
		bbt_mch2=(bbt_mch2-bbt_bs->__m_seltra_block_ch );
	}
	bbt_d=(bbt_ch2+_m_seltra_chem_dist(bbt_mch2));
	if(bbt_ldsf>bbt_d){
		bbt_ba=bbArraySlice(":block",bbt_ba,0,5);
		if(((BBObject*)bbt_bw)!= &bbNullObject){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_bw;
			bbt_i=(bbt_i+1);
		}
		if(((BBObject*)bbt_be)!= &bbNullObject){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_i)]=(struct _m_seltra_block_obj*)bbt_be;
			bbt_i=(bbt_i+1);
		}
		if(((BBObject*)bbt_bn)!= &bbNullObject){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_i)]=(struct _m_seltra_block_obj*)bbt_bn;
			bbt_i=(bbt_i+1);
		}
		if(((BBObject*)bbt_bs)!= &bbNullObject){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_i)]=(struct _m_seltra_block_obj*)bbt_bs;
			bbt_i=(bbt_i+1);
		}
	}
	if(((BBObject*)((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U])!= &bbNullObject){
		bbt_i=0;
		while(((BBObject*)((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_i)])!= &bbNullObject){
			((struct _m_seltra_block_obj*)o)->clas->m_try_flood_split_Tblock((struct _m_seltra_block_obj*)o,(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_i)]);
			struct _m_seltra_block_obj* bbt_;
			((bbt_ = ((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_i)])->clas)->m_get_moli_chem((struct _m_seltra_block_obj*)bbt_);
			bbt_i=(bbt_i+1);
		}
		((struct _m_seltra_block_obj*)o)->clas->m_get_moli_chem((struct _m_seltra_block_obj*)o);
	}
	return (&bbEmptyArray);
}
BBINT __m_seltra_block_try_flood_split_Tblock(struct _m_seltra_block_obj* o,struct _m_seltra_block_obj* bbt_b){
	BBINT bbt_i=0;
	BBINT bbt_m=1;
	BBARRAY volatile bbt_ba=bbArrayNew1D(":block", 100);
	struct _m_seltra_block_obj* bbt_b2=(struct _m_seltra_block_obj*)(&bbNullObject);
	((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[0U]=(struct _m_seltra_block_obj*)bbt_b;
	if(!(bbt_b->__m_seltra_block_group ==o->__m_seltra_block_group )){
		return 0;
	}
	while(((BBObject*)((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_i)])!= &bbNullObject){
		if(bbt_b->__m_seltra_block_x >0){
			bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((bbt_b->__m_seltra_block_x -1)+(bbt_b->__m_seltra_block_y <<10)));
			if(((((BBObject*)bbt_b2)!= &bbNullObject) && (bbt_b2->__m_seltra_block_group ==o->__m_seltra_block_group )) && (bbt_b2!=o)){
				((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_m)]=(struct _m_seltra_block_obj*)bbt_b2;
				struct _m_seltra_bgroup_obj* bbt_;
				(((struct _m_seltra_bgroup_obj*)(bbt_ = bbt_b2->__m_seltra_block_group ))->clas)->m_remove_block_Tblock((struct _m_seltra_bgroup_obj*)bbt_,(struct _m_seltra_block_obj*)bbt_b2);
				bbt_m=(bbt_m+1);
			}
		}
		bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((bbt_b->__m_seltra_block_x +1)+(bbt_b->__m_seltra_block_y <<10)));
		if(((((BBObject*)bbt_b2)!= &bbNullObject) && (bbt_b2->__m_seltra_block_group ==o->__m_seltra_block_group )) && (bbt_b2!=o)){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_m)]=(struct _m_seltra_block_obj*)bbt_b2;
			struct _m_seltra_bgroup_obj* bbt_2;
			(((struct _m_seltra_bgroup_obj*)(bbt_2 = bbt_b2->__m_seltra_block_group ))->clas)->m_remove_block_Tblock((struct _m_seltra_bgroup_obj*)bbt_2,(struct _m_seltra_block_obj*)bbt_b2);
			bbt_m=(bbt_m+1);
		}
		if(bbt_b->__m_seltra_block_y >0){
			bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +((bbt_b->__m_seltra_block_y -1)<<10)));
			if(((((BBObject*)bbt_b2)!= &bbNullObject) && (bbt_b2->__m_seltra_block_group ==o->__m_seltra_block_group )) && (bbt_b2!=o)){
				((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_m)]=(struct _m_seltra_block_obj*)bbt_b2;
				struct _m_seltra_bgroup_obj* bbt_3;
				(((struct _m_seltra_bgroup_obj*)(bbt_3 = bbt_b2->__m_seltra_block_group ))->clas)->m_remove_block_Tblock((struct _m_seltra_bgroup_obj*)bbt_3,(struct _m_seltra_block_obj*)bbt_b2);
				bbt_m=(bbt_m+1);
			}
		}
		bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +((bbt_b->__m_seltra_block_y +1)<<10)));
		if(((((BBObject*)bbt_b2)!= &bbNullObject) && (bbt_b2->__m_seltra_block_group ==o->__m_seltra_block_group )) && (bbt_b2!=o)){
			((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_m)]=(struct _m_seltra_block_obj*)bbt_b2;
			struct _m_seltra_bgroup_obj* bbt_4;
			(((struct _m_seltra_bgroup_obj*)(bbt_4 = bbt_b2->__m_seltra_block_group ))->clas)->m_remove_block_Tblock((struct _m_seltra_bgroup_obj*)bbt_4,(struct _m_seltra_block_obj*)bbt_b2);
			bbt_m=(bbt_m+1);
		}
		bbt_i=(bbt_i+1);
	}
	struct _m_seltra_bgroup_obj* bbt_bg=(struct _m_seltra_bgroup_obj*)(struct _m_seltra_bgroup_obj*)bbObjectNew((BBClass *)&_m_seltra_bgroup);
	bbt_i=0;
	struct _m_seltra_bgroup_obj* bbt_5;
	(((struct _m_seltra_bgroup_obj*)(bbt_5 = bbt_b->__m_seltra_block_group ))->clas)->m_remove_block_Tblock((struct _m_seltra_bgroup_obj*)bbt_5,(struct _m_seltra_block_obj*)bbt_b);
	while(((BBObject*)((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_i)])!= &bbNullObject){
		(bbt_bg)->clas->m_add_Tblock((struct _m_seltra_bgroup_obj*)bbt_bg,(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_ba,1))[((BBUINT)bbt_i)]);
		bbt_i=(bbt_i+1);
	}
	(_m_seltra_garray)->clas->m_add_Tbgroup((struct _m_seltra_grouparray_obj*)_m_seltra_garray,(struct _m_seltra_bgroup_obj*)bbt_bg);
	return 0;
}
BBINT __m_seltra_block_repblock(struct _m_seltra_block_obj* o){
	BBINT bbt_ok=0;
	struct _m_seltra_block_obj* bbt_b2=(struct _m_seltra_block_obj*)(&bbNullObject);
	if(o->__m_seltra_block_group ->__m_seltra_bgroup_xv !=0){
		if(o->__m_seltra_block_y >0){
			bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(o->__m_seltra_block_x +((o->__m_seltra_block_y -1)<<10)));
			if(!(((BBObject*)bbt_b2)!= &bbNullObject)){
				bbt_ok=1;
			}
		}
		bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(o->__m_seltra_block_x +((o->__m_seltra_block_y +1)<<10)));
		if(!(((BBObject*)bbt_b2)!= &bbNullObject)){
			bbt_ok=(bbt_ok+1);
		}
	}
	if(o->__m_seltra_block_group ->__m_seltra_bgroup_yv !=0){
		if(o->__m_seltra_block_x >0){
			bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((o->__m_seltra_block_x -1)+(o->__m_seltra_block_y <<10)));
			if(!(((BBObject*)bbt_b2)!= &bbNullObject)){
				bbt_ok=1;
			}
		}
		bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((o->__m_seltra_block_x +1)+(o->__m_seltra_block_y <<10)));
		if(!(((BBObject*)bbt_b2)!= &bbNullObject)){
			bbt_ok=(bbt_ok+1);
		}
	}
	if(bbt_ok==2){
		if(((struct _m_seltra_btemplate_obj**)BBARRAYDATA(_m_seltra_btarray,1))[((BBUINT)o->__m_seltra_block_bt )]->__m_seltra_btemplate_btype ==o->__m_seltra_block_btype ){
			if(o->__m_seltra_block_group ->__m_seltra_bgroup_xv !=0){
				struct _m_seltra_btemplate_obj* bbt_;
				((bbt_ = ((struct _m_seltra_btemplate_obj**)BBARRAYDATA(_m_seltra_btarray,1))[((BBUINT)o->__m_seltra_block_bt )])->clas)->m_createsingleblock_iiii((struct _m_seltra_btemplate_obj*)bbt_,o->__m_seltra_block_x ,(o->__m_seltra_block_y -1),0,-1);
				struct _m_seltra_btemplate_obj* bbt_2;
				((bbt_2 = ((struct _m_seltra_btemplate_obj**)BBARRAYDATA(_m_seltra_btarray,1))[((BBUINT)o->__m_seltra_block_bt )])->clas)->m_createsingleblock_iiii((struct _m_seltra_btemplate_obj*)bbt_2,o->__m_seltra_block_x ,(o->__m_seltra_block_y +1),0,1);
			}
			if(o->__m_seltra_block_group ->__m_seltra_bgroup_yv !=0){
				struct _m_seltra_btemplate_obj* bbt_3;
				((bbt_3 = ((struct _m_seltra_btemplate_obj**)BBARRAYDATA(_m_seltra_btarray,1))[((BBUINT)o->__m_seltra_block_bt )])->clas)->m_createsingleblock_iiii((struct _m_seltra_btemplate_obj*)bbt_3,(o->__m_seltra_block_x -1),o->__m_seltra_block_y ,-1,0);
				struct _m_seltra_btemplate_obj* bbt_4;
				((bbt_4 = ((struct _m_seltra_btemplate_obj**)BBARRAYDATA(_m_seltra_btarray,1))[((BBUINT)o->__m_seltra_block_bt )])->clas)->m_createsingleblock_iiii((struct _m_seltra_btemplate_obj*)bbt_4,(o->__m_seltra_block_x +1),o->__m_seltra_block_y ,1,0);
			}
		}
		((struct _m_seltra_block_obj*)o)->clas->m_Del((struct _m_seltra_block_obj*)o);
	}
	return 0;
}
struct BBDebugScope_29 _m_seltra_block_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"block",
	{
		{
			BBDEBUGDECL_FIELD,
			"btype",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_btype)
		},
		{
			BBDEBUGDECL_FIELD,
			"image",
			":TImage",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_image)
		},
		{
			BBDEBUGDECL_FIELD,
			"x",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_x)
		},
		{
			BBDEBUGDECL_FIELD,
			"y",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_y)
		},
		{
			BBDEBUGDECL_FIELD,
			"bit_tags",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_bit_tags)
		},
		{
			BBDEBUGDECL_FIELD,
			"id",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_id)
		},
		{
			BBDEBUGDECL_FIELD,
			"oldx",
			"[]i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_oldx)
		},
		{
			BBDEBUGDECL_FIELD,
			"oldy",
			"[]i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_oldy)
		},
		{
			BBDEBUGDECL_FIELD,
			"group",
			":bgroup",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_group)
		},
		{
			BBDEBUGDECL_FIELD,
			"ch",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_ch)
		},
		{
			BBDEBUGDECL_FIELD,
			"mch",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_mch)
		},
		{
			BBDEBUGDECL_FIELD,
			"bt",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_bt)
		},
		{
			BBDEBUGDECL_FIELD,
			"bonds",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_bonds)
		},
		{
			BBDEBUGDECL_FIELD,
			"maxbonds",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_maxbonds)
		},
		{
			BBDEBUGDECL_FIELD,
			"bond",
			"[]:block",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_bond)
		},
		{
			BBDEBUGDECL_FIELD,
			"bonds2",
			"i",
			.field_offset=offsetof(struct _m_seltra_block_obj,__m_seltra_block_bonds2)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_block_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"Del",
			"()i",
			.var_address=(void*)&__m_seltra_block_Del
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"draw",
			"()i",
			.var_address=(void*)&__m_seltra_block_draw
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"out_of_bounds",
			"()i",
			.var_address=(void*)&__m_seltra_block_out_of_bounds
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"spawn",
			"(i,i):block",
			.var_address=(void*)&__m_seltra_block_spawn_ii
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"checkchem",
			"(:block)i",
			.var_address=(void*)&__m_seltra_block_checkchem_Tblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"get_moli_chem",
			"()i",
			.var_address=(void*)&__m_seltra_block_get_moli_chem
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"bondcheck",
			"(:block)i",
			.var_address=(void*)&__m_seltra_block_bondcheck_Tblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"checkchem2",
			"(:block)i",
			.var_address=(void*)&__m_seltra_block_checkchem2_Tblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"checkchem_detach",
			"(:block)[]:block",
			.var_address=(void*)&__m_seltra_block_checkchem_detach_Tblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"checkchem3",
			"(:block)[]:block",
			.var_address=(void*)&__m_seltra_block_checkchem3_Tblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"try_flood_split",
			"(:block)i",
			.var_address=(void*)&__m_seltra_block_try_flood_split_Tblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"repblock",
			"()i",
			.var_address=(void*)&__m_seltra_block_repblock
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_block _m_seltra_block={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_block_scope,
	sizeof(struct _m_seltra_block_obj),
	(void (*)(BBOBJECT))__m_seltra_block_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_block_obj,__m_seltra_block_bonds2) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_block_Del
	,__m_seltra_block_draw
	,__m_seltra_block_out_of_bounds
	,__m_seltra_block_spawn_ii
	,__m_seltra_block_checkchem_Tblock
	,__m_seltra_block_get_moli_chem
	,__m_seltra_block_bondcheck_Tblock
	,__m_seltra_block_checkchem2_Tblock
	,__m_seltra_block_checkchem_detach_Tblock
	,__m_seltra_block_checkchem3_Tblock
	,__m_seltra_block_try_flood_split_Tblock
	,__m_seltra_block_repblock
};

struct _m_seltra_blockarray_obj* _m_seltra_wallgroup=(struct _m_seltra_blockarray_obj*)(&bbNullObject);
void __m_seltra_redrawarray_New(struct _m_seltra_redrawarray_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_redrawarray;
	o->__m_seltra_redrawarray_ra = bbArrayNew1D(":redraw", 1000);
	o->__m_seltra_redrawarray_le = 0;
	o->__m_seltra_redrawarray_drawn = 0;
}
BBINT __m_seltra_redrawarray_add_Tredraw(struct _m_seltra_redrawarray_obj* o,struct _m_seltra_redraw_obj* bbt_r){
	((struct _m_seltra_redraw_obj**)BBARRAYDATA(o->__m_seltra_redrawarray_ra ,1))[((BBUINT)o->__m_seltra_redrawarray_le )]=(struct _m_seltra_redraw_obj*)bbt_r;
	o->__m_seltra_redrawarray_le =(o->__m_seltra_redrawarray_le +1);
	return 0;
}
BBINT __m_seltra_redrawarray_do_redraws(struct _m_seltra_redrawarray_obj* o){
	struct brl_max2d_image_TImage_obj* bbt_im=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
	struct _m_seltra_redraw_obj* bbt_r=(struct _m_seltra_redraw_obj*)(&bbNullObject);
	BBINT bbt_v=0;
	BBINT bbt_i=0;
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(&bbNullObject);
	while(bbt_i<_m_seltra_rarray->__m_seltra_redrawarray_le ){
		bbt_r=(struct _m_seltra_redraw_obj*)((struct _m_seltra_redraw_obj**)BBARRAYDATA(o->__m_seltra_redrawarray_ra ,1))[((BBUINT)bbt_i)];
		if(((BBObject*)bbt_r)!= &bbNullObject){
			_m_seltra_redraw_cell(bbt_r->__m_seltra_redraw_x ,bbt_r->__m_seltra_redraw_y );
			bbt_r->__m_seltra_redraw_redraws =((BBBYTE)(((BBINT)bbt_r->__m_seltra_redraw_redraws )-1));
			if(((BBINT)bbt_r->__m_seltra_redraw_redraws )<=0){
				((struct _m_seltra_redraw_obj**)BBARRAYDATA(o->__m_seltra_redrawarray_ra ,1))[((BBUINT)bbt_i)]=(struct _m_seltra_redraw_obj*)&bbNullObject;
				o->__m_seltra_redrawarray_drawn =(o->__m_seltra_redrawarray_drawn +1);
			}
		}
		bbt_i=(bbt_i+1);
	}
	if(o->__m_seltra_redrawarray_drawn ==o->__m_seltra_redrawarray_le ){
		o->__m_seltra_redrawarray_le =0;
		o->__m_seltra_redrawarray_drawn =0;
	}
	return 0;
}
struct BBDebugScope_6 _m_seltra_redrawarray_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"redrawarray",
	{
		{
			BBDEBUGDECL_FIELD,
			"ra",
			"[]:redraw",
			.field_offset=offsetof(struct _m_seltra_redrawarray_obj,__m_seltra_redrawarray_ra)
		},
		{
			BBDEBUGDECL_FIELD,
			"le",
			"i",
			.field_offset=offsetof(struct _m_seltra_redrawarray_obj,__m_seltra_redrawarray_le)
		},
		{
			BBDEBUGDECL_FIELD,
			"drawn",
			"i",
			.field_offset=offsetof(struct _m_seltra_redrawarray_obj,__m_seltra_redrawarray_drawn)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_redrawarray_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"add",
			"(:redraw)i",
			.var_address=(void*)&__m_seltra_redrawarray_add_Tredraw
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"do_redraws",
			"()i",
			.var_address=(void*)&__m_seltra_redrawarray_do_redraws
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_redrawarray _m_seltra_redrawarray={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_redrawarray_scope,
	sizeof(struct _m_seltra_redrawarray_obj),
	(void (*)(BBOBJECT))__m_seltra_redrawarray_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_redrawarray_obj,__m_seltra_redrawarray_drawn) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_redrawarray_add_Tredraw
	,__m_seltra_redrawarray_do_redraws
};

struct _m_seltra_redrawarray_obj* _m_seltra_rarray=(struct _m_seltra_redrawarray_obj*)(&bbNullObject);
void __m_seltra_generatorarray_New(struct _m_seltra_generatorarray_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_generatorarray;
	o->__m_seltra_generatorarray_ga = bbArrayNew1D(":gen", 3000);
	o->__m_seltra_generatorarray_le = 0;
}
BBINT __m_seltra_generatorarray_add_Tgen(struct _m_seltra_generatorarray_obj* o,struct _m_seltra_gen_obj* bbt_g){
	((struct _m_seltra_gen_obj**)BBARRAYDATA(o->__m_seltra_generatorarray_ga ,1))[((BBUINT)o->__m_seltra_generatorarray_le )]=(struct _m_seltra_gen_obj*)bbt_g;
	bbt_g->__m_seltra_gen_id =o->__m_seltra_generatorarray_le ;
	o->__m_seltra_generatorarray_le =(o->__m_seltra_generatorarray_le +1);
	return 0;
}
BBINT __m_seltra_generatorarray_ordered_sort_ii(struct _m_seltra_generatorarray_obj* o,BBINT bbt_n,BBINT bbt_i){
	if(bbt_n==0){
		bbt_n=o->__m_seltra_generatorarray_le ;
	}
	BBINT bbt_j=bbt_i;
	while(bbt_j<o->__m_seltra_generatorarray_le ){
		((struct _m_seltra_gen_obj**)BBARRAYDATA(o->__m_seltra_generatorarray_ga ,1))[((BBUINT)bbt_i)]=(struct _m_seltra_gen_obj*)((struct _m_seltra_gen_obj**)BBARRAYDATA(o->__m_seltra_generatorarray_ga ,1))[((BBUINT)bbt_j)];
		if(((BBObject*)((struct _m_seltra_gen_obj**)BBARRAYDATA(o->__m_seltra_generatorarray_ga ,1))[((BBUINT)bbt_i)])!= &bbNullObject){
			((struct _m_seltra_gen_obj**)BBARRAYDATA(o->__m_seltra_generatorarray_ga ,1))[((BBUINT)bbt_i)]->__m_seltra_gen_id =bbt_i;
			bbt_i=(bbt_i+1);
		}
		bbt_j=(bbt_j+1);
	}
	o->__m_seltra_generatorarray_le =bbt_i;
	return 0;
}
struct BBDebugScope_5 _m_seltra_generatorarray_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"generatorarray",
	{
		{
			BBDEBUGDECL_FIELD,
			"ga",
			"[]:gen",
			.field_offset=offsetof(struct _m_seltra_generatorarray_obj,__m_seltra_generatorarray_ga)
		},
		{
			BBDEBUGDECL_FIELD,
			"le",
			"i",
			.field_offset=offsetof(struct _m_seltra_generatorarray_obj,__m_seltra_generatorarray_le)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_generatorarray_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"add",
			"(:gen)i",
			.var_address=(void*)&__m_seltra_generatorarray_add_Tgen
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"ordered_sort",
			"(i,i)i",
			.var_address=(void*)&__m_seltra_generatorarray_ordered_sort_ii
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_generatorarray _m_seltra_generatorarray={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_generatorarray_scope,
	sizeof(struct _m_seltra_generatorarray_obj),
	(void (*)(BBOBJECT))__m_seltra_generatorarray_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_generatorarray_obj,__m_seltra_generatorarray_le) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_generatorarray_add_Tgen
	,__m_seltra_generatorarray_ordered_sort_ii
};

struct _m_seltra_generatorarray_obj* _m_seltra_genarray=(struct _m_seltra_generatorarray_obj*)(&bbNullObject);
void __m_seltra_fastblockmap_New(struct _m_seltra_fastblockmap_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_fastblockmap;
	o->__m_seltra_fastblockmap_v = bbArrayNew1D(":block", 3000000);
	o->__m_seltra_fastblockmap_k = bbArrayNew1D("i", 3000000);
	o->__m_seltra_fastblockmap_le = 0;
	o->__m_seltra_fastblockmap_rc = 0;
}
struct _m_seltra_block_obj* __m_seltra_fastblockmap_fetch_i(struct _m_seltra_fastblockmap_obj* o,BBINT bbt_key){
	return (struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_fastblockmap_v ,1))[((BBUINT)bbt_key)];
}
struct _m_seltra_block_obj* __m_seltra_fastblockmap_vfetch_i(struct _m_seltra_fastblockmap_obj* o,BBINT bbt_index){
	return (struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_fastblockmap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)bbt_index)])];
}
BBINT __m_seltra_fastblockmap_kfetch_i(struct _m_seltra_fastblockmap_obj* o,BBINT bbt_index){
	return ((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)bbt_index)];
}
BBINT __m_seltra_fastblockmap_insert_iTblock(struct _m_seltra_fastblockmap_obj* o,BBINT bbt_key,struct _m_seltra_block_obj* bbt_b){
	if(((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_fastblockmap_v ,1))[((BBUINT)bbt_key)]==&bbNullObject){
		((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)o->__m_seltra_fastblockmap_le )]=bbt_key;
		o->__m_seltra_fastblockmap_le =(o->__m_seltra_fastblockmap_le +1);
	}
	((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_fastblockmap_v ,1))[((BBUINT)bbt_key)]=(struct _m_seltra_block_obj*)bbt_b;
	return 0;
}
BBINT __m_seltra_fastblockmap_remove_i(struct _m_seltra_fastblockmap_obj* o,BBINT bbt_key){
	((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_fastblockmap_v ,1))[((BBUINT)bbt_key)]=(struct _m_seltra_block_obj*)&bbNullObject;
	o->__m_seltra_fastblockmap_rc =(o->__m_seltra_fastblockmap_rc +1);
	return 0;
}
BBINT __m_seltra_fastblockmap_iter(struct _m_seltra_fastblockmap_obj* o){
	BBINT bbt_i=0;
	while(bbt_i<o->__m_seltra_fastblockmap_le ){
		if(((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_fastblockmap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)bbt_i)])]==&bbNullObject){
			((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)bbt_i)]=((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)(o->__m_seltra_fastblockmap_le -1))];
			o->__m_seltra_fastblockmap_le =(o->__m_seltra_fastblockmap_le -1);
		}else{
			bbt_i=(bbt_i+1);
		}
	}
	return 0;
}
BBINT __m_seltra_fastblockmap_fastsort(struct _m_seltra_fastblockmap_obj* o){
	BBINT bbt_i=0;
	while(bbt_i<o->__m_seltra_fastblockmap_le ){
		if(((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_fastblockmap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)bbt_i)])]==&bbNullObject){
			((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)bbt_i)]=((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)(o->__m_seltra_fastblockmap_le -1))];
			o->__m_seltra_fastblockmap_le =(o->__m_seltra_fastblockmap_le -1);
		}else{
			bbt_i=(bbt_i+1);
		}
	}
	o->__m_seltra_fastblockmap_rc =0;
	return 0;
}
BBINT __m_seltra_fastblockmap_orderedsort(struct _m_seltra_fastblockmap_obj* o){
	BBINT bbt_i=0;
	BBINT bbt_j=0;
	while(bbt_j<o->__m_seltra_fastblockmap_le ){
		if(((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_fastblockmap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)bbt_j)])]==&bbNullObject){
			o->__m_seltra_fastblockmap_le =(o->__m_seltra_fastblockmap_le -1);
		}else{
			((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)bbt_i)]=((BBINT*)BBARRAYDATA(o->__m_seltra_fastblockmap_k ,1))[((BBUINT)bbt_j)];
			bbt_i=(bbt_i+1);
		}
		bbt_j=(bbt_j+1);
	}
	o->__m_seltra_fastblockmap_le =bbt_i;
	o->__m_seltra_fastblockmap_rc =0;
	return 0;
}
struct BBDebugScope_13 _m_seltra_fastblockmap_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"fastblockmap",
	{
		{
			BBDEBUGDECL_FIELD,
			"v",
			"[]:block",
			.field_offset=offsetof(struct _m_seltra_fastblockmap_obj,__m_seltra_fastblockmap_v)
		},
		{
			BBDEBUGDECL_FIELD,
			"k",
			"[]i",
			.field_offset=offsetof(struct _m_seltra_fastblockmap_obj,__m_seltra_fastblockmap_k)
		},
		{
			BBDEBUGDECL_FIELD,
			"le",
			"i",
			.field_offset=offsetof(struct _m_seltra_fastblockmap_obj,__m_seltra_fastblockmap_le)
		},
		{
			BBDEBUGDECL_FIELD,
			"rc",
			"i",
			.field_offset=offsetof(struct _m_seltra_fastblockmap_obj,__m_seltra_fastblockmap_rc)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_fastblockmap_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"fetch",
			"(i):block",
			.var_address=(void*)&__m_seltra_fastblockmap_fetch_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"vfetch",
			"(i):block",
			.var_address=(void*)&__m_seltra_fastblockmap_vfetch_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"kfetch",
			"(i)i",
			.var_address=(void*)&__m_seltra_fastblockmap_kfetch_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"insert",
			"(i,:block)i",
			.var_address=(void*)&__m_seltra_fastblockmap_insert_iTblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"remove",
			"(i)i",
			.var_address=(void*)&__m_seltra_fastblockmap_remove_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"iter",
			"()i",
			.var_address=(void*)&__m_seltra_fastblockmap_iter
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"fastsort",
			"()i",
			.var_address=(void*)&__m_seltra_fastblockmap_fastsort
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"orderedsort",
			"()i",
			.var_address=(void*)&__m_seltra_fastblockmap_orderedsort
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_fastblockmap _m_seltra_fastblockmap={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_fastblockmap_scope,
	sizeof(struct _m_seltra_fastblockmap_obj),
	(void (*)(BBOBJECT))__m_seltra_fastblockmap_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_fastblockmap_obj,__m_seltra_fastblockmap_rc) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_fastblockmap_fetch_i
	,__m_seltra_fastblockmap_vfetch_i
	,__m_seltra_fastblockmap_kfetch_i
	,__m_seltra_fastblockmap_insert_iTblock
	,__m_seltra_fastblockmap_remove_i
	,__m_seltra_fastblockmap_iter
	,__m_seltra_fastblockmap_fastsort
	,__m_seltra_fastblockmap_orderedsort
};

struct _m_seltra_fastblockmap_obj* _m_seltra_bmap=(struct _m_seltra_fastblockmap_obj*)(&bbNullObject);
void __m_seltra_fastintmap_New(struct _m_seltra_fastintmap_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_fastintmap;
	o->__m_seltra_fastintmap_v = bbArrayNew1D("i", 3000000);
	o->__m_seltra_fastintmap_k = bbArrayNew1D("i", 3000000);
	o->__m_seltra_fastintmap_le = 0;
	o->__m_seltra_fastintmap_nl = 0;
}
BBINT __m_seltra_fastintmap_fetch_i(struct _m_seltra_fastintmap_obj* o,BBINT bbt_key){
	return ((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_v ,1))[((BBUINT)bbt_key)];
}
BBINT __m_seltra_fastintmap_vfetch_i(struct _m_seltra_fastintmap_obj* o,BBINT bbt_index){
	return ((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)bbt_index)])];
}
BBINT __m_seltra_fastintmap_kfetch_i(struct _m_seltra_fastintmap_obj* o,BBINT bbt_index){
	return ((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)bbt_index)];
}
BBINT __m_seltra_fastintmap_insert_ii(struct _m_seltra_fastintmap_obj* o,BBINT bbt_key,BBINT bbt_val){
	if(((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_v ,1))[((BBUINT)bbt_key)]==o->__m_seltra_fastintmap_nl ){
		((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)o->__m_seltra_fastintmap_le )]=bbt_key;
		o->__m_seltra_fastintmap_le =(o->__m_seltra_fastintmap_le +1);
	}
	((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_v ,1))[((BBUINT)bbt_key)]=bbt_val;
	return 0;
}
BBINT __m_seltra_fastintmap_remove_i(struct _m_seltra_fastintmap_obj* o,BBINT bbt_key){
	((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_v ,1))[((BBUINT)bbt_key)]=o->__m_seltra_fastintmap_nl ;
	return 0;
}
BBINT __m_seltra_fastintmap_iter(struct _m_seltra_fastintmap_obj* o){
	BBINT bbt_i=0;
	while(bbt_i<o->__m_seltra_fastintmap_le ){
		if(((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)bbt_i)])]==o->__m_seltra_fastintmap_nl ){
			((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)bbt_i)]=((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)(o->__m_seltra_fastintmap_le -1))];
			o->__m_seltra_fastintmap_le =(o->__m_seltra_fastintmap_le -1);
		}else{
			BBINT bbt_a=((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)bbt_i)])];
			bbt_i=(bbt_i+1);
		}
	}
	return 0;
}
BBINT __m_seltra_fastintmap_fastsort(struct _m_seltra_fastintmap_obj* o){
	BBINT bbt_i=0;
	while(bbt_i<o->__m_seltra_fastintmap_le ){
		if(((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)bbt_i)])]==o->__m_seltra_fastintmap_nl ){
			((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)bbt_i)]=((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)(o->__m_seltra_fastintmap_le -1))];
			o->__m_seltra_fastintmap_le =(o->__m_seltra_fastintmap_le -1);
		}else{
			bbt_i=(bbt_i+1);
		}
	}
	return 0;
}
BBINT __m_seltra_fastintmap_orderedsort(struct _m_seltra_fastintmap_obj* o){
	BBINT bbt_i=0;
	BBINT bbt_j=0;
	while(bbt_j<o->__m_seltra_fastintmap_le ){
		if(((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)bbt_j)])]==o->__m_seltra_fastintmap_nl ){
			o->__m_seltra_fastintmap_le =(o->__m_seltra_fastintmap_le -1);
		}else{
			((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)bbt_i)]=((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_k ,1))[((BBUINT)bbt_j)];
			bbt_i=(bbt_i+1);
		}
		bbt_j=(bbt_j+1);
	}
	o->__m_seltra_fastintmap_le =bbt_i;
	return 0;
}
BBINT __m_seltra_fastintmap_set_null_value_i(struct _m_seltra_fastintmap_obj* o,BBINT bbt_n){
	BBINT bbt_i=0;
	o->__m_seltra_fastintmap_nl =bbt_n;
	while(bbt_i<3000000){
		((BBINT*)BBARRAYDATA(o->__m_seltra_fastintmap_v ,1))[((BBUINT)bbt_i)]=bbt_n;
		bbt_i=(bbt_i+1);
	}
	return 0;
}
struct BBDebugScope_14 _m_seltra_fastintmap_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"fastintmap",
	{
		{
			BBDEBUGDECL_FIELD,
			"v",
			"[]i",
			.field_offset=offsetof(struct _m_seltra_fastintmap_obj,__m_seltra_fastintmap_v)
		},
		{
			BBDEBUGDECL_FIELD,
			"k",
			"[]i",
			.field_offset=offsetof(struct _m_seltra_fastintmap_obj,__m_seltra_fastintmap_k)
		},
		{
			BBDEBUGDECL_FIELD,
			"le",
			"i",
			.field_offset=offsetof(struct _m_seltra_fastintmap_obj,__m_seltra_fastintmap_le)
		},
		{
			BBDEBUGDECL_FIELD,
			"nl",
			"i",
			.field_offset=offsetof(struct _m_seltra_fastintmap_obj,__m_seltra_fastintmap_nl)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_fastintmap_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"fetch",
			"(i)i",
			.var_address=(void*)&__m_seltra_fastintmap_fetch_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"vfetch",
			"(i)i",
			.var_address=(void*)&__m_seltra_fastintmap_vfetch_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"kfetch",
			"(i)i",
			.var_address=(void*)&__m_seltra_fastintmap_kfetch_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"insert",
			"(i,i)i",
			.var_address=(void*)&__m_seltra_fastintmap_insert_ii
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"remove",
			"(i)i",
			.var_address=(void*)&__m_seltra_fastintmap_remove_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"iter",
			"()i",
			.var_address=(void*)&__m_seltra_fastintmap_iter
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"fastsort",
			"()i",
			.var_address=(void*)&__m_seltra_fastintmap_fastsort
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"orderedsort",
			"()i",
			.var_address=(void*)&__m_seltra_fastintmap_orderedsort
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"set_null_value",
			"(i)i",
			.var_address=(void*)&__m_seltra_fastintmap_set_null_value_i
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_fastintmap _m_seltra_fastintmap={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_fastintmap_scope,
	sizeof(struct _m_seltra_fastintmap_obj),
	(void (*)(BBOBJECT))__m_seltra_fastintmap_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_fastintmap_obj,__m_seltra_fastintmap_nl) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_fastintmap_fetch_i
	,__m_seltra_fastintmap_vfetch_i
	,__m_seltra_fastintmap_kfetch_i
	,__m_seltra_fastintmap_insert_ii
	,__m_seltra_fastintmap_remove_i
	,__m_seltra_fastintmap_iter
	,__m_seltra_fastintmap_fastsort
	,__m_seltra_fastintmap_orderedsort
	,__m_seltra_fastintmap_set_null_value_i
};

struct _m_seltra_fastintmap_obj* _m_seltra_thingmap=(struct _m_seltra_fastintmap_obj*)(&bbNullObject);
void __m_seltra_substratemap_New(struct _m_seltra_substratemap_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_substratemap;
	o->__m_seltra_substratemap_v = bbArrayNew1D(":substrate", 3000000);
	o->__m_seltra_substratemap_k = bbArrayNew1D("i", 3000000);
	o->__m_seltra_substratemap_le = 0;
	o->__m_seltra_substratemap_rc = 0;
}
struct _m_seltra_substrate_obj* __m_seltra_substratemap_fetch_i(struct _m_seltra_substratemap_obj* o,BBINT bbt_key){
	return (struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_substratemap_v ,1))[((BBUINT)bbt_key)];
}
struct _m_seltra_substrate_obj* __m_seltra_substratemap_vfetch_i(struct _m_seltra_substratemap_obj* o,BBINT bbt_index){
	return (struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_substratemap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)bbt_index)])];
}
BBINT __m_seltra_substratemap_kfetch_i(struct _m_seltra_substratemap_obj* o,BBINT bbt_index){
	return ((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)bbt_index)];
}
BBINT __m_seltra_substratemap_insert_iTsubstrate(struct _m_seltra_substratemap_obj* o,BBINT bbt_key,struct _m_seltra_substrate_obj* bbt_s){
	if(((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_substratemap_v ,1))[((BBUINT)bbt_key)]==&bbNullObject){
		((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)o->__m_seltra_substratemap_le )]=bbt_key;
		o->__m_seltra_substratemap_le =(o->__m_seltra_substratemap_le +1);
	}
	((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_substratemap_v ,1))[((BBUINT)bbt_key)]=(struct _m_seltra_substrate_obj*)bbt_s;
	return 0;
}
BBINT __m_seltra_substratemap_remove_i(struct _m_seltra_substratemap_obj* o,BBINT bbt_key){
	((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_substratemap_v ,1))[((BBUINT)bbt_key)]=(struct _m_seltra_substrate_obj*)&bbNullObject;
	o->__m_seltra_substratemap_rc =(o->__m_seltra_substratemap_rc +1);
	return 0;
}
BBINT __m_seltra_substratemap_iter(struct _m_seltra_substratemap_obj* o){
	BBINT bbt_i=0;
	while(bbt_i<o->__m_seltra_substratemap_le ){
		if(((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_substratemap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)bbt_i)])]==&bbNullObject){
			((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)bbt_i)]=((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)(o->__m_seltra_substratemap_le -1))];
			o->__m_seltra_substratemap_le =(o->__m_seltra_substratemap_le -1);
		}else{
			bbt_i=(bbt_i+1);
		}
	}
	return 0;
}
BBINT __m_seltra_substratemap_fastsort(struct _m_seltra_substratemap_obj* o){
	BBINT bbt_i=0;
	while(bbt_i<o->__m_seltra_substratemap_le ){
		if(((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_substratemap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)bbt_i)])]==&bbNullObject){
			((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)bbt_i)]=((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)(o->__m_seltra_substratemap_le -1))];
			o->__m_seltra_substratemap_le =(o->__m_seltra_substratemap_le -1);
		}else{
			bbt_i=(bbt_i+1);
		}
	}
	o->__m_seltra_substratemap_rc =0;
	return 0;
}
BBINT __m_seltra_substratemap_orderedsort(struct _m_seltra_substratemap_obj* o){
	BBINT bbt_i=0;
	BBINT bbt_j=0;
	while(bbt_j<o->__m_seltra_substratemap_le ){
		if(((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_substratemap_v ,1))[((BBUINT)((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)bbt_j)])]==&bbNullObject){
			o->__m_seltra_substratemap_le =(o->__m_seltra_substratemap_le -1);
		}else{
			((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)bbt_i)]=((BBINT*)BBARRAYDATA(o->__m_seltra_substratemap_k ,1))[((BBUINT)bbt_j)];
			bbt_i=(bbt_i+1);
		}
		bbt_j=(bbt_j+1);
	}
	o->__m_seltra_substratemap_le =bbt_i;
	o->__m_seltra_substratemap_rc =0;
	return 0;
}
struct BBDebugScope_13 _m_seltra_substratemap_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"substratemap",
	{
		{
			BBDEBUGDECL_FIELD,
			"v",
			"[]:substrate",
			.field_offset=offsetof(struct _m_seltra_substratemap_obj,__m_seltra_substratemap_v)
		},
		{
			BBDEBUGDECL_FIELD,
			"k",
			"[]i",
			.field_offset=offsetof(struct _m_seltra_substratemap_obj,__m_seltra_substratemap_k)
		},
		{
			BBDEBUGDECL_FIELD,
			"le",
			"i",
			.field_offset=offsetof(struct _m_seltra_substratemap_obj,__m_seltra_substratemap_le)
		},
		{
			BBDEBUGDECL_FIELD,
			"rc",
			"i",
			.field_offset=offsetof(struct _m_seltra_substratemap_obj,__m_seltra_substratemap_rc)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_substratemap_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"fetch",
			"(i):substrate",
			.var_address=(void*)&__m_seltra_substratemap_fetch_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"vfetch",
			"(i):substrate",
			.var_address=(void*)&__m_seltra_substratemap_vfetch_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"kfetch",
			"(i)i",
			.var_address=(void*)&__m_seltra_substratemap_kfetch_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"insert",
			"(i,:substrate)i",
			.var_address=(void*)&__m_seltra_substratemap_insert_iTsubstrate
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"remove",
			"(i)i",
			.var_address=(void*)&__m_seltra_substratemap_remove_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"iter",
			"()i",
			.var_address=(void*)&__m_seltra_substratemap_iter
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"fastsort",
			"()i",
			.var_address=(void*)&__m_seltra_substratemap_fastsort
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"orderedsort",
			"()i",
			.var_address=(void*)&__m_seltra_substratemap_orderedsort
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_substratemap _m_seltra_substratemap={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_substratemap_scope,
	sizeof(struct _m_seltra_substratemap_obj),
	(void (*)(BBOBJECT))__m_seltra_substratemap_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_substratemap_obj,__m_seltra_substratemap_rc) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_substratemap_fetch_i
	,__m_seltra_substratemap_vfetch_i
	,__m_seltra_substratemap_kfetch_i
	,__m_seltra_substratemap_insert_iTsubstrate
	,__m_seltra_substratemap_remove_i
	,__m_seltra_substratemap_iter
	,__m_seltra_substratemap_fastsort
	,__m_seltra_substratemap_orderedsort
};

struct _m_seltra_substratemap_obj* _m_seltra_smap=(struct _m_seltra_substratemap_obj*)(&bbNullObject);
BBARRAY _m_seltra_chem=(&bbEmptyArray);
BBINT _m_seltra_create_chem_numbers(){
	((BBINT*)BBARRAYDATA(_m_seltra_chem,1))[0U]=4;
	((BBINT*)BBARRAYDATA(_m_seltra_chem,1))[1U]=10;
	((BBINT*)BBARRAYDATA(_m_seltra_chem,1))[2U]=(((BBINT*)BBARRAYDATA(_m_seltra_chem,1))[1U]+brl_random_Rand(5,7));
	((BBINT*)BBARRAYDATA(_m_seltra_chem,1))[3U]=(((BBINT*)BBARRAYDATA(_m_seltra_chem,1))[2U]+brl_random_Rand(6,8));
	return 0;
}
BBFLOAT _m_seltra_colfunc(BBFLOAT bbt_x){
	while(bbt_x>1.00000000f){
		bbt_x=(bbt_x-1.00000000f);
	}
	if(bbt_x<0.333333343f){
		return 0.0f;
	}
	bbt_x=(bbt_x-0.333333343f);
	if(bbt_x<0.0833333358f){
		return (bbt_x*9.0f);
	}
	bbt_x=(bbt_x-0.0833333358f);
	if(bbt_x<0.0833333358f){
		return (0.75f+(bbt_x*3.00000000f));
	}
	bbt_x=(bbt_x-0.0833333358f);
	if(bbt_x<0.333333343f){
		return 1.0f;
	}
	bbt_x=(bbt_x-0.333333343f);
	if(bbt_x<0.0833333358f){
		return (1.0f-(bbt_x*3.00000000f));
	}
	bbt_x=(bbt_x-0.0833333358f);
	return (0.75f-(bbt_x*9.0f));
}
BBINT _m_seltra_create_block_mix(){
	BBINT bbt_i=0;
	BBINT bbt_j=0;
	BBINT bbt_k=0;
	BBINT bbt_grey=0;
	struct _m_seltra_btemplate_obj* bbt_bt=(struct _m_seltra_btemplate_obj*)(&bbNullObject);
	for(bbt_i=0;(bbt_i<=5);bbt_i=(bbt_i+1)){
		bbt_j=0;
		if(bbt_i==0){
			bbt_grey=1;
		}else{
			bbt_grey=0;
		}
		while(bbt_j<16){
			bbt_bt=(struct _m_seltra_btemplate_obj*)(struct _m_seltra_btemplate_obj*)bbObjectAtomicNew((BBClass *)&_m_seltra_btemplate);
			bbt_bt->__m_seltra_btemplate_btype =bbt_i;
			((struct _m_seltra_btemplate_obj**)BBARRAYDATA(_m_seltra_btarray,1))[((BBUINT)bbt_k)]=(struct _m_seltra_btemplate_obj*)bbt_bt;
			bbt_bt->__m_seltra_btemplate_id =bbt_k;
			bbt_bt->__m_seltra_btemplate_bonds2 =bbt_j;
			(bbt_bt)->clas->m_create_block_image_i((struct _m_seltra_btemplate_obj*)bbt_bt,bbt_grey);
			bbt_k=(bbt_k+1);
			bbt_j=(bbt_j+1);
			if(bbt_grey==1){
				break;
			}
		}
	}
	return 0;
}
BBINT _m_seltra_remove_block_image_templates(){
	BBINT bbt_i=0;
	for(bbt_i=0;(bbt_i<=60);bbt_i=(bbt_i+1)){
		((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)bbt_i)]=(struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)(bbt_i+8))];
	}
	bbt_i=0;
	while(((BBObject*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)bbt_i)])!= &bbNullObject){
		bbt_i=(bbt_i+1);
	}
	_m_seltra_noi=bbt_i;
	return 0;
}
struct brl_max2d_image_TImage_obj* _m_seltra_sub0=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_loadimage2(BBSTRING bbt_fn){
	((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)_m_seltra_noi)]=(struct brl_max2d_image_TImage_obj*)brl_max2d_LoadImage((BBOBJECT)brl_pixmap_MaskPixmap((struct brl_pixmap_TPixmap_obj*)brl_pixmap_LoadPixmap((BBOBJECT)bbt_fn),0,0,0),-1);
	_m_seltra_noi=(_m_seltra_noi+1);
	return (struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)(_m_seltra_noi-1))];
}
struct brl_max2d_image_TImage_obj* _m_seltra_subd=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
struct brl_max2d_image_TImage_obj* _m_seltra_gene=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
BBINT _m_seltra_wallblock(BBINT bbt_x,BBINT bbt_y,BBINT bbt_u){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(struct _m_seltra_block_obj*)bbObjectNew((BBClass *)&_m_seltra_block);
	bbt_b->__m_seltra_block_x =bbt_x;
	bbt_b->__m_seltra_block_y =bbt_y;
	bbt_b->__m_seltra_block_btype =0;
	bbt_b->__m_seltra_block_image =(struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[1U];
	(_m_seltra_bmap)->clas->m_insert_iTblock((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_x+(bbt_y<<10)),(struct _m_seltra_block_obj*)bbt_b);
	(_m_seltra_wallgroup)->clas->m_add_Tblock((struct _m_seltra_blockarray_obj*)_m_seltra_wallgroup,(struct _m_seltra_block_obj*)bbt_b);
	return 0;
}
BBINT _m_seltra_gen_maze_map(BBINT bbt_xs,BBINT bbt_ys,BBINT bbt_xf,BBINT bbt_yf,BBINT bbt_mx,BBINT bbt_my){
	_m_seltra_wallgroup=(struct _m_seltra_blockarray_obj*)(struct _m_seltra_blockarray_obj*)bbObjectNew((BBClass *)&_m_seltra_blockarray);
	_m_seltra_wallgroup->__m_seltra_blockarray_ba =bbArraySlice(":block",_m_seltra_wallgroup->__m_seltra_blockarray_ba ,0,999999);
	_m_seltra_bmap=(struct _m_seltra_fastblockmap_obj*)(struct _m_seltra_fastblockmap_obj*)bbObjectNew((BBClass *)&_m_seltra_fastblockmap);
	_m_seltra_thingmap=(struct _m_seltra_fastintmap_obj*)(struct _m_seltra_fastintmap_obj*)bbObjectNew((BBClass *)&_m_seltra_fastintmap);
	BBARRAY volatile bbt_m=bbArrayNew1D("b", (bbt_mx*bbt_my));
	BBINT bbt_d=0;
	BBINT bbt_ok=0;
	BBBYTE bbt_k=0;
	BBINT bbt_xv=0;
	BBINT bbt_yv=0;
	BBINT bbt_x=0;
	BBINT bbt_y=0;
	BBINT bbt_x2=0;
	BBINT bbt_y2=0;
	BBINT bbt_i=0;
	BBINT bbt_j=0;
	BBARRAY volatile bbt_xs2=bbArrayNew1D("i", 6);
	BBARRAY volatile bbt_ys2=bbArrayNew1D("i", 6);
	((BBINT*)BBARRAYDATA(bbt_xs2,1))[0U]=bbt_xs;
	((BBINT*)BBARRAYDATA(bbt_ys2,1))[0U]=bbt_ys;
	((BBINT*)BBARRAYDATA(bbt_xs2,1))[1U]=bbt_xf;
	((BBINT*)BBARRAYDATA(bbt_ys2,1))[1U]=bbt_yf;
	((BBINT*)BBARRAYDATA(bbt_xs2,1))[2U]=1;
	((BBINT*)BBARRAYDATA(bbt_ys2,1))[2U]=1;
	((BBINT*)BBARRAYDATA(bbt_xs2,1))[3U]=(bbt_mx-1);
	((BBINT*)BBARRAYDATA(bbt_ys2,1))[3U]=1;
	((BBINT*)BBARRAYDATA(bbt_xs2,1))[4U]=1;
	((BBINT*)BBARRAYDATA(bbt_ys2,1))[4U]=(bbt_my-1);
	((BBINT*)BBARRAYDATA(bbt_xs2,1))[5U]=(bbt_mx-1);
	((BBINT*)BBARRAYDATA(bbt_ys2,1))[5U]=(bbt_my-1);
	bbt_x=bbt_xs;
	bbt_y=bbt_ys;
	while(((BBINT)bbt_k)<6){
		bbt_x=((BBINT*)BBARRAYDATA(bbt_xs2,1))[((BBUINT)bbt_k)];
		bbt_y=((BBINT*)BBARRAYDATA(bbt_ys2,1))[((BBUINT)bbt_k)];
		bbt_i=0;
		bbt_j=0;
		while(((bbt_i<100) || (bbt_ok==0)) && (bbt_j<1024)){
			bbt_d=brl_random_Rand(0,3);
			BBINT bbt_=bbt_d;
			if(bbt_==0){
				bbt_xv=1;
				bbt_yv=0;
			}else{
				if(bbt_==1){
					bbt_xv=-1;
					bbt_yv=0;
				}else{
					if(bbt_==2){
						bbt_xv=0;
						bbt_yv=1;
					}else{
						if(bbt_==3){
							bbt_xv=0;
							bbt_yv=-1;
						}
					}
				}
			}
			while(1){
				((BBBYTE*)BBARRAYDATA(bbt_m,1))[((BBUINT)(bbt_x+(bbt_y*bbt_mx)))]=1;
				bbt_x2=(bbt_x+bbt_xv);
				bbt_y2=(bbt_y+bbt_yv);
				if((((bbt_x2>0) && (bbt_x2<(bbt_mx-1))) && (bbt_y2>0)) && (bbt_y2<(bbt_my-1))){
					if((((BBINT)((BBBYTE*)BBARRAYDATA(bbt_m,1))[((BBUINT)((bbt_x2+bbt_xv)+((bbt_y2+bbt_yv)*bbt_mx)))])==0) || (((BBINT)((BBBYTE*)BBARRAYDATA(bbt_m,1))[((BBUINT)(bbt_x2+(bbt_y2*bbt_mx)))])==1)){
						bbt_x=(bbt_x+bbt_xv);
						bbt_y=(bbt_y+bbt_yv);
					}
				}else{
					break;
				}
				if((bbt_x==bbt_xf) && (bbt_y==bbt_yf)){
					bbt_ok=1;
				}
				bbt_i=(bbt_i+1);
				if(brl_random_Rand(0,2)==1){
					break;
				}
			}
			bbt_j=(bbt_j+1);
		}
		bbt_k=((BBBYTE)(((BBINT)bbt_k)+1));
	}
	BBINT bbt_2=((bbt_mx*bbt_my)-1);
	for(bbt_i=0;(bbt_i<=bbt_2);bbt_i=(bbt_i+1)){
		if(((BBINT)((BBBYTE*)BBARRAYDATA(bbt_m,1))[((BBUINT)bbt_i)])==0){
			_m_seltra_wallblock((bbt_i % bbt_mx),(bbt_i/bbt_mx),0);
		}
	}
	return 0;
}
void __m_seltra_sgroup_New(struct _m_seltra_sgroup_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_sgroup;
	o->__m_seltra_sgroup_slist = (struct _m_seltra_subarray_obj*)(struct _m_seltra_subarray_obj*)bbObjectNew((BBClass *)&_m_seltra_subarray);
	o->__m_seltra_sgroup_xv = 0;
	o->__m_seltra_sgroup_yv = 0;
	o->__m_seltra_sgroup_bittags = 0;
	o->__m_seltra_sgroup_id = 0;
}
BBINT __m_seltra_sgroup_add_Tsubstrate(struct _m_seltra_sgroup_obj* o,struct _m_seltra_substrate_obj* bbt_s){
	(o->__m_seltra_sgroup_slist )->clas->m_add_Tsubstrate((struct _m_seltra_subarray_obj*)o->__m_seltra_sgroup_slist ,(struct _m_seltra_substrate_obj*)bbt_s);
	bbt_s->__m_seltra_substrate_group =(struct _m_seltra_sgroup_obj*)o;
	return 0;
}
BBINT __m_seltra_sgroup_move(struct _m_seltra_sgroup_obj* o){
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[0U];
	struct _m_seltra_substrate_obj* bbt_s2=(struct _m_seltra_substrate_obj*)&bbNullObject;
	BBINT bbt_xt=0;
	BBINT bbt_yt=0;
	BBINT bbt_n=_m_seltra_thingmap->__m_seltra_fastintmap_le ;
	BBINT bbt_i=0;
	BBINT bbt_t=0;
	BBINT bbt_t2=0;
	BBINT bbt_ti=0;
	struct _m_seltra_block_obj* bbt_bi=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct _m_seltra_substrate_obj* bbt_si=(struct _m_seltra_substrate_obj*)(&bbNullObject);
	if((brl_blitz_Abs(o->__m_seltra_sgroup_xv )+brl_blitz_Abs(o->__m_seltra_sgroup_yv ))>1){
		brl_blitz_RuntimeError(&_s4);
	}
	while(((BBObject*)bbt_s)!= &bbNullObject){
		bbt_xt=(bbt_s->__m_seltra_substrate_x +o->__m_seltra_sgroup_xv );
		bbt_yt=(bbt_s->__m_seltra_substrate_y +o->__m_seltra_sgroup_yv );
		if((bbt_xt>=0) && (bbt_yt>=0)){
			bbt_ti=(_m_seltra_thingmap)->clas->m_fetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(bbt_xt+(bbt_yt<<10)));
			bbt_bi=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_xt+(bbt_yt<<10)));
			bbt_si=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_xt+(bbt_yt<<10)));
		}else{
			((struct _m_seltra_sgroup_obj*)o)->clas->m_remove((struct _m_seltra_sgroup_obj*)o);
			return 0;
		}
		if(((BBObject*)bbt_bi)!= &bbNullObject){
			if(bbt_bi->__m_seltra_block_btype ==0){
				o->__m_seltra_sgroup_xv =-o->__m_seltra_sgroup_xv ;
				o->__m_seltra_sgroup_yv =-o->__m_seltra_sgroup_yv ;
				return 0;
			}
		}
		if(((BBObject*)bbt_si)!= &bbNullObject){
			if(bbt_si->__m_seltra_substrate_group !=bbt_s->__m_seltra_substrate_group ){
				o->__m_seltra_sgroup_xv =-o->__m_seltra_sgroup_xv ;
				o->__m_seltra_sgroup_yv =-o->__m_seltra_sgroup_yv ;
				return 0;
			}
		}
		bbt_i=(bbt_i+1);
		bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)];
	}
	bbt_i=0;
	bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[0U];
	while(((BBObject*)bbt_s)!= &bbNullObject){
		(_m_seltra_smap)->clas->m_remove_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_s->__m_seltra_substrate_x +(bbt_s->__m_seltra_substrate_y <<10)));
		bbt_i=(bbt_i+1);
		bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)];
	}
	bbt_i=0;
	bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[0U];
	while(((BBObject*)bbt_s)!= &bbNullObject){
		bbt_s->__m_seltra_substrate_x =(bbt_s->__m_seltra_substrate_x +o->__m_seltra_sgroup_xv );
		bbt_s->__m_seltra_substrate_y =(bbt_s->__m_seltra_substrate_y +o->__m_seltra_sgroup_yv );
		(_m_seltra_smap)->clas->m_insert_iTsubstrate((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_s->__m_seltra_substrate_x +(bbt_s->__m_seltra_substrate_y <<10)),(struct _m_seltra_substrate_obj*)bbt_s);
		bbt_i=(bbt_i+1);
		bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)];
	}
	return 0;
}
BBINT __m_seltra_sgroup_remove(struct _m_seltra_sgroup_obj* o){
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[0U];
	BBINT bbt_i=0;
	while(((BBObject*)bbt_s)!= &bbNullObject){
		(_m_seltra_smap)->clas->m_remove_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_s->__m_seltra_substrate_x +(bbt_s->__m_seltra_substrate_y <<10)));
		struct _m_seltra_redraw_obj* bbt_re=(struct _m_seltra_redraw_obj*)(struct _m_seltra_redraw_obj*)bbObjectAtomicNew((BBClass *)&_m_seltra_redraw);
		bbt_re->__m_seltra_redraw_x =((BBINT*)BBARRAYDATA(bbt_s->__m_seltra_substrate_oldx ,1))[((BBUINT)_m_seltra_frame)];
		bbt_re->__m_seltra_redraw_y =((BBINT*)BBARRAYDATA(bbt_s->__m_seltra_substrate_oldy ,1))[((BBUINT)_m_seltra_frame)];
		bbt_re->__m_seltra_redraw_redraws =2;
		(_m_seltra_rarray)->clas->m_add_Tredraw((struct _m_seltra_redrawarray_obj*)_m_seltra_rarray,(struct _m_seltra_redraw_obj*)bbt_re);
		bbt_re=(struct _m_seltra_redraw_obj*)(struct _m_seltra_redraw_obj*)bbObjectAtomicNew((BBClass *)&_m_seltra_redraw);
		bbt_re->__m_seltra_redraw_x =((BBINT*)BBARRAYDATA(bbt_s->__m_seltra_substrate_oldx ,1))[((BBUINT)(1-((BBINT)_m_seltra_frame)))];
		bbt_re->__m_seltra_redraw_y =((BBINT*)BBARRAYDATA(bbt_s->__m_seltra_substrate_oldy ,1))[((BBUINT)(1-((BBINT)_m_seltra_frame)))];
		bbt_re->__m_seltra_redraw_redraws =2;
		(_m_seltra_rarray)->clas->m_add_Tredraw((struct _m_seltra_redrawarray_obj*)_m_seltra_rarray,(struct _m_seltra_redraw_obj*)bbt_re);
		((struct _m_seltra_substrate_obj**)BBARRAYDATA(_m_seltra_sarray->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_s->__m_seltra_substrate_id )]=(struct _m_seltra_substrate_obj*)&bbNullObject;
		bbt_i=(bbt_i+1);
		bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)];
	}
	((struct _m_seltra_sgroup_obj**)BBARRAYDATA(_m_seltra_sgarray->__m_seltra_subgrouparray_sga ,1))[((BBUINT)o->__m_seltra_sgroup_id )]=(struct _m_seltra_sgroup_obj*)&bbNullObject;
	(_m_seltra_sgarray)->clas->m_ordered_sort_ii((struct _m_seltra_subgrouparray_obj*)_m_seltra_sgarray,0,0);
	return 0;
}
BBINT __m_seltra_sgroup_out_of_bounds_check(struct _m_seltra_sgroup_obj* o){
	BBINT bbt_i=0;
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[0U];
	if(bbt_s!=&bbNullObject){
		do{
			if(!((bbt_s)->clas->m_out_of_bounds((struct _m_seltra_substrate_obj*)bbt_s)!=0)){
				return 0;
			}
			bbt_i=(bbt_i+1);
			bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)];
		}while(!(bbt_s==&bbNullObject));
	}
	return 1;
}
BBINT __m_seltra_sgroup_checkarrows(struct _m_seltra_sgroup_obj* o){
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[0U];
	BBINT bbt_i=0;
	while(((BBObject*)bbt_s)!= &bbNullObject){
		if(bbt_s->__m_seltra_substrate_image ==_m_seltra_subd){
			BBINT bbt_=((_m_seltra_thingmap)->clas->m_fetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(bbt_s->__m_seltra_substrate_x +(bbt_s->__m_seltra_substrate_y <<10))) % 8);
			if(bbt_==1){
				o->__m_seltra_sgroup_xv =0;
				o->__m_seltra_sgroup_yv =-1;
			}else{
				if(bbt_==2){
					o->__m_seltra_sgroup_xv =0;
					o->__m_seltra_sgroup_yv =1;
				}else{
					if(bbt_==3){
						o->__m_seltra_sgroup_xv =-1;
						o->__m_seltra_sgroup_yv =0;
					}else{
						if(bbt_==4){
							o->__m_seltra_sgroup_xv =1;
							o->__m_seltra_sgroup_yv =0;
						}
					}
				}
			}
		}
		bbt_i=(bbt_i+1);
		bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)];
	}
	return 0;
}
BBINT __m_seltra_sgroup_draw(struct _m_seltra_sgroup_obj* o){
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[0U];
	BBINT bbt_i=0;
	if(bbt_s!=&bbNullObject){
		do{
			(bbt_s)->clas->m_draw((struct _m_seltra_substrate_obj*)bbt_s);
			bbt_i=(bbt_i+1);
			bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(o->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)];
		}while(!(bbt_s==&bbNullObject));
	}
	return 0;
}
struct BBDebugScope_12 _m_seltra_sgroup_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"sgroup",
	{
		{
			BBDEBUGDECL_FIELD,
			"slist",
			":subarray",
			.field_offset=offsetof(struct _m_seltra_sgroup_obj,__m_seltra_sgroup_slist)
		},
		{
			BBDEBUGDECL_FIELD,
			"xv",
			"i",
			.field_offset=offsetof(struct _m_seltra_sgroup_obj,__m_seltra_sgroup_xv)
		},
		{
			BBDEBUGDECL_FIELD,
			"yv",
			"i",
			.field_offset=offsetof(struct _m_seltra_sgroup_obj,__m_seltra_sgroup_yv)
		},
		{
			BBDEBUGDECL_FIELD,
			"bittags",
			"i",
			.field_offset=offsetof(struct _m_seltra_sgroup_obj,__m_seltra_sgroup_bittags)
		},
		{
			BBDEBUGDECL_FIELD,
			"id",
			"i",
			.field_offset=offsetof(struct _m_seltra_sgroup_obj,__m_seltra_sgroup_id)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_sgroup_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"add",
			"(:substrate)i",
			.var_address=(void*)&__m_seltra_sgroup_add_Tsubstrate
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"move",
			"()i",
			.var_address=(void*)&__m_seltra_sgroup_move
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"remove",
			"()i",
			.var_address=(void*)&__m_seltra_sgroup_remove
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"out_of_bounds_check",
			"()i",
			.var_address=(void*)&__m_seltra_sgroup_out_of_bounds_check
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"checkarrows",
			"()i",
			.var_address=(void*)&__m_seltra_sgroup_checkarrows
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"draw",
			"()i",
			.var_address=(void*)&__m_seltra_sgroup_draw
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_sgroup _m_seltra_sgroup={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_sgroup_scope,
	sizeof(struct _m_seltra_sgroup_obj),
	(void (*)(BBOBJECT))__m_seltra_sgroup_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_sgroup_obj,__m_seltra_sgroup_id) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_sgroup_add_Tsubstrate
	,__m_seltra_sgroup_move
	,__m_seltra_sgroup_remove
	,__m_seltra_sgroup_out_of_bounds_check
	,__m_seltra_sgroup_checkarrows
	,__m_seltra_sgroup_draw
};

void __m_seltra_substrate_New_iiTTImageTsgroup(struct _m_seltra_substrate_obj* o,BBINT bbt_xs,BBINT bbt_ys,struct brl_max2d_image_TImage_obj* bbt_im,struct _m_seltra_sgroup_obj* bbt_sg) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_substrate;
	o->__m_seltra_substrate_image = (struct brl_max2d_image_TImage_obj*)(&bbNullObject);
	o->__m_seltra_substrate_x = 0;
	o->__m_seltra_substrate_y = 0;
	o->__m_seltra_substrate_bit_tags = 0;
	o->__m_seltra_substrate_id = 0;
	o->__m_seltra_substrate_oldx = bbArrayNew1D("i", 2);
	o->__m_seltra_substrate_oldy = bbArrayNew1D("i", 2);
	o->__m_seltra_substrate_group = (struct _m_seltra_sgroup_obj*)(&bbNullObject);
	o->__m_seltra_substrate_x =bbt_xs;
	o->__m_seltra_substrate_y =bbt_ys;
	o->__m_seltra_substrate_image =(struct brl_max2d_image_TImage_obj*)bbt_im;
	if(bbt_sg==&bbNullObject){
		bbt_sg=(struct _m_seltra_sgroup_obj*)(struct _m_seltra_sgroup_obj*)bbObjectNew((BBClass *)&_m_seltra_sgroup);
		(_m_seltra_sgarray)->clas->m_add_Tsgroup((struct _m_seltra_subgrouparray_obj*)_m_seltra_sgarray,(struct _m_seltra_sgroup_obj*)bbt_sg);
	}
	(bbt_sg)->clas->m_add_Tsubstrate((struct _m_seltra_sgroup_obj*)bbt_sg,(struct _m_seltra_substrate_obj*)o);
	(_m_seltra_sarray)->clas->m_add_Tsubstrate((struct _m_seltra_subarray_obj*)_m_seltra_sarray,(struct _m_seltra_substrate_obj*)o);
}
struct _m_seltra_substrate_obj* __m_seltra_substrate_New_iiTTImageTsgroup_ObjectNew(BBClass * clas,BBINT bbt_xs,BBINT bbt_ys,struct brl_max2d_image_TImage_obj* bbt_im,struct _m_seltra_sgroup_obj* bbt_sg) {
	struct _m_seltra_substrate_obj* o = bbObjectNewNC(clas);
	__m_seltra_substrate_New_iiTTImageTsgroup(o, bbt_xs, bbt_ys, bbt_im, bbt_sg);
	return o;
}
void __m_seltra_substrate_New(struct _m_seltra_substrate_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_substrate;
	o->__m_seltra_substrate_image = (struct brl_max2d_image_TImage_obj*)(&bbNullObject);
	o->__m_seltra_substrate_x = 0;
	o->__m_seltra_substrate_y = 0;
	o->__m_seltra_substrate_bit_tags = 0;
	o->__m_seltra_substrate_id = 0;
	o->__m_seltra_substrate_oldx = bbArrayNew1D("i", 2);
	o->__m_seltra_substrate_oldy = bbArrayNew1D("i", 2);
	o->__m_seltra_substrate_group = (struct _m_seltra_sgroup_obj*)(&bbNullObject);
}
BBINT __m_seltra_substrate_out_of_bounds(struct _m_seltra_substrate_obj* o){
	if((((o->__m_seltra_substrate_x <1) || (o->__m_seltra_substrate_x >1000)) || (o->__m_seltra_substrate_y <1)) || (o->__m_seltra_substrate_y >1000)){
		return 1;
	}
	return 0;
}
BBINT __m_seltra_substrate_draw(struct _m_seltra_substrate_obj* o){
	brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)_m_seltra_blank,(((BBFLOAT)(((BBINT*)BBARRAYDATA(o->__m_seltra_substrate_oldx ,1))[((BBUINT)_m_seltra_frame)]-_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(((BBINT*)BBARRAYDATA(o->__m_seltra_substrate_oldy ,1))[((BBUINT)_m_seltra_frame)]-_m_seltra_camposy))*_m_seltra_zoom),0);
	brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)o->__m_seltra_substrate_image ,(((BBFLOAT)(o->__m_seltra_substrate_x -_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(o->__m_seltra_substrate_y -_m_seltra_camposy))*_m_seltra_zoom),0);
	((BBINT*)BBARRAYDATA(o->__m_seltra_substrate_oldx ,1))[((BBUINT)_m_seltra_frame)]=o->__m_seltra_substrate_x ;
	((BBINT*)BBARRAYDATA(o->__m_seltra_substrate_oldy ,1))[((BBUINT)_m_seltra_frame)]=o->__m_seltra_substrate_y ;
	return 0;
}
BBINT __m_seltra_substrate_Del(struct _m_seltra_substrate_obj* o){
	struct _m_seltra_redraw_obj* bbt_re=(struct _m_seltra_redraw_obj*)(struct _m_seltra_redraw_obj*)bbObjectAtomicNew((BBClass *)&_m_seltra_redraw);
	bbt_re->__m_seltra_redraw_x =((BBINT*)BBARRAYDATA(o->__m_seltra_substrate_oldx ,1))[((BBUINT)_m_seltra_frame)];
	bbt_re->__m_seltra_redraw_y =((BBINT*)BBARRAYDATA(o->__m_seltra_substrate_oldy ,1))[((BBUINT)_m_seltra_frame)];
	bbt_re->__m_seltra_redraw_redraws =2;
	(_m_seltra_rarray)->clas->m_add_Tredraw((struct _m_seltra_redrawarray_obj*)_m_seltra_rarray,(struct _m_seltra_redraw_obj*)bbt_re);
	bbt_re=(struct _m_seltra_redraw_obj*)(struct _m_seltra_redraw_obj*)bbObjectAtomicNew((BBClass *)&_m_seltra_redraw);
	bbt_re->__m_seltra_redraw_x =((BBINT*)BBARRAYDATA(o->__m_seltra_substrate_oldx ,1))[((BBUINT)(1-((BBINT)_m_seltra_frame)))];
	bbt_re->__m_seltra_redraw_y =((BBINT*)BBARRAYDATA(o->__m_seltra_substrate_oldy ,1))[((BBUINT)(1-((BBINT)_m_seltra_frame)))];
	bbt_re->__m_seltra_redraw_redraws =2;
	(_m_seltra_rarray)->clas->m_add_Tredraw((struct _m_seltra_redrawarray_obj*)_m_seltra_rarray,(struct _m_seltra_redraw_obj*)bbt_re);
	(o->__m_seltra_substrate_group )->clas->m_remove((struct _m_seltra_sgroup_obj*)o->__m_seltra_substrate_group );
	((struct _m_seltra_substrate_obj**)BBARRAYDATA(_m_seltra_sarray->__m_seltra_subarray_sa ,1))[((BBUINT)o->__m_seltra_substrate_id )]=(struct _m_seltra_substrate_obj*)&bbNullObject;
	(_m_seltra_smap)->clas->m_remove_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(o->__m_seltra_substrate_x +(o->__m_seltra_substrate_y <<10)));
	return 0;
}
struct BBDebugScope_13 _m_seltra_substrate_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"substrate",
	{
		{
			BBDEBUGDECL_FIELD,
			"image",
			":TImage",
			.field_offset=offsetof(struct _m_seltra_substrate_obj,__m_seltra_substrate_image)
		},
		{
			BBDEBUGDECL_FIELD,
			"x",
			"i",
			.field_offset=offsetof(struct _m_seltra_substrate_obj,__m_seltra_substrate_x)
		},
		{
			BBDEBUGDECL_FIELD,
			"y",
			"i",
			.field_offset=offsetof(struct _m_seltra_substrate_obj,__m_seltra_substrate_y)
		},
		{
			BBDEBUGDECL_FIELD,
			"bit_tags",
			"i",
			.field_offset=offsetof(struct _m_seltra_substrate_obj,__m_seltra_substrate_bit_tags)
		},
		{
			BBDEBUGDECL_FIELD,
			"id",
			"i",
			.field_offset=offsetof(struct _m_seltra_substrate_obj,__m_seltra_substrate_id)
		},
		{
			BBDEBUGDECL_FIELD,
			"oldx",
			"[]i",
			.field_offset=offsetof(struct _m_seltra_substrate_obj,__m_seltra_substrate_oldx)
		},
		{
			BBDEBUGDECL_FIELD,
			"oldy",
			"[]i",
			.field_offset=offsetof(struct _m_seltra_substrate_obj,__m_seltra_substrate_oldy)
		},
		{
			BBDEBUGDECL_FIELD,
			"group",
			":sgroup",
			.field_offset=offsetof(struct _m_seltra_substrate_obj,__m_seltra_substrate_group)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_substrate_New
		},
		{
			BBDEBUGDECL_TYPEFUNCTION,
			"New",
			"(i,i,:TImage,:sgroup):substrate",
			.var_address=(void*)&__m_seltra_substrate_New_iiTTImageTsgroup
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"out_of_bounds",
			"()i",
			.var_address=(void*)&__m_seltra_substrate_out_of_bounds
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"draw",
			"()i",
			.var_address=(void*)&__m_seltra_substrate_draw
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"Del",
			"()i",
			.var_address=(void*)&__m_seltra_substrate_Del
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_substrate _m_seltra_substrate={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_substrate_scope,
	sizeof(struct _m_seltra_substrate_obj),
	(void (*)(BBOBJECT))__m_seltra_substrate_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_substrate_obj,__m_seltra_substrate_group) - sizeof(void*) + sizeof(struct _m_seltra_sgroup_obj*)
	,__m_seltra_substrate_out_of_bounds
	,__m_seltra_substrate_draw
	,__m_seltra_substrate_Del
};

void __m_seltra_redraw_New(struct _m_seltra_redraw_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_redraw;
	o->__m_seltra_redraw_x = 0;
	o->__m_seltra_redraw_y = 0;
	o->__m_seltra_redraw_redraws = 0;
}
struct BBDebugScope_4 _m_seltra_redraw_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"redraw",
	{
		{
			BBDEBUGDECL_FIELD,
			"x",
			"i",
			.field_offset=offsetof(struct _m_seltra_redraw_obj,__m_seltra_redraw_x)
		},
		{
			BBDEBUGDECL_FIELD,
			"y",
			"i",
			.field_offset=offsetof(struct _m_seltra_redraw_obj,__m_seltra_redraw_y)
		},
		{
			BBDEBUGDECL_FIELD,
			"redraws",
			"b",
			.field_offset=offsetof(struct _m_seltra_redraw_obj,__m_seltra_redraw_redraws)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_redraw_New
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_redraw _m_seltra_redraw={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_redraw_scope,
	sizeof(struct _m_seltra_redraw_obj),
	(void (*)(BBOBJECT))__m_seltra_redraw_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_redraw_obj,__m_seltra_redraw_redraws) - sizeof(void*) + sizeof(BBBYTE)
};

BBINT _m_seltra_update_sgroups(){
	BBINT bbt_i=0;
	struct _m_seltra_sgroup_obj* bbt_sg=(struct _m_seltra_sgroup_obj*)(&bbNullObject);
	while(bbt_i<_m_seltra_sgarray->__m_seltra_subgrouparray_le ){
		bbt_sg=(struct _m_seltra_sgroup_obj*)((struct _m_seltra_sgroup_obj**)BBARRAYDATA(_m_seltra_sgarray->__m_seltra_subgrouparray_sga ,1))[((BBUINT)bbt_i)];
		if(((BBObject*)bbt_sg)!= &bbNullObject){
			(bbt_sg)->clas->m_checkarrows((struct _m_seltra_sgroup_obj*)bbt_sg);
			(bbt_sg)->clas->m_move((struct _m_seltra_sgroup_obj*)bbt_sg);
			if((bbt_sg)->clas->m_out_of_bounds_check((struct _m_seltra_sgroup_obj*)bbt_sg)!=0){
				(bbt_sg)->clas->m_remove((struct _m_seltra_sgroup_obj*)bbt_sg);
			}
		}
		bbt_i=(bbt_i+1);
	}
	return 0;
}
void __m_seltra_bgroup_New(struct _m_seltra_bgroup_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_bgroup;
	o->__m_seltra_bgroup_blist = (struct _m_seltra_blockarray_obj*)(struct _m_seltra_blockarray_obj*)bbObjectNew((BBClass *)&_m_seltra_blockarray);
	o->__m_seltra_bgroup_xv = 0;
	o->__m_seltra_bgroup_yv = 0;
	o->__m_seltra_bgroup_bittags = 0;
	o->__m_seltra_bgroup_id = 0;
	o->__m_seltra_bgroup_lastmove = 0;
	o->__m_seltra_bgroup_bref = (struct _m_seltra_block_obj*)(&bbNullObject);
	o->__m_seltra_bgroup_n = 0;
}
BBINT __m_seltra_bgroup_add_Tblock(struct _m_seltra_bgroup_obj* o,struct _m_seltra_block_obj* bbt_b){
	(o->__m_seltra_bgroup_blist )->clas->m_add_Tblock((struct _m_seltra_blockarray_obj*)o->__m_seltra_bgroup_blist ,(struct _m_seltra_block_obj*)bbt_b);
	bbt_b->__m_seltra_block_group =(struct _m_seltra_bgroup_obj*)o;
	return 0;
}
BBINT __m_seltra_bgroup_addNewBlock_ii(struct _m_seltra_bgroup_obj* o,BBINT bbt_x,BBINT bbt_y){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(struct _m_seltra_block_obj*)bbObjectNew((BBClass *)&_m_seltra_block);
	bbt_b->__m_seltra_block_x =bbt_x;
	bbt_b->__m_seltra_block_y =bbt_y;
	((struct _m_seltra_bgroup_obj*)o)->clas->m_add_Tblock((struct _m_seltra_bgroup_obj*)o,(struct _m_seltra_block_obj*)bbt_b);
	return 0;
}
BBINT __m_seltra_bgroup_collide_TblockTblock(struct _m_seltra_bgroup_obj* o,struct _m_seltra_block_obj* bbt_b,struct _m_seltra_block_obj* bbt_b2){
	BBINT bbt_e=0;
	BBINT bbt_m=0;
	BBINT bbt_e2=0;
	BBINT bbt_m2=0;
	BBINT bbt_cv=0;
	BBINT bbt_=bbt_b->__m_seltra_block_btype ;
	if(bbt_==3){
		bbt_e=1;
		bbt_m=0;
	}else{
		if(bbt_==4){
			bbt_e=0;
			bbt_m=1;
		}else{
			if(bbt_==5){
				bbt_e=0;
				bbt_m=-1;
			}
		}
	}
	BBINT bbt_2=bbt_b2->__m_seltra_block_btype ;
	if(bbt_2==3){
		bbt_e2=1;
		bbt_m2=0;
	}else{
		if(bbt_2==4){
			bbt_e2=0;
			bbt_m2=1;
		}else{
			if(bbt_2==5){
				bbt_e2=0;
				bbt_m2=-1;
			}
		}
	}
	struct _m_seltra_bgroup_obj* bbt_g2=(struct _m_seltra_bgroup_obj*)bbt_b2->__m_seltra_block_group ;
	BBINT bbt_3=((o->__m_seltra_bgroup_xv *bbt_g2->__m_seltra_bgroup_xv )+(o->__m_seltra_bgroup_yv *bbt_g2->__m_seltra_bgroup_yv ));
	if(bbt_3==0){
		if(((o->__m_seltra_bgroup_xv *bbt_g2->__m_seltra_bgroup_yv )+(o->__m_seltra_bgroup_yv *bbt_g2->__m_seltra_bgroup_xv ))!=0){
			bbt_cv=o->__m_seltra_bgroup_xv ;
			o->__m_seltra_bgroup_xv =((-o->__m_seltra_bgroup_xv *bbt_e)+(o->__m_seltra_bgroup_yv *bbt_m));
			o->__m_seltra_bgroup_yv =((bbt_cv*bbt_m)-(o->__m_seltra_bgroup_yv *bbt_e));
		}else{
			bbt_g2->__m_seltra_bgroup_xv =((o->__m_seltra_bgroup_xv *bbt_e2)+(o->__m_seltra_bgroup_yv *bbt_m2));
			bbt_g2->__m_seltra_bgroup_yv =((o->__m_seltra_bgroup_xv *bbt_m2)+(o->__m_seltra_bgroup_yv *bbt_e2));
			o->__m_seltra_bgroup_xv =0;
			o->__m_seltra_bgroup_yv =0;
		}
	}else{
		if(bbt_3==1){
			bbt_cv=o->__m_seltra_bgroup_xv ;
			o->__m_seltra_bgroup_xv =((-o->__m_seltra_bgroup_xv *bbt_e)+(o->__m_seltra_bgroup_yv *bbt_m));
			o->__m_seltra_bgroup_yv =((-o->__m_seltra_bgroup_yv *bbt_e)+(bbt_cv*bbt_m));
		}else{
			if(bbt_3==-1){
				bbt_cv=o->__m_seltra_bgroup_xv ;
				o->__m_seltra_bgroup_xv =((-o->__m_seltra_bgroup_xv *bbt_e)+(o->__m_seltra_bgroup_yv *bbt_m));
				o->__m_seltra_bgroup_yv =((-o->__m_seltra_bgroup_yv *bbt_e)+(bbt_cv*bbt_m));
				bbt_cv=bbt_g2->__m_seltra_bgroup_xv ;
				bbt_g2->__m_seltra_bgroup_xv =((-bbt_g2->__m_seltra_bgroup_xv *bbt_e2)+(bbt_g2->__m_seltra_bgroup_yv *bbt_m2));
				bbt_g2->__m_seltra_bgroup_yv =((bbt_cv*bbt_m2)-(bbt_g2->__m_seltra_bgroup_yv *bbt_e2));
			}
		}
	}
	if((brl_blitz_Abs(o->__m_seltra_bgroup_xv )+brl_blitz_Abs(o->__m_seltra_bgroup_yv ))>1){
		brl_blitz_RuntimeError(&_s2);
	}
	if((brl_blitz_Abs(bbt_b2->__m_seltra_block_group ->__m_seltra_bgroup_xv )+brl_blitz_Abs(bbt_b2->__m_seltra_block_group ->__m_seltra_bgroup_yv ))>1){
		brl_blitz_RuntimeError(&_s2);
	}
	return 0;
}
BBINT __m_seltra_bgroup_collision_manager_TblockTblock(struct _m_seltra_bgroup_obj* o,struct _m_seltra_block_obj* bbt_b,struct _m_seltra_block_obj* bbt_b2){
	BBINT bbt_m2=0;
	BBINT bbt_cv=0;
	if(bbt_b2->__m_seltra_block_btype ==0){
		if(bbt_b->__m_seltra_block_btype ==3){
			o->__m_seltra_bgroup_xv =-o->__m_seltra_bgroup_xv ;
			o->__m_seltra_bgroup_yv =-o->__m_seltra_bgroup_yv ;
		}
		if(bbt_b->__m_seltra_block_btype ==4){
			bbt_cv=o->__m_seltra_bgroup_xv ;
			o->__m_seltra_bgroup_xv =-o->__m_seltra_bgroup_yv ;
			o->__m_seltra_bgroup_yv =bbt_cv;
		}
		if(bbt_b->__m_seltra_block_btype ==5){
			bbt_cv=o->__m_seltra_bgroup_xv ;
			o->__m_seltra_bgroup_xv =o->__m_seltra_bgroup_yv ;
			o->__m_seltra_bgroup_yv =-bbt_cv;
		}
		if(bbt_b->__m_seltra_block_btype ==6){
			o->__m_seltra_bgroup_xv =0;
			o->__m_seltra_bgroup_yv =0;
		}
		return 0;
	}
	((struct _m_seltra_bgroup_obj*)o)->clas->m_collide_TblockTblock((struct _m_seltra_bgroup_obj*)o,(struct _m_seltra_block_obj*)bbt_b,(struct _m_seltra_block_obj*)bbt_b2);
	return 0;
}
BBINT __m_seltra_bgroup_push_i(struct _m_seltra_bgroup_obj* o,BBINT bbt_k){
	return 0;
}
BBINT __m_seltra_bgroup_kicked(struct _m_seltra_bgroup_obj* o){
	return 0;
}
struct _m_seltra_block_obj* __m_seltra_bgroup_check_collision_ii(struct _m_seltra_bgroup_obj* o,BBINT bbt_xm,BBINT bbt_ym){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	struct _m_seltra_block_obj* bbt_b2=(struct _m_seltra_block_obj*)(&bbNullObject);
	BBINT bbt_xt=0;
	BBINT bbt_yt=0;
	BBINT bbt_i=0;
	while(((BBObject*)bbt_b)!= &bbNullObject){
		bbt_xt=(bbt_b->__m_seltra_block_x +bbt_xm);
		bbt_yt=(bbt_b->__m_seltra_block_y +bbt_ym);
		if((bbt_xt>=0) && (bbt_yt>=0)){
			bbt_b2=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_xt+(bbt_yt<<10)));
		}else{
			return (struct _m_seltra_block_obj*)&bbNullObject;
		}
		if((((BBObject*)bbt_b2)!= &bbNullObject) && (bbt_b2->__m_seltra_block_group !=o)){
			o->__m_seltra_bgroup_bref =(struct _m_seltra_block_obj*)bbt_b;
			return (struct _m_seltra_block_obj*)bbt_b2;
		}
		bbt_i=(bbt_i+1);
		bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
	}
	return (struct _m_seltra_block_obj*)&bbNullObject;
}
BBINT __m_seltra_bgroup_move(struct _m_seltra_bgroup_obj* o){
	((struct _m_seltra_bgroup_obj*)o)->clas->m_move_ii((struct _m_seltra_bgroup_obj*)o,o->__m_seltra_bgroup_xv ,o->__m_seltra_bgroup_yv );
	return 0;
}
BBINT __m_seltra_bgroup_move_ii(struct _m_seltra_bgroup_obj* o,BBINT bbt_xm,BBINT bbt_ym){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	struct _m_seltra_block_obj* bbt_b2=(struct _m_seltra_block_obj*)&bbNullObject;
	BBINT bbt_xt=0;
	BBINT bbt_yt=0;
	BBINT bbt_n=_m_seltra_bmap->__m_seltra_fastblockmap_le ;
	BBINT bbt_cv=0;
	BBINT bbt_i=0;
	BBINT bbt_xv2=0;
	BBINT bbt_yv2=0;
	if((brl_blitz_Abs(o->__m_seltra_bgroup_xv )+brl_blitz_Abs(o->__m_seltra_bgroup_yv ))>1){
		brl_blitz_RuntimeError(&_s2);
	}
	if(o->__m_seltra_bgroup_lastmove ==_m_seltra_time){
		return 0;
	}
	bbt_b2=(struct _m_seltra_block_obj*)((struct _m_seltra_bgroup_obj*)o)->clas->m_check_collision_ii((struct _m_seltra_bgroup_obj*)o,bbt_xm,bbt_ym);
	if(((BBObject*)bbt_b2)!= &bbNullObject){
		bbt_b=(struct _m_seltra_block_obj*)o->__m_seltra_bgroup_bref ;
	}
	if(((bbt_b2!=&bbNullObject) && (bbt_b2!=bbt_b)) && (bbt_b2->__m_seltra_block_group !=bbt_b->__m_seltra_block_group )){
		if(bbt_b2->__m_seltra_block_btype !=0){
			if((bbt_b)->clas->m_bondcheck_Tblock((struct _m_seltra_block_obj*)bbt_b,(struct _m_seltra_block_obj*)bbt_b2)!=0){
				((struct _m_seltra_bgroup_obj*)o)->clas->m_merge_Tbgroup((struct _m_seltra_bgroup_obj*)o,(struct _m_seltra_bgroup_obj*)bbt_b2->__m_seltra_block_group );
				if((bbt_b->__m_seltra_block_x -bbt_b2->__m_seltra_block_x )==1){
					bbt_b->__m_seltra_block_bonds2 =((unsigned int)(bbt_b->__m_seltra_block_bonds2 )|(unsigned int)(16));
					bbt_b2->__m_seltra_block_bonds2 =((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )|(unsigned int)(64));
				}
				if((bbt_b->__m_seltra_block_y -bbt_b2->__m_seltra_block_y )==1){
					bbt_b->__m_seltra_block_bonds2 =((unsigned int)(bbt_b->__m_seltra_block_bonds2 )|(unsigned int)(8));
					bbt_b2->__m_seltra_block_bonds2 =((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )|(unsigned int)(32));
				}
				if((bbt_b->__m_seltra_block_x -bbt_b2->__m_seltra_block_x )==-1){
					bbt_b->__m_seltra_block_bonds2 =((unsigned int)(bbt_b->__m_seltra_block_bonds2 )|(unsigned int)(64));
					bbt_b2->__m_seltra_block_bonds2 =((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )|(unsigned int)(16));
				}
				if((bbt_b->__m_seltra_block_y -bbt_b2->__m_seltra_block_y )==-1){
					bbt_b->__m_seltra_block_bonds2 =((unsigned int)(bbt_b->__m_seltra_block_bonds2 )|(unsigned int)(32));
					bbt_b2->__m_seltra_block_bonds2 =((unsigned int)(bbt_b2->__m_seltra_block_bonds2 )|(unsigned int)(8));
				}
				return 0;
			}
		}
		if((bbt_b->__m_seltra_block_btype ==2) && (bbt_b2->__m_seltra_block_btype ==0)){
			(bbt_b)->clas->m_repblock((struct _m_seltra_block_obj*)bbt_b);
		}
		((struct _m_seltra_bgroup_obj*)o)->clas->m_collision_manager_TblockTblock((struct _m_seltra_bgroup_obj*)o,(struct _m_seltra_block_obj*)bbt_b,(struct _m_seltra_block_obj*)bbt_b2);
		return 0;
	}
	bbt_i=0;
	bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	while(((BBObject*)bbt_b)!= &bbNullObject){
		if((_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +(bbt_b->__m_seltra_block_y <<10)))==bbt_b){
			(_m_seltra_bmap)->clas->m_remove_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +(bbt_b->__m_seltra_block_y <<10)));
		}
		bbt_b->__m_seltra_block_x =(bbt_b->__m_seltra_block_x +bbt_xm);
		bbt_b->__m_seltra_block_y =(bbt_b->__m_seltra_block_y +bbt_ym);
		(_m_seltra_bmap)->clas->m_insert_iTblock((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +(bbt_b->__m_seltra_block_y <<10)),(struct _m_seltra_block_obj*)bbt_b);
		bbt_i=(bbt_i+1);
		bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
	}
	if((o->__m_seltra_bgroup_xv ==0) && (o->__m_seltra_bgroup_yv ==0)){
		return 0;
	}
	o->__m_seltra_bgroup_lastmove =_m_seltra_time;
	bbt_i=0;
	bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	while(((BBObject*)bbt_b)!= &bbNullObject){
		if(bbt_b->__m_seltra_block_btype !=7){
			return 0;
		}
		bbt_i=(bbt_i+1);
		bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
	}
	o->__m_seltra_bgroup_xv =0;
	o->__m_seltra_bgroup_yv =0;
	return 0;
}
BBINT _m_seltra_bgroup_check_group_vel_i(){
	BBINT bbt_i=0;
	struct _m_seltra_bgroup_obj* bbt_g=(struct _m_seltra_bgroup_obj*)(&bbNullObject);
	while(bbt_i<_m_seltra_garray->__m_seltra_grouparray_le ){
		bbt_g=(struct _m_seltra_bgroup_obj*)((struct _m_seltra_bgroup_obj**)BBARRAYDATA(_m_seltra_garray->__m_seltra_grouparray_ga ,1))[((BBUINT)bbt_i)];
		if((brl_blitz_Abs(bbt_g->__m_seltra_bgroup_xv )+brl_blitz_Abs(bbt_g->__m_seltra_bgroup_yv ))>1){
			brl_blitz_RuntimeError(&_s3);
		}
		bbt_i=(bbt_i+1);
	}
	return 0;
}
BBINT __m_seltra_bgroup_check_substrates(struct _m_seltra_bgroup_obj* o){
	BBINT bbt_i=0;
	BBINT bbt_j=0;
	BBINT bbt_k=0;
	BBINT bbt_ok=0;
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)(&bbNullObject);
	BBARRAY volatile bbt_sl=bbArrayNew1D(":substrate", 10);
	while(((BBObject*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)])!= &bbNullObject){
		bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
		bbt_s=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_b->__m_seltra_block_x +(bbt_b->__m_seltra_block_y <<10)));
		if(((BBObject*)bbt_s)!= &bbNullObject){
			bbt_ok=1;
			BBINT bbt_=bbt_k;
			for(bbt_j=0;(bbt_j<=bbt_);bbt_j=(bbt_j+1)){
				if(((struct _m_seltra_substrate_obj**)BBARRAYDATA(bbt_sl,1))[((BBUINT)bbt_j)]==bbt_s){
					bbt_ok=0;
				}
			}
			if(bbt_ok!=0){
				((struct _m_seltra_bgroup_obj*)o)->clas->m_move_ii((struct _m_seltra_bgroup_obj*)o,bbt_s->__m_seltra_substrate_group ->__m_seltra_sgroup_xv ,bbt_s->__m_seltra_substrate_group ->__m_seltra_sgroup_yv );
				((struct _m_seltra_substrate_obj**)BBARRAYDATA(bbt_sl,1))[((BBUINT)bbt_k)]=(struct _m_seltra_substrate_obj*)bbt_s;
				bbt_k=(bbt_k+1);
			}
		}
		bbt_i=(bbt_i+1);
	}
	return 0;
}
BBINT __m_seltra_bgroup_remove_block_Tblock(struct _m_seltra_bgroup_obj* o,struct _m_seltra_block_obj* bbt_b){
	BBINT bbt_i=0;
	while(bbt_i<o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_le ){
		if(((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)]==bbt_b){
			((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)]=(struct _m_seltra_block_obj*)&bbNullObject;
		}
		bbt_i=(bbt_i+1);
	}
	bbt_b->__m_seltra_block_group =(struct _m_seltra_bgroup_obj*)&bbNullObject;
	return 0;
}
BBINT __m_seltra_bgroup_remove(struct _m_seltra_bgroup_obj* o){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	BBINT bbt_i=0;
	while(((BBObject*)bbt_b)!= &bbNullObject){
		(_m_seltra_bmap)->clas->m_remove_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +(bbt_b->__m_seltra_block_y <<10)));
		struct _m_seltra_redraw_obj* bbt_re=(struct _m_seltra_redraw_obj*)(struct _m_seltra_redraw_obj*)bbObjectAtomicNew((BBClass *)&_m_seltra_redraw);
		bbt_re->__m_seltra_redraw_x =((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldx ,1))[((BBUINT)_m_seltra_frame)];
		bbt_re->__m_seltra_redraw_y =((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldy ,1))[((BBUINT)_m_seltra_frame)];
		bbt_re->__m_seltra_redraw_redraws =2;
		(_m_seltra_rarray)->clas->m_add_Tredraw((struct _m_seltra_redrawarray_obj*)_m_seltra_rarray,(struct _m_seltra_redraw_obj*)bbt_re);
		bbt_re=(struct _m_seltra_redraw_obj*)(struct _m_seltra_redraw_obj*)bbObjectAtomicNew((BBClass *)&_m_seltra_redraw);
		bbt_re->__m_seltra_redraw_x =((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldx ,1))[((BBUINT)(1-((BBINT)_m_seltra_frame)))];
		bbt_re->__m_seltra_redraw_y =((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldy ,1))[((BBUINT)(1-((BBINT)_m_seltra_frame)))];
		bbt_re->__m_seltra_redraw_redraws =2;
		(_m_seltra_rarray)->clas->m_add_Tredraw((struct _m_seltra_redrawarray_obj*)_m_seltra_rarray,(struct _m_seltra_redraw_obj*)bbt_re);
		((struct _m_seltra_block_obj**)BBARRAYDATA(_m_seltra_barray->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_b->__m_seltra_block_id )]=(struct _m_seltra_block_obj*)&bbNullObject;
		bbt_i=(bbt_i+1);
		bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
	}
	((struct _m_seltra_bgroup_obj**)BBARRAYDATA(_m_seltra_garray->__m_seltra_grouparray_ga ,1))[((BBUINT)o->__m_seltra_bgroup_id )]=(struct _m_seltra_bgroup_obj*)&bbNullObject;
	(_m_seltra_garray)->clas->m_ordered_sort_ii((struct _m_seltra_grouparray_obj*)_m_seltra_garray,0,0);
	return 0;
}
BBINT __m_seltra_bgroup_split_aTblockii(struct _m_seltra_bgroup_obj* o,BBARRAY bbt_bl,BBINT bbt_xvn,BBINT bbt_yvn){
	BBINT bbt_i=0;
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct _m_seltra_bgroup_obj* bbt_bg=(struct _m_seltra_bgroup_obj*)(&bbNullObject);
	while(bbt_i<o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_le ){
		if(((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)]==bbt_b){
			((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)]=(struct _m_seltra_block_obj*)&bbNullObject;
			break;
		}
		bbt_i=(bbt_i+1);
	}
	bbt_bg=(struct _m_seltra_bgroup_obj*)(struct _m_seltra_bgroup_obj*)bbObjectNew((BBClass *)&_m_seltra_bgroup);
	bbt_bg->__m_seltra_bgroup_xv =bbt_xvn;
	bbt_bg->__m_seltra_bgroup_yv =bbt_yvn;
	bbt_bg->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba =bbArraySlice(":block",bbt_bg->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,0,10);
	bbt_bg->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba =bbt_bl;
	_m_seltra_bgc=(_m_seltra_bgc+1);
	return 0;
}
struct _m_seltra_bgroup_obj* __m_seltra_bgroup_spawn_ii(struct _m_seltra_bgroup_obj* o,BBINT bbt_xs,BBINT bbt_ys){
	struct _m_seltra_bgroup_obj* bbt_bgn=(struct _m_seltra_bgroup_obj*)(struct _m_seltra_bgroup_obj*)bbObjectNew((BBClass *)&_m_seltra_bgroup);
	BBINT bbt_i=0;
	struct _m_seltra_block_obj* bbt_m=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	while(((BBObject*)bbt_m)!= &bbNullObject){
		bbt_i=(bbt_i+1);
		bbt_m=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
	}
	bbt_bgn->__m_seltra_bgroup_id =_m_seltra_bgc;
	_m_seltra_bgc=(_m_seltra_bgc+1);
	return (struct _m_seltra_bgroup_obj*)(&bbNullObject);
}
BBINT __m_seltra_bgroup_checkarrows(struct _m_seltra_bgroup_obj* o){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	BBINT bbt_i=0;
	while(((BBObject*)bbt_b)!= &bbNullObject){
		if(bbt_b->__m_seltra_block_btype !=0){
			BBINT bbt_=((_m_seltra_thingmap)->clas->m_fetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(bbt_b->__m_seltra_block_x +(bbt_b->__m_seltra_block_y <<10))) % 8);
			if(bbt_==1){
				o->__m_seltra_bgroup_xv =0;
				o->__m_seltra_bgroup_yv =-1;
			}else{
				if(bbt_==2){
					o->__m_seltra_bgroup_xv =0;
					o->__m_seltra_bgroup_yv =1;
				}else{
					if(bbt_==3){
						o->__m_seltra_bgroup_xv =-1;
						o->__m_seltra_bgroup_yv =0;
					}else{
						if(bbt_==4){
							o->__m_seltra_bgroup_xv =1;
							o->__m_seltra_bgroup_yv =0;
						}
					}
				}
			}
		}
		bbt_i=(bbt_i+1);
		bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
	}
	return 0;
}
BBINT __m_seltra_bgroup_out_of_bounds(struct _m_seltra_bgroup_obj* o){
	BBINT bbt_i=0;
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	if(bbt_b!=&bbNullObject){
		do{
			if(!((bbt_b)->clas->m_out_of_bounds((struct _m_seltra_block_obj*)bbt_b)!=0)){
				return 0;
			}
			bbt_i=(bbt_i+1);
			bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
		}while(!(bbt_b==&bbNullObject));
	}
	return 1;
}
BBINT __m_seltra_bgroup_draw(struct _m_seltra_bgroup_obj* o){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	BBINT bbt_i=0;
	if(bbt_b!=&bbNullObject){
		do{
			(bbt_b)->clas->m_draw((struct _m_seltra_block_obj*)bbt_b);
			bbt_i=(bbt_i+1);
			bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(o->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
		}while(!(bbt_b==&bbNullObject));
	}
	return 0;
}
BBINT __m_seltra_bgroup_merge_Tbgroup(struct _m_seltra_bgroup_obj* o,struct _m_seltra_bgroup_obj* bbt_g){
	if(bbt_g==o){
		return 0;
	}
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_g->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[0U];
	BBINT bbt_i=0;
	while(bbt_i<bbt_g->__m_seltra_bgroup_blist ->__m_seltra_blockarray_le ){
		if(((BBObject*)bbt_b)!= &bbNullObject){
			(o->__m_seltra_bgroup_blist )->clas->m_add_Tblock((struct _m_seltra_blockarray_obj*)o->__m_seltra_bgroup_blist ,(struct _m_seltra_block_obj*)bbt_b);
			bbt_b->__m_seltra_block_group =(struct _m_seltra_bgroup_obj*)o;
		}
		bbt_i=(bbt_i+1);
		bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_g->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
	}
	((struct _m_seltra_bgroup_obj**)BBARRAYDATA(_m_seltra_garray->__m_seltra_grouparray_ga ,1))[((BBUINT)bbt_g->__m_seltra_bgroup_id )]=(struct _m_seltra_bgroup_obj*)&bbNullObject;
	return 0;
}
struct BBDebugScope_28 _m_seltra_bgroup_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"bgroup",
	{
		{
			BBDEBUGDECL_FIELD,
			"blist",
			":blockarray",
			.field_offset=offsetof(struct _m_seltra_bgroup_obj,__m_seltra_bgroup_blist)
		},
		{
			BBDEBUGDECL_FIELD,
			"xv",
			"i",
			.field_offset=offsetof(struct _m_seltra_bgroup_obj,__m_seltra_bgroup_xv)
		},
		{
			BBDEBUGDECL_FIELD,
			"yv",
			"i",
			.field_offset=offsetof(struct _m_seltra_bgroup_obj,__m_seltra_bgroup_yv)
		},
		{
			BBDEBUGDECL_FIELD,
			"bittags",
			"i",
			.field_offset=offsetof(struct _m_seltra_bgroup_obj,__m_seltra_bgroup_bittags)
		},
		{
			BBDEBUGDECL_FIELD,
			"id",
			"i",
			.field_offset=offsetof(struct _m_seltra_bgroup_obj,__m_seltra_bgroup_id)
		},
		{
			BBDEBUGDECL_FIELD,
			"lastmove",
			"i",
			.field_offset=offsetof(struct _m_seltra_bgroup_obj,__m_seltra_bgroup_lastmove)
		},
		{
			BBDEBUGDECL_FIELD,
			"bref",
			":block",
			.field_offset=offsetof(struct _m_seltra_bgroup_obj,__m_seltra_bgroup_bref)
		},
		{
			BBDEBUGDECL_FIELD,
			"n",
			"i",
			.field_offset=offsetof(struct _m_seltra_bgroup_obj,__m_seltra_bgroup_n)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_bgroup_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"add",
			"(:block)i",
			.var_address=(void*)&__m_seltra_bgroup_add_Tblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"addNewBlock",
			"(i,i)i",
			.var_address=(void*)&__m_seltra_bgroup_addNewBlock_ii
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"collide",
			"(:block,:block)i",
			.var_address=(void*)&__m_seltra_bgroup_collide_TblockTblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"collision_manager",
			"(:block,:block)i",
			.var_address=(void*)&__m_seltra_bgroup_collision_manager_TblockTblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"push",
			"(i)i",
			.var_address=(void*)&__m_seltra_bgroup_push_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"kicked",
			"()i",
			.var_address=(void*)&__m_seltra_bgroup_kicked
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"check_collision",
			"(i,i):block",
			.var_address=(void*)&__m_seltra_bgroup_check_collision_ii
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"move",
			"()i",
			.var_address=(void*)&__m_seltra_bgroup_move
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"move",
			"(i,i)i",
			.var_address=(void*)&__m_seltra_bgroup_move_ii
		},
		{
			BBDEBUGDECL_TYPEFUNCTION,
			"check_group_vel",
			"()i",
			.var_address=(void*)&_m_seltra_bgroup_check_group_vel_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"check_substrates",
			"()i",
			.var_address=(void*)&__m_seltra_bgroup_check_substrates
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"remove_block",
			"(:block)i",
			.var_address=(void*)&__m_seltra_bgroup_remove_block_Tblock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"remove",
			"()i",
			.var_address=(void*)&__m_seltra_bgroup_remove
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"split",
			"([]:block,i,i)i",
			.var_address=(void*)&__m_seltra_bgroup_split_aTblockii
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"spawn",
			"(i,i):bgroup",
			.var_address=(void*)&__m_seltra_bgroup_spawn_ii
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"checkarrows",
			"()i",
			.var_address=(void*)&__m_seltra_bgroup_checkarrows
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"out_of_bounds",
			"()i",
			.var_address=(void*)&__m_seltra_bgroup_out_of_bounds
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"draw",
			"()i",
			.var_address=(void*)&__m_seltra_bgroup_draw
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"merge",
			"(:bgroup)i",
			.var_address=(void*)&__m_seltra_bgroup_merge_Tbgroup
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_bgroup _m_seltra_bgroup={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_bgroup_scope,
	sizeof(struct _m_seltra_bgroup_obj),
	(void (*)(BBOBJECT))__m_seltra_bgroup_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_bgroup_obj,__m_seltra_bgroup_n) - sizeof(void*) + sizeof(BBINT)
	,__m_seltra_bgroup_add_Tblock
	,__m_seltra_bgroup_addNewBlock_ii
	,__m_seltra_bgroup_collide_TblockTblock
	,__m_seltra_bgroup_collision_manager_TblockTblock
	,__m_seltra_bgroup_push_i
	,__m_seltra_bgroup_kicked
	,__m_seltra_bgroup_check_collision_ii
	,__m_seltra_bgroup_move
	,__m_seltra_bgroup_move_ii
	,_m_seltra_bgroup_check_group_vel_i
	,__m_seltra_bgroup_check_substrates
	,__m_seltra_bgroup_remove_block_Tblock
	,__m_seltra_bgroup_remove
	,__m_seltra_bgroup_split_aTblockii
	,__m_seltra_bgroup_spawn_ii
	,__m_seltra_bgroup_checkarrows
	,__m_seltra_bgroup_out_of_bounds
	,__m_seltra_bgroup_draw
	,__m_seltra_bgroup_merge_Tbgroup
};

BBINT _m_seltra_update_bgroups(){
	BBINT bbt_i=0;
	struct _m_seltra_bgroup_obj* bbt_bg=(struct _m_seltra_bgroup_obj*)(&bbNullObject);
	bbt_i=0;
	while(bbt_i<_m_seltra_garray->__m_seltra_grouparray_le ){
		bbt_bg=(struct _m_seltra_bgroup_obj*)((struct _m_seltra_bgroup_obj**)BBARRAYDATA(_m_seltra_garray->__m_seltra_grouparray_ga ,1))[((BBUINT)bbt_i)];
		if(((BBObject*)bbt_bg)!= &bbNullObject){
			(bbt_bg)->clas->m_checkarrows((struct _m_seltra_bgroup_obj*)bbt_bg);
			(bbt_bg)->clas->m_check_substrates((struct _m_seltra_bgroup_obj*)bbt_bg);
			(bbt_bg)->clas->m_move((struct _m_seltra_bgroup_obj*)bbt_bg);
			if((bbt_bg)->clas->m_out_of_bounds((struct _m_seltra_bgroup_obj*)bbt_bg)!=0){
				(bbt_bg)->clas->m_remove((struct _m_seltra_bgroup_obj*)bbt_bg);
			}
		}
		bbt_i=(bbt_i+1);
	}
	return 0;
}
void __m_seltra_gen_New(struct _m_seltra_gen_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_gen;
	o->__m_seltra_gen_x = 0;
	o->__m_seltra_gen_y = 0;
	o->__m_seltra_gen_bglist = bbArrayNew1D(":bgroup", 100);
	o->__m_seltra_gen_le = 0;
	o->__m_seltra_gen_rate = 0;
	o->__m_seltra_gen_t = 0;
	o->__m_seltra_gen_bitflags = 0;
	o->__m_seltra_gen_n = 0;
	o->__m_seltra_gen_id = 0;
	o->__m_seltra_gen_clist = bbArrayNew1D(":cell", 25);
}
struct _m_seltra_bgroup_obj* __m_seltra_gen_genIsolatedBlock(struct _m_seltra_gen_obj* o){
	struct _m_seltra_bgroup_obj* bbt_bg=(struct _m_seltra_bgroup_obj*)(struct _m_seltra_bgroup_obj*)bbObjectNew((BBClass *)&_m_seltra_bgroup);
	struct _m_seltra_bgroup_obj* bbt_bg2=(struct _m_seltra_bgroup_obj*)(&bbNullObject);
	BBINT bbt_r=0;
	BBINT bbt_xv=0;
	BBINT bbt_yv=0;
	BBINT bbt_tm=(_m_seltra_thingmap)->clas->m_fetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(o->__m_seltra_gen_x +(o->__m_seltra_gen_y <<10)));
	if((bbt_tm<10) && (bbt_tm>0)){
		BBINT bbt_=(bbt_tm % 8);
		if(bbt_==1){
			bbt_yv=-1;
		}else{
			if(bbt_==2){
				bbt_yv=1;
			}else{
				if(bbt_==3){
					bbt_xv=-1;
				}else{
					if(bbt_==4){
						bbt_xv=1;
					}
				}
			}
		}
		if((o->__m_seltra_gen_bitflags !=0) && 1){
			bbt_bg2=(struct _m_seltra_bgroup_obj*)((struct _m_seltra_bgroup_obj**)BBARRAYDATA(o->__m_seltra_gen_bglist ,1))[((BBUINT)brl_random_Rand(0,o->__m_seltra_gen_le ))];
		}
	}
	o->__m_seltra_gen_n =(o->__m_seltra_gen_n -1);
	return (struct _m_seltra_bgroup_obj*)bbt_bg;
}
BBINT __m_seltra_gen_addRandomBlock_Tbgroup(struct _m_seltra_gen_obj* o,struct _m_seltra_bgroup_obj* bbt_bg){
	BBINT bbt_r=brl_random_Rand(bbt_bg->__m_seltra_bgroup_n ,1);
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(bbt_bg->__m_seltra_bgroup_blist ->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_r)];
	BBINT bbt_=brl_random_Rand(4,1);
	if(bbt_==0){
		if((_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((bbt_b->__m_seltra_block_x +1)+(bbt_b->__m_seltra_block_y <<10)))==&bbNullObject){
			(bbt_bg)->clas->m_addNewBlock_ii((struct _m_seltra_bgroup_obj*)bbt_bg,(o->__m_seltra_gen_x +1),o->__m_seltra_gen_y );
		}
	}else{
		if(bbt_==1){
			if((_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((bbt_b->__m_seltra_block_x -1)+(bbt_b->__m_seltra_block_y <<10)))==&bbNullObject){
				(bbt_bg)->clas->m_addNewBlock_ii((struct _m_seltra_bgroup_obj*)bbt_bg,(o->__m_seltra_gen_x -1),o->__m_seltra_gen_y );
			}
		}else{
			if(bbt_==2){
				if((_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +((bbt_b->__m_seltra_block_y +1)<<10)))==&bbNullObject){
					(bbt_bg)->clas->m_addNewBlock_ii((struct _m_seltra_bgroup_obj*)bbt_bg,o->__m_seltra_gen_x ,(o->__m_seltra_gen_y +1));
				}
			}else{
				if(bbt_==3){
					if((_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +((bbt_b->__m_seltra_block_y -1)<<10)))==&bbNullObject){
						(bbt_bg)->clas->m_addNewBlock_ii((struct _m_seltra_bgroup_obj*)bbt_bg,o->__m_seltra_gen_x ,(o->__m_seltra_gen_y -1));
					}
				}
			}
		}
	}
	return 0;
}
BBINT __m_seltra_gen_genRandomBlockGroup_i(struct _m_seltra_gen_obj* o,BBINT bbt_n){
	struct _m_seltra_bgroup_obj* bbt_bg=(struct _m_seltra_bgroup_obj*)((struct _m_seltra_gen_obj*)o)->clas->m_genIsolatedBlock((struct _m_seltra_gen_obj*)o);
	return 0;
}
BBINT __m_seltra_gen_update(struct _m_seltra_gen_obj* o){
	if((_m_seltra_time % o->__m_seltra_gen_rate )==o->__m_seltra_gen_t ){
		((struct _m_seltra_gen_obj*)o)->clas->m_genIsolatedBlock((struct _m_seltra_gen_obj*)o);
	}
	return 0;
}
struct BBDebugScope_15 _m_seltra_gen_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"gen",
	{
		{
			BBDEBUGDECL_FIELD,
			"x",
			"i",
			.field_offset=offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_x)
		},
		{
			BBDEBUGDECL_FIELD,
			"y",
			"i",
			.field_offset=offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_y)
		},
		{
			BBDEBUGDECL_FIELD,
			"bglist",
			"[]:bgroup",
			.field_offset=offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_bglist)
		},
		{
			BBDEBUGDECL_FIELD,
			"le",
			"i",
			.field_offset=offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_le)
		},
		{
			BBDEBUGDECL_FIELD,
			"rate",
			"i",
			.field_offset=offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_rate)
		},
		{
			BBDEBUGDECL_FIELD,
			"t",
			"i",
			.field_offset=offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_t)
		},
		{
			BBDEBUGDECL_FIELD,
			"bitflags",
			"i",
			.field_offset=offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_bitflags)
		},
		{
			BBDEBUGDECL_FIELD,
			"n",
			"i",
			.field_offset=offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_n)
		},
		{
			BBDEBUGDECL_FIELD,
			"id",
			"i",
			.field_offset=offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_id)
		},
		{
			BBDEBUGDECL_FIELD,
			"clist",
			"[]:cell",
			.field_offset=offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_clist)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_gen_New
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"genIsolatedBlock",
			"():bgroup",
			.var_address=(void*)&__m_seltra_gen_genIsolatedBlock
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"addRandomBlock",
			"(:bgroup)i",
			.var_address=(void*)&__m_seltra_gen_addRandomBlock_Tbgroup
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"genRandomBlockGroup",
			"(i)i",
			.var_address=(void*)&__m_seltra_gen_genRandomBlockGroup_i
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"update",
			"()i",
			.var_address=(void*)&__m_seltra_gen_update
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_gen _m_seltra_gen={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_gen_scope,
	sizeof(struct _m_seltra_gen_obj),
	(void (*)(BBOBJECT))__m_seltra_gen_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_gen_obj,__m_seltra_gen_clist) - sizeof(void*) + sizeof(BBARRAY)
	,__m_seltra_gen_genIsolatedBlock
	,__m_seltra_gen_addRandomBlock_Tbgroup
	,__m_seltra_gen_genRandomBlockGroup_i
	,__m_seltra_gen_update
};

BBINT _m_seltra_update_gens(){
	BBINT bbt_i=0;
	while(bbt_i<_m_seltra_genarray->__m_seltra_generatorarray_le ){
		struct _m_seltra_gen_obj* bbt_;
		((bbt_ = ((struct _m_seltra_gen_obj**)BBARRAYDATA(_m_seltra_genarray->__m_seltra_generatorarray_ga ,1))[((BBUINT)bbt_i)])->clas)->m_update((struct _m_seltra_gen_obj*)bbt_);
		bbt_i=(bbt_i+1);
	}
	return 0;
}
BBOBJECT _m_seltra_core_engine_thread(BBOBJECT bbt_data){
	if(_m_seltra_bmap->__m_seltra_fastblockmap_rc >1000){
		(_m_seltra_bmap)->clas->m_orderedsort((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap);
	}
	_m_seltra_update_sgroups();
	_m_seltra_update_bgroups();
	_m_seltra_update_gens();
	_m_seltra_time=(_m_seltra_time+1);
	return (BBOBJECT)&_s24;
}
struct _m_seltra_sgroup_obj* _m_seltra_createsingleSubstrate(BBINT bbt_x,BBINT bbt_y){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_x+(bbt_y<<10)));
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_x+(bbt_y<<10)));
	if(((BBObject*)bbt_b)!= &bbNullObject){
		if(bbt_b->__m_seltra_block_btype ==0){
			return (struct _m_seltra_sgroup_obj*)(&bbNullObject);
		}
	}
	if(((BBObject*)bbt_s)!= &bbNullObject){
		return (struct _m_seltra_sgroup_obj*)(&bbNullObject);
	}
	struct _m_seltra_sgroup_obj* bbt_sg=(struct _m_seltra_sgroup_obj*)(struct _m_seltra_sgroup_obj*)bbObjectNew((BBClass *)&_m_seltra_sgroup);
	_m_seltra_sgc=(_m_seltra_sgc+1);
	bbt_s=(struct _m_seltra_substrate_obj*)__m_seltra_substrate_New_iiTTImageTsgroup_ObjectNew((struct _m_seltra_substrate_obj*)&_m_seltra_substrate,bbt_x,bbt_y,(struct brl_max2d_image_TImage_obj*)_m_seltra_sub0,(struct _m_seltra_sgroup_obj*)bbt_sg);
	(bbt_sg)->clas->m_add_Tsubstrate((struct _m_seltra_sgroup_obj*)bbt_sg,(struct _m_seltra_substrate_obj*)bbt_s);
	(_m_seltra_sgarray)->clas->m_add_Tsgroup((struct _m_seltra_subgrouparray_obj*)_m_seltra_sgarray,(struct _m_seltra_sgroup_obj*)bbt_sg);
	(_m_seltra_sarray)->clas->m_add_Tsubstrate((struct _m_seltra_subarray_obj*)_m_seltra_sarray,(struct _m_seltra_substrate_obj*)bbt_s);
	(_m_seltra_smap)->clas->m_insert_iTsubstrate((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_s->__m_seltra_substrate_x +(bbt_s->__m_seltra_substrate_y <<10)),(struct _m_seltra_substrate_obj*)bbt_s);
	return (struct _m_seltra_sgroup_obj*)bbt_sg;
}
struct _m_seltra_sgroup_obj* _m_seltra_placeSubstrateGuide(BBINT bbt_x,BBINT bbt_y){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_x+(bbt_y<<10)));
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_x+(bbt_y<<10)));
	if(((BBObject*)bbt_b)!= &bbNullObject){
		if(bbt_b->__m_seltra_block_btype ==0){
			return (struct _m_seltra_sgroup_obj*)(&bbNullObject);
		}
	}
	if(((BBObject*)bbt_s)!= &bbNullObject){
		return (struct _m_seltra_sgroup_obj*)(&bbNullObject);
	}
	struct _m_seltra_sgroup_obj* bbt_sg=(struct _m_seltra_sgroup_obj*)(struct _m_seltra_sgroup_obj*)bbObjectNew((BBClass *)&_m_seltra_sgroup);
	bbt_sg->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa =bbArraySlice(":substrate",bbt_sg->__m_seltra_sgroup_slist ->__m_seltra_subarray_sa ,0,10);
	_m_seltra_sgc=(_m_seltra_sgc+1);
	bbt_s=(struct _m_seltra_substrate_obj*)(struct _m_seltra_substrate_obj*)bbObjectNew((BBClass *)&_m_seltra_substrate);
	bbt_s->__m_seltra_substrate_x =bbt_x;
	bbt_s->__m_seltra_substrate_y =bbt_y;
	bbt_s->__m_seltra_substrate_image =(struct brl_max2d_image_TImage_obj*)_m_seltra_subd;
	(bbt_sg)->clas->m_add_Tsubstrate((struct _m_seltra_sgroup_obj*)bbt_sg,(struct _m_seltra_substrate_obj*)bbt_s);
	(_m_seltra_sgarray)->clas->m_add_Tsgroup((struct _m_seltra_subgrouparray_obj*)_m_seltra_sgarray,(struct _m_seltra_sgroup_obj*)bbt_sg);
	(_m_seltra_sarray)->clas->m_add_Tsubstrate((struct _m_seltra_subarray_obj*)_m_seltra_sarray,(struct _m_seltra_substrate_obj*)bbt_s);
	(_m_seltra_smap)->clas->m_insert_iTsubstrate((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_s->__m_seltra_substrate_x +(bbt_s->__m_seltra_substrate_y <<10)),(struct _m_seltra_substrate_obj*)bbt_s);
	return (struct _m_seltra_sgroup_obj*)bbt_sg;
}
BBINT _m_seltra_placegene(BBINT bbt_x,BBINT bbt_y){
	BBINT bbt_tm=(_m_seltra_thingmap)->clas->m_fetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(bbt_x+(bbt_y<<10)));
	if((bbt_tm>0) && (bbt_tm<5)){
		(_m_seltra_thingmap)->clas->m_insert_ii((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(bbt_x+(bbt_y<<10)),(1 || (bbt_tm!=0)));
	}
	struct _m_seltra_gen_obj* bbt_g=(struct _m_seltra_gen_obj*)(struct _m_seltra_gen_obj*)bbObjectNew((BBClass *)&_m_seltra_gen);
	bbt_g->__m_seltra_gen_x =bbt_x;
	bbt_g->__m_seltra_gen_y =bbt_y;
	bbt_g->__m_seltra_gen_rate =5;
	bbt_g->__m_seltra_gen_bitflags =4;
	(_m_seltra_genarray)->clas->m_add_Tgen((struct _m_seltra_generatorarray_obj*)_m_seltra_genarray,(struct _m_seltra_gen_obj*)bbt_g);
	return 0;
}
BBINT _m_seltra_chem_dist(BBINT bbt_x){
	BBINT bbt_d2=0;
	BBINT bbt_i=0;
	BBINT bbt_d=0;
	BBINT bbt_s=0;
	bbt_d2=9999;
	while(bbt_i<4){
		bbt_d=brl_blitz_Abs(bbt_x-((BBINT*)BBARRAYDATA(_m_seltra_chem,1))[((BBUINT)bbt_i)]);
		if(bbt_d<brl_blitz_Abs(bbt_d2)){
			bbt_d2=bbt_d;
		}
		bbt_i=(bbt_i+1);
	}
	return bbt_d2;
}
BBINT _m_seltra_mergeSingleSubstrate(BBINT bbt_x,BBINT bbt_y,struct brl_max2d_image_TImage_obj* bbt_image){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_x+(bbt_y<<10)));
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_x+(bbt_y<<10)));
	struct _m_seltra_substrate_obj* bbt_s2=(struct _m_seltra_substrate_obj*)(&bbNullObject);
	if(((BBObject*)bbt_b)!= &bbNullObject){
		if(bbt_b->__m_seltra_block_btype ==0){
			return 0;
		}
	}
	if(((BBObject*)bbt_s)!= &bbNullObject){
		return 0;
	}
	bbt_s=(struct _m_seltra_substrate_obj*)(struct _m_seltra_substrate_obj*)bbObjectNew((BBClass *)&_m_seltra_substrate);
	bbt_s->__m_seltra_substrate_x =bbt_x;
	bbt_s->__m_seltra_substrate_y =bbt_y;
	bbt_s->__m_seltra_substrate_image =(struct brl_max2d_image_TImage_obj*)bbt_image;
	(_m_seltra_sarray)->clas->m_add_Tsubstrate((struct _m_seltra_subarray_obj*)_m_seltra_sarray,(struct _m_seltra_substrate_obj*)bbt_s);
	(_m_seltra_smap)->clas->m_insert_iTsubstrate((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_s->__m_seltra_substrate_x +(bbt_s->__m_seltra_substrate_y <<10)),(struct _m_seltra_substrate_obj*)bbt_s);
	if(bbt_x>0){
		bbt_s2=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,((_m_seltra_moxc+1)+(_m_seltra_moyc<<10)));
		if(((BBObject*)bbt_s2)!= &bbNullObject){
			bbt_s->__m_seltra_substrate_group =(struct _m_seltra_sgroup_obj*)bbt_s2->__m_seltra_substrate_group ;
			struct _m_seltra_sgroup_obj* bbt_;
			(((struct _m_seltra_sgroup_obj*)(bbt_ = bbt_s->__m_seltra_substrate_group ))->clas)->m_add_Tsubstrate((struct _m_seltra_sgroup_obj*)bbt_,(struct _m_seltra_substrate_obj*)bbt_s);
			return 0;
		}
	}
	if(bbt_y>0){
		bbt_s2=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(_m_seltra_moxc+((_m_seltra_moyc+1)<<10)));
		if(((BBObject*)bbt_s2)!= &bbNullObject){
			bbt_s->__m_seltra_substrate_group =(struct _m_seltra_sgroup_obj*)bbt_s2->__m_seltra_substrate_group ;
			struct _m_seltra_sgroup_obj* bbt_2;
			(((struct _m_seltra_sgroup_obj*)(bbt_2 = bbt_s->__m_seltra_substrate_group ))->clas)->m_add_Tsubstrate((struct _m_seltra_sgroup_obj*)bbt_2,(struct _m_seltra_substrate_obj*)bbt_s);
			return 0;
		}
	}
	if(bbt_x<1000){
		bbt_s2=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,((_m_seltra_moxc-1)+(_m_seltra_moyc<<10)));
		if(((BBObject*)bbt_s2)!= &bbNullObject){
			bbt_s->__m_seltra_substrate_group =(struct _m_seltra_sgroup_obj*)bbt_s2->__m_seltra_substrate_group ;
			struct _m_seltra_sgroup_obj* bbt_3;
			(((struct _m_seltra_sgroup_obj*)(bbt_3 = bbt_s->__m_seltra_substrate_group ))->clas)->m_add_Tsubstrate((struct _m_seltra_sgroup_obj*)bbt_3,(struct _m_seltra_substrate_obj*)bbt_s);
			return 0;
		}
	}
	if(bbt_y<1000){
		bbt_s2=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(_m_seltra_moxc+((_m_seltra_moyc-1)<<10)));
		if(((BBObject*)bbt_s2)!= &bbNullObject){
			bbt_s->__m_seltra_substrate_group =(struct _m_seltra_sgroup_obj*)bbt_s2->__m_seltra_substrate_group ;
			struct _m_seltra_sgroup_obj* bbt_4;
			(((struct _m_seltra_sgroup_obj*)(bbt_4 = bbt_s->__m_seltra_substrate_group ))->clas)->m_add_Tsubstrate((struct _m_seltra_sgroup_obj*)bbt_4,(struct _m_seltra_substrate_obj*)bbt_s);
			return 0;
		}
	}
	return 0;
}
BBINT _m_seltra_mouse_input_map(){
	BBINT bbt_mozd=0;
	BBFLOAT bbt_mozn=.00000000f;
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(&bbNullObject);
	BBINT bbt_prox=0;
	_m_seltra_moxc=((BBINT)((((BBFLOAT)_m_seltra_mox)/_m_seltra_zoom)+((BBFLOAT)_m_seltra_camposx)));
	_m_seltra_moyc=((BBINT)((((BBFLOAT)_m_seltra_moy)/_m_seltra_zoom)+((BBFLOAT)_m_seltra_camposy)));
	bbt_mozd=(_m_seltra_moz-_m_seltra_mozo);
	if((_m_seltra_mozu+((BBFLOAT)bbt_mozd))<-9.00000000f){
		bbt_mozn=-9.00000000f;
	}else{
		bbt_mozn=(_m_seltra_mozu+((BBFLOAT)bbt_mozd));
	}
	if(_m_seltra_mozu!=bbt_mozn){
		_m_seltra_mozu=bbt_mozn;
		_m_seltra_zoom=(30.0000000f*(1.0f+(_m_seltra_mozu/10.0f)));
		_m_seltra_redraw_map=3;
		brl_max2d_SetScale((_m_seltra_zoom/30.0f),(_m_seltra_zoom/30.0f));
		_m_seltra_camposx=((BBINT)(((BBFLOAT)_m_seltra_moxc)-(((BBFLOAT)brl_graphics_GraphicsWidth())/(2.0f*_m_seltra_zoom))));
		_m_seltra_camposy=((BBINT)(((BBFLOAT)_m_seltra_moyc)-(((BBFLOAT)brl_graphics_GraphicsHeight())/(2.0f*_m_seltra_zoom))));
		brl_system_MoveMouse((brl_graphics_GraphicsWidth()/2),(brl_graphics_GraphicsHeight()/2));
	}
	if(_m_seltra_moxc<0){
		_m_seltra_moxc=0;
	}
	if(_m_seltra_moyc<0){
		_m_seltra_moyc=0;
	}
	if(brl_polledinput_MouseHit(1)!=0){
		if(_m_seltra_smt<=55){
			bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)));
			if(!(((BBObject*)bbt_b)!= &bbNullObject)){
				if(_m_seltra_smi==_m_seltra_sub0){
					_m_seltra_createsingleSubstrate(_m_seltra_moxc,_m_seltra_moyc);
					return 0;
				}
				if(_m_seltra_smi==_m_seltra_subd){
					_m_seltra_placeSubstrateGuide(_m_seltra_moxc,_m_seltra_moyc);
					return 0;
				}
				if(_m_seltra_smi==_m_seltra_gene){
					brl_blitz_DebugStop();
					_m_seltra_placegene(_m_seltra_moxc,_m_seltra_moyc);
					return 0;
				}
				struct _m_seltra_btemplate_obj* bbt_;
				((bbt_ = ((struct _m_seltra_btemplate_obj**)BBARRAYDATA(_m_seltra_btarray,1))[((BBUINT)_m_seltra_smt)])->clas)->m_createsingleblock_iiii((struct _m_seltra_btemplate_obj*)bbt_,_m_seltra_moxc,_m_seltra_moyc,0,0);
			}else{
				(bbt_b)->clas->m_checkchem3_Tblock((struct _m_seltra_block_obj*)bbt_b,(struct _m_seltra_block_obj*)&bbNullObject);
			}
		}
	}
	if(brl_polledinput_MouseHit(2)!=0){
		bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)));
		if(!(((BBObject*)bbt_b)!= &bbNullObject)){
			if(_m_seltra_smt<=3){
				_m_seltra_wallblock(_m_seltra_moxc,_m_seltra_moyc,0);
				return 0;
			}
			bbt_prox=((((BBObject*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((1+_m_seltra_moxc)+(_m_seltra_moyc<<10))))!= &bbNullObject) || (((BBObject*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,((-1+_m_seltra_moxc)+(_m_seltra_moyc<<10))))!= &bbNullObject));
			bbt_prox=(((bbt_prox!=0) || (((BBObject*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(_m_seltra_moxc+((_m_seltra_moyc+1)<<10))))!= &bbNullObject)) || (((BBObject*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(+_m_seltra_moxc+((_m_seltra_moyc-1)<<10))))!= &bbNullObject));
			if((bbt_prox!=0) && (_m_seltra_smt<=30)){
				struct _m_seltra_btemplate_obj* bbt_2;
				((bbt_2 = ((struct _m_seltra_btemplate_obj**)BBARRAYDATA(_m_seltra_btarray,1))[((BBUINT)_m_seltra_smt)])->clas)->m_setbindingblock_ii((struct _m_seltra_btemplate_obj*)bbt_2,_m_seltra_moxc,_m_seltra_moyc);
			}else{
				if(_m_seltra_smt<=31){
					bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)));
					if(!(((BBObject*)bbt_b)!= &bbNullObject)){
						struct _m_seltra_btemplate_obj* bbt_3;
						((bbt_3 = ((struct _m_seltra_btemplate_obj**)BBARRAYDATA(_m_seltra_btarray,1))[((BBUINT)_m_seltra_smt)])->clas)->m_createsingleblock_iiii((struct _m_seltra_btemplate_obj*)bbt_3,_m_seltra_moxc,_m_seltra_moyc,0,0);
					}else{
						(bbt_b)->clas->m_checkchem3_Tblock((struct _m_seltra_block_obj*)bbt_b,(struct _m_seltra_block_obj*)&bbNullObject);
					}
				}
				if(_m_seltra_smi==_m_seltra_sub0){
					_m_seltra_mergeSingleSubstrate(_m_seltra_moxc,_m_seltra_moyc,(struct brl_max2d_image_TImage_obj*)_m_seltra_smi);
				}
				if(_m_seltra_smi==_m_seltra_subd){
					_m_seltra_placeSubstrateGuide(_m_seltra_moxc,_m_seltra_moyc);
				}
			}
		}
	}
	if(brl_polledinput_MouseHit(3)!=0){
		_m_seltra_camposx=((BBINT)(((BBFLOAT)_m_seltra_moxc)-(((BBFLOAT)brl_graphics_GraphicsWidth())/(2.0f*_m_seltra_zoom))));
		_m_seltra_camposy=((BBINT)(((BBFLOAT)_m_seltra_moyc)-(((BBFLOAT)brl_graphics_GraphicsHeight())/(2.0f*_m_seltra_zoom))));
		_m_seltra_redraw_map=3;
		brl_system_MoveMouse((brl_graphics_GraphicsWidth()/2),(brl_graphics_GraphicsHeight()/2));
	}
	return 0;
}
BBINT _m_seltra_mouse_input_editbar(){
	BBINT bbt_w=25;
	BBINT bbt_margin=20;
	BBINT bbt_n=30;
	if(brl_polledinput_MouseHit(1)!=0){
		if(_m_seltra_mox<(_m_seltra_gw-(bbt_margin+(bbt_w*2)))){
			_m_seltra_smt=((0*bbt_n)+((_m_seltra_moy-10)/20));
			_m_seltra_smi=(struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)_m_seltra_smt)];
			return 0;
		}
		if(_m_seltra_mox<(_m_seltra_gw-(bbt_margin+(bbt_w*1)))){
			_m_seltra_smt=((1*bbt_n)+((_m_seltra_moy-10)/20));
			_m_seltra_smi=(struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)_m_seltra_smt)];
			return 0;
		}
		if(_m_seltra_mox<(_m_seltra_gw-(bbt_margin+(bbt_w*0)))){
			_m_seltra_smt=((2*bbt_n)+((_m_seltra_moy-10)/20));
			_m_seltra_smi=(struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)_m_seltra_smt)];
			return 0;
		}
	}
	return 0;
}
BBINT _m_seltra_get_mouse_input(){
	_m_seltra_mozo=_m_seltra_moz;
	_m_seltra_mox=brl_polledinput_MouseX();
	_m_seltra_moy=brl_polledinput_MouseY();
	_m_seltra_moz=brl_polledinput_MouseZ();
	if(_m_seltra_mox<(_m_seltra_gw-100)){
		_m_seltra_mouse_input_map();
	}else{
		_m_seltra_mouse_input_editbar();
	}
	return 0;
}
BBINT _m_seltra_save_map(){
	struct brl_stream_TStream_obj* bbt_out=(struct brl_stream_TStream_obj*)brl_filesystem_WriteFile((BBOBJECT)&_s26);
	if(!(((BBObject*)bbt_out)!= &bbNullObject)){
		brl_filesystem_CreateFile(&_s26);
		bbt_out=(struct brl_stream_TStream_obj*)brl_filesystem_WriteFile((BBOBJECT)&_s26);
	}
	BBINT bbt_i=0;
	brl_stream_WriteInt((struct brl_stream_TStream_obj*)bbt_out,_m_seltra_wallgroup->__m_seltra_blockarray_le );
	BBINT bbt_=(_m_seltra_wallgroup->__m_seltra_blockarray_le -1);
	for(bbt_i=0;(bbt_i<=bbt_);bbt_i=(bbt_i+1)){
		brl_stream_WriteInt((struct brl_stream_TStream_obj*)bbt_out,((struct _m_seltra_block_obj**)BBARRAYDATA(_m_seltra_wallgroup->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)]->__m_seltra_block_x );
		brl_stream_WriteInt((struct brl_stream_TStream_obj*)bbt_out,((struct _m_seltra_block_obj**)BBARRAYDATA(_m_seltra_wallgroup->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)]->__m_seltra_block_y );
	}
	brl_stream_WriteInt((struct brl_stream_TStream_obj*)bbt_out,_m_seltra_thingmap->__m_seltra_fastintmap_le );
	BBINT bbt_2=_m_seltra_thingmap->__m_seltra_fastintmap_le ;
	for(bbt_i=0;(bbt_i<=bbt_2);bbt_i=(bbt_i+1)){
		brl_stream_WriteInt((struct brl_stream_TStream_obj*)bbt_out,(_m_seltra_thingmap)->clas->m_kfetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,bbt_i));
		brl_stream_WriteInt((struct brl_stream_TStream_obj*)bbt_out,(_m_seltra_thingmap)->clas->m_vfetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,bbt_i));
	}
	brl_filesystem_CloseFile((struct brl_stream_TStream_obj*)bbt_out);
	return 0;
}
BBINT _m_seltra_load_map(){
	_m_seltra_wallgroup=(struct _m_seltra_blockarray_obj*)(struct _m_seltra_blockarray_obj*)bbObjectNew((BBClass *)&_m_seltra_blockarray);
	_m_seltra_wallgroup->__m_seltra_blockarray_ba =bbArraySlice(":block",_m_seltra_wallgroup->__m_seltra_blockarray_ba ,0,999999);
	_m_seltra_bmap=(struct _m_seltra_fastblockmap_obj*)(struct _m_seltra_fastblockmap_obj*)bbObjectNew((BBClass *)&_m_seltra_fastblockmap);
	_m_seltra_thingmap=(struct _m_seltra_fastintmap_obj*)(struct _m_seltra_fastintmap_obj*)bbObjectNew((BBClass *)&_m_seltra_fastintmap);
	struct brl_stream_TStream_obj* bbt_in=(struct brl_stream_TStream_obj*)brl_filesystem_ReadFile((BBOBJECT)&_s26);
	if(!(((BBObject*)bbt_in)!= &bbNullObject)){
		return 0;
	}
	BBINT bbt_i=0;
	BBINT bbt_x=0;
	BBINT bbt_y=0;
	BBINT bbt_n=brl_stream_ReadInt((struct brl_stream_TStream_obj*)bbt_in);
	BBINT bbt_=(bbt_n-1);
	for(bbt_i=0;(bbt_i<=bbt_);bbt_i=(bbt_i+1)){
		bbt_x=brl_stream_ReadInt((struct brl_stream_TStream_obj*)bbt_in);
		bbt_y=brl_stream_ReadInt((struct brl_stream_TStream_obj*)bbt_in);
		_m_seltra_wallblock(bbt_x,bbt_y,0);
	}
	bbt_n=brl_stream_ReadInt((struct brl_stream_TStream_obj*)bbt_in);
	BBINT bbt_k=0;
	BBINT bbt_v=0;
	BBINT bbt_2=(bbt_n-1);
	for(bbt_i=0;(bbt_i<=bbt_2);bbt_i=(bbt_i+1)){
		bbt_k=brl_stream_ReadInt((struct brl_stream_TStream_obj*)bbt_in);
		bbt_v=brl_stream_ReadInt((struct brl_stream_TStream_obj*)bbt_in);
		if(bbt_v!=0){
			(_m_seltra_thingmap)->clas->m_insert_ii((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,bbt_k,bbt_v);
		}
	}
	brl_filesystem_CloseFile((struct brl_stream_TStream_obj*)bbt_in);
	return 0;
}
BBINT _m_seltra_get_user_input(){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)));
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(_m_seltra_moxc+(_m_seltra_moyc<<10)));
	BBINT bbt_t=(_m_seltra_thingmap)->clas->m_fetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)));
	BBINT bbt_p=0;
	if(brl_polledinput_KeyHit(112)!=0){
		_m_seltra_save_map();
	}
	if(brl_polledinput_KeyHit(113)!=0){
		_m_seltra_load_map();
	}
	if(brl_polledinput_KeyHit(114)!=0){
		_m_seltra_gen_maze_map(1,1,40,1,40,40);
	}
	if(!(((BBObject*)bbt_b)!= &bbNullObject) || ((((BBObject*)bbt_b)!= &bbNullObject) && (bbt_b->__m_seltra_block_btype !=0))){
		bbt_p=(bbt_t-(bbt_t % 8));
		if(brl_polledinput_KeyHit(87)!=0){
			(_m_seltra_thingmap)->clas->m_insert_ii((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)),((unsigned int)(bbt_p)|(unsigned int)(1)));
		}
		if(brl_polledinput_KeyHit(83)!=0){
			(_m_seltra_thingmap)->clas->m_insert_ii((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)),((unsigned int)(bbt_p)|(unsigned int)(2)));
		}
		if(brl_polledinput_KeyHit(65)!=0){
			(_m_seltra_thingmap)->clas->m_insert_ii((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)),((unsigned int)(bbt_p)|(unsigned int)(3)));
		}
		if(brl_polledinput_KeyHit(68)!=0){
			(_m_seltra_thingmap)->clas->m_insert_ii((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)),((unsigned int)(bbt_p)|(unsigned int)(4)));
		}
	}
	if(brl_polledinput_KeyHit(32)!=0){
		if((bbt_t>=5) && (bbt_t<=9)){
		}
		(_m_seltra_thingmap)->clas->m_remove_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)));
		if((((BBObject*)bbt_b)!= &bbNullObject) && (bbt_b->__m_seltra_block_btype !=0)){
			struct _m_seltra_bgroup_obj* bbt_;
			(((struct _m_seltra_bgroup_obj*)(bbt_ = bbt_b->__m_seltra_block_group ))->clas)->m_remove((struct _m_seltra_bgroup_obj*)bbt_);
		}
		if((((BBObject*)bbt_b)!= &bbNullObject) && (bbt_b->__m_seltra_block_image ==((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[1U])){
			((struct _m_seltra_block_obj**)BBARRAYDATA(_m_seltra_wallgroup->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_b->__m_seltra_block_id )]=(struct _m_seltra_block_obj*)&bbNullObject;
			(_m_seltra_bmap)->clas->m_remove_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_b->__m_seltra_block_x +(bbt_b->__m_seltra_block_y <<10)));
		}
		if(((BBObject*)bbt_s)!= &bbNullObject){
			(bbt_s)->clas->m_Del((struct _m_seltra_substrate_obj*)bbt_s);
		}
	}
	BBINT bbt_old_gamespeedbrake_setting=_m_seltra_gamespeedbrake_setting;
	_m_seltra_gamespeedbrake_setting=((_m_seltra_gamespeedbrake_setting+brl_polledinput_KeyHit(219))-brl_polledinput_KeyHit(221));
	if(_m_seltra_gamespeedbrake_setting!=bbt_old_gamespeedbrake_setting){
		BBINT bbt_2=_m_seltra_gamespeedbrake_setting;
		if(bbt_2==-1){
			_m_seltra_gamespeedbrake_setting=0;
		}else{
			if(bbt_2==0){
			}else{
				if(bbt_2==1){
					_m_seltra_gamespeedbrake=500;
				}else{
					if(bbt_2==2){
						_m_seltra_gamespeedbrake=100;
					}else{
						if(bbt_2==3){
							_m_seltra_gamespeedbrake=20;
						}else{
							if(bbt_2==4){
							}else{
								if(bbt_2==5){
									_m_seltra_gamespeedbrake_setting=4;
								}
							}
						}
					}
				}
			}
		}
	}
	if(_m_seltra_gamespeedbrake<4){
		_m_seltra_gamespeedbrake=4;
	}
	brl_polledinput_FlushKeys(1);
	return 0;
}
BBINT _m_seltra_redraw_cell(BBINT bbt_x,BBINT bbt_y){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(bbt_x+(bbt_y<<10)));
	BBINT bbt_v=(_m_seltra_thingmap)->clas->m_fetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(bbt_x+(bbt_y<<10)));
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(bbt_x+(bbt_y<<10)));
	struct brl_max2d_image_TImage_obj* bbt_im=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
	if(((BBObject*)bbt_b)!= &bbNullObject){
		brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)bbt_b->__m_seltra_block_image ,(((BBFLOAT)(bbt_x-_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(bbt_y-_m_seltra_camposy))*_m_seltra_zoom),0);
		return 0;
	}
	if(!(bbt_v!=0)){
		brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)_m_seltra_blank,(((BBFLOAT)(bbt_x-_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(bbt_y-_m_seltra_camposy))*_m_seltra_zoom),0);
		return 0;
	}
	if(bbt_v!=0){
		if((bbt_v % 8)!=0){
			BBINT bbt_=(bbt_v % 8);
			if(bbt_==1){
				bbt_im=(struct brl_max2d_image_TImage_obj*)_m_seltra_arrown;
			}else{
				if(bbt_==2){
					bbt_im=(struct brl_max2d_image_TImage_obj*)_m_seltra_arrows;
				}else{
					if(bbt_==3){
						bbt_im=(struct brl_max2d_image_TImage_obj*)_m_seltra_arroww;
					}else{
						if(bbt_==4){
							bbt_im=(struct brl_max2d_image_TImage_obj*)_m_seltra_arrowe;
						}
					}
				}
			}
			brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)bbt_im,(((BBFLOAT)(bbt_x-_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(bbt_y-_m_seltra_camposy))*_m_seltra_zoom),0);
		}
	}
	if(((BBObject*)bbt_s)!= &bbNullObject){
		brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)bbt_s->__m_seltra_substrate_image ,(_m_seltra_zoom*((BBFLOAT)(bbt_x-_m_seltra_camposx))),(_m_seltra_zoom*((BBFLOAT)(bbt_y-_m_seltra_camposy))),0);
	}
	return 0;
}
BBINT _m_seltra_redraw3x3(BBINT bbt_x,BBINT bbt_y){
	BBINT bbt_x2=bbt_x;
	BBINT bbt_y2=bbt_y;
	BBINT bbt_v=0;
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(&bbNullObject);
	struct brl_max2d_image_TImage_obj* bbt_im=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
	while(bbt_x2<(bbt_x+3)){
		bbt_y2=bbt_y;
		while(bbt_y2<(bbt_y+3)){
			_m_seltra_redraw_cell(bbt_x2,bbt_y2);
			bbt_y2=(bbt_y2+1);
		}
		bbt_x2=(bbt_x2+1);
	}
	return 0;
}
BBINT _m_seltra_draw_things(){
	BBINT bbt_m=0;
	BBINT bbt_v=0;
	BBINT bbt_i=0;
	struct brl_max2d_image_TImage_obj* bbt_im=(struct brl_max2d_image_TImage_obj*)(&bbNullObject);
	BBINT bbt_n=_m_seltra_thingmap->__m_seltra_fastintmap_le ;
	while(bbt_i<bbt_n){
		bbt_m=(_m_seltra_thingmap)->clas->m_kfetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,bbt_i);
		bbt_v=(_m_seltra_thingmap)->clas->m_fetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,bbt_m);
		if(bbt_v!=0){
			if((bbt_v % 8)!=0){
				BBINT bbt_=(bbt_v % 8);
				if(bbt_==1){
					bbt_im=(struct brl_max2d_image_TImage_obj*)_m_seltra_arrown;
				}else{
					if(bbt_==2){
						bbt_im=(struct brl_max2d_image_TImage_obj*)_m_seltra_arrows;
					}else{
						if(bbt_==3){
							bbt_im=(struct brl_max2d_image_TImage_obj*)_m_seltra_arroww;
						}else{
							if(bbt_==4){
								bbt_im=(struct brl_max2d_image_TImage_obj*)_m_seltra_arrowe;
							}
						}
					}
				}
				brl_max2d_SetMaskColor(255,255,230);
				if((bbt_v % 8)!=0){
					brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)bbt_im,(_m_seltra_zoom*((BBFLOAT)((bbt_m % 1024)-_m_seltra_camposx))),(_m_seltra_zoom*((BBFLOAT)(((unsigned int)(bbt_m)>>(unsigned int)(10))-_m_seltra_camposy))),0);
				}
				if(bbt_v==5){
					brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)_m_seltra_gene,(_m_seltra_zoom*((BBFLOAT)((bbt_m % 1024)-_m_seltra_camposx))),(_m_seltra_zoom*((BBFLOAT)(((unsigned int)(bbt_m)>>(unsigned int)(10))-_m_seltra_camposy))),0);
				}
			}
			if(((unsigned int)(bbt_v)&(unsigned int)(136))==136){
				brl_max2d_SetMaskColor(0,0,0);
				brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)_m_seltra_subd,(_m_seltra_zoom*((BBFLOAT)((bbt_m % 1024)-_m_seltra_camposx))),(_m_seltra_zoom*((BBFLOAT)(((unsigned int)(bbt_m)>>(unsigned int)(10))-_m_seltra_camposy))),0);
			}else{
				if(((unsigned int)(bbt_v)&(unsigned int)(128))!=0){
					brl_max2d_SetMaskColor(0,0,0);
					brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)_m_seltra_sub0,(_m_seltra_zoom*((BBFLOAT)((bbt_m % 1024)-_m_seltra_camposx))),(_m_seltra_zoom*((BBFLOAT)(((unsigned int)(bbt_m)>>(unsigned int)(10))-_m_seltra_camposy))),0);
				}
			}
		}
		bbt_i=(bbt_i+1);
	}
	return 0;
}
BBINT _m_seltra_draw_sarray(){
	BBINT bbt_i=0;
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)(&bbNullObject);
	while(bbt_i<_m_seltra_sarray->__m_seltra_subarray_le ){
		bbt_s=(struct _m_seltra_substrate_obj*)((struct _m_seltra_substrate_obj**)BBARRAYDATA(_m_seltra_sarray->__m_seltra_subarray_sa ,1))[((BBUINT)bbt_i)];
		if(((BBObject*)bbt_s)!= &bbNullObject){
			_m_seltra_redraw_cell(((BBINT*)BBARRAYDATA(bbt_s->__m_seltra_substrate_oldx ,1))[((BBUINT)_m_seltra_frame)],((BBINT*)BBARRAYDATA(bbt_s->__m_seltra_substrate_oldy ,1))[((BBUINT)_m_seltra_frame)]);
			brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)bbt_s->__m_seltra_substrate_image ,(((BBFLOAT)(bbt_s->__m_seltra_substrate_x -_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(bbt_s->__m_seltra_substrate_y -_m_seltra_camposy))*_m_seltra_zoom),0);
			((BBINT*)BBARRAYDATA(bbt_s->__m_seltra_substrate_oldx ,1))[((BBUINT)_m_seltra_frame)]=bbt_s->__m_seltra_substrate_x ;
			((BBINT*)BBARRAYDATA(bbt_s->__m_seltra_substrate_oldy ,1))[((BBUINT)_m_seltra_frame)]=bbt_s->__m_seltra_substrate_y ;
		}
		bbt_i=(bbt_i+1);
	}
	return 0;
}
BBINT _m_seltra_draw_barray(){
	BBINT bbt_i=0;
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(&bbNullObject);
	while(bbt_i<_m_seltra_barray->__m_seltra_blockarray_le ){
		bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(_m_seltra_barray->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
		if(((BBObject*)bbt_b)!= &bbNullObject){
			_m_seltra_redraw_cell(((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldx ,1))[((BBUINT)_m_seltra_frame)],((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldy ,1))[((BBUINT)_m_seltra_frame)]);
			brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)bbt_b->__m_seltra_block_image ,(((BBFLOAT)(bbt_b->__m_seltra_block_x -_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(bbt_b->__m_seltra_block_y -_m_seltra_camposy))*_m_seltra_zoom),0);
			((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldx ,1))[((BBUINT)_m_seltra_frame)]=bbt_b->__m_seltra_block_x ;
			((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldy ,1))[((BBUINT)_m_seltra_frame)]=bbt_b->__m_seltra_block_y ;
		}
		bbt_i=(bbt_i+1);
	}
	return 0;
}
BBINT _m_seltra_draw_walls(){
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(&bbNullObject);
	BBINT bbt_i=0;
	while(bbt_i<_m_seltra_wallgroup->__m_seltra_blockarray_le ){
		bbt_b=(struct _m_seltra_block_obj*)((struct _m_seltra_block_obj**)BBARRAYDATA(_m_seltra_wallgroup->__m_seltra_blockarray_ba ,1))[((BBUINT)bbt_i)];
		if(((BBObject*)bbt_b)!= &bbNullObject){
			brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)_m_seltra_blank,(((BBFLOAT)(((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldx ,1))[((BBUINT)_m_seltra_frame)]-_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldy ,1))[((BBUINT)_m_seltra_frame)]-_m_seltra_camposy))*_m_seltra_zoom),0);
			brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)bbt_b->__m_seltra_block_image ,(((BBFLOAT)(bbt_b->__m_seltra_block_x -_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(bbt_b->__m_seltra_block_y -_m_seltra_camposy))*_m_seltra_zoom),0);
			((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldx ,1))[((BBUINT)_m_seltra_frame)]=bbt_b->__m_seltra_block_x ;
			((BBINT*)BBARRAYDATA(bbt_b->__m_seltra_block_oldy ,1))[((BBUINT)_m_seltra_frame)]=bbt_b->__m_seltra_block_y ;
		}
		bbt_i=(bbt_i+1);
	}
	return 0;
}
BBINT _m_seltra_draw_editbar(){
	BBINT bbt_i=0;
	BBINT bbt_x=0;
	BBINT bbt_y=0;
	brl_max2d_SetColor(0,0,0);
	brl_max2d_DrawRect(((BBFLOAT)_m_seltra_mox),((BBFLOAT)_m_seltra_moy),90.0000000f,90.0000000f);
	brl_max2d_SetMaskColor(0,0,0);
	brl_max2d_SetMaskColor(255,255,230);
	brl_max2d_SetColor(222,222,222);
	brl_max2d_SetScale(1.0f,1.0f);
	struct _m_seltra_substrate_obj* bbt_s=(struct _m_seltra_substrate_obj*)(_m_seltra_smap)->clas->m_fetch_i((struct _m_seltra_substratemap_obj*)_m_seltra_smap,(_m_seltra_moxc+(_m_seltra_moyc<<10)));
	BBINT bbt_t=(_m_seltra_thingmap)->clas->m_fetch_i((struct _m_seltra_fastintmap_obj*)_m_seltra_thingmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)));
	brl_max2d_DrawLine(((BBFLOAT)(_m_seltra_gw-100)),0.000000000f,((BBFLOAT)(_m_seltra_gw-100)),((BBFLOAT)_m_seltra_gh),1);
	brl_max2d_SetColor(0,0,0);
	brl_max2d_DrawRect(((BBFLOAT)(_m_seltra_gw-90)),((BBFLOAT)(_m_seltra_gh-70)),100.000000f,20.0000000f);
	brl_max2d_SetColor(222,222,222);
	brl_max2d_DrawText(bbStringConcat(bbStringConcat(bbStringConcat(bbStringConcat(bbStringFromInt(_m_seltra_moxc),&_s23),bbStringFromInt(_m_seltra_moyc)),&_s23),bbStringFromInt(bbt_t)),((BBFLOAT)(_m_seltra_gw-90)),((BBFLOAT)(_m_seltra_gh-65)));
	struct _m_seltra_block_obj* bbt_b=(struct _m_seltra_block_obj*)(_m_seltra_bmap)->clas->m_fetch_i((struct _m_seltra_fastblockmap_obj*)_m_seltra_bmap,(_m_seltra_moxc+(_m_seltra_moyc<<10)));
	if((((BBObject*)bbt_b)!= &bbNullObject) && (bbt_b->__m_seltra_block_btype !=0)){
		brl_max2d_SetColor(0,0,0);
		brl_max2d_DrawRect(((BBFLOAT)(_m_seltra_gw-90)),((BBFLOAT)(_m_seltra_gh-45)),100.000000f,40.0000000f);
		brl_max2d_SetColor(222,222,222);
		brl_max2d_DrawText(bbStringConcat(bbStringConcat(bbStringConcat(bbStringConcat(bbStringFromInt(bbt_b->__m_seltra_block_btype ),&_s23),bbStringFromInt(bbt_b->__m_seltra_block_id )),&_s23),bbStringFromInt(bbt_b->__m_seltra_block_group ->__m_seltra_bgroup_id )),((BBFLOAT)(_m_seltra_gw-90)),((BBFLOAT)(_m_seltra_gh-45)));
	}
	brl_max2d_SetColor(0,0,0);
	brl_max2d_DrawRect(((BBFLOAT)(_m_seltra_gw-90)),((BBFLOAT)(_m_seltra_gh-20)),100.000000f,20.0000000f);
	if(((BBObject*)bbt_s)!= &bbNullObject){
		brl_max2d_SetColor(222,222,222);
		brl_max2d_DrawText(bbStringConcat(bbStringConcat(bbStringFromInt(bbt_s->__m_seltra_substrate_id +1),&_s23),bbStringFromInt(bbt_t)),((BBFLOAT)(_m_seltra_gw-90)),((BBFLOAT)(_m_seltra_gh-20)));
	}
	brl_max2d_SetColor(222,222,222);
	brl_max2d_SetScale(0.67f,0.67f);
	while(((BBObject*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)bbt_i)])!= &bbNullObject){
		bbt_x=(25*(bbt_i/30));
		bbt_y=((bbt_i*20) % 600);
		brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)bbt_i)],((BBFLOAT)((bbt_x+_m_seltra_gw)-96)),((BBFLOAT)(bbt_y+10)),0);
		bbt_i=(bbt_i+1);
	}
	brl_max2d_SetScale((_m_seltra_zoom/30.0f),(_m_seltra_zoom/30.0f));
	return 0;
}
BBINT _m_seltra_update_display(){
	brl_max2d_SetViewport(0,0,_m_seltra_gw,_m_seltra_gh);
	brl_max2d_SetColor(0,0,0);
	brl_max2d_DrawRect(((BBFLOAT)((BBINT*)BBARRAYDATA(_m_seltra_moxo,1))[((BBUINT)_m_seltra_frame)]),((BBFLOAT)((BBINT*)BBARRAYDATA(_m_seltra_moyo,1))[((BBUINT)_m_seltra_frame)]),50.0000000f,50.0000000f);
	brl_max2d_SetColor(255,255,255);
	brl_max2d_SetViewport(0,0,(_m_seltra_gw-100),_m_seltra_gh);
	if(_m_seltra_mox<(_m_seltra_gw-100)){
		_m_seltra_redraw3x3(((BBINT*)BBARRAYDATA(_m_seltra_moxco,1))[((BBUINT)_m_seltra_frame)],((BBINT*)BBARRAYDATA(_m_seltra_moyco,1))[((BBUINT)_m_seltra_frame)]);
	}
	if(_m_seltra_redraw_map>0){
		brl_max2d_Cls();
	}
	_m_seltra_draw_things();
	_m_seltra_draw_sarray();
	_m_seltra_draw_barray();
	brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)_m_seltra_mousec,(((BBFLOAT)(_m_seltra_moxc-_m_seltra_camposx))*_m_seltra_zoom),(((BBFLOAT)(_m_seltra_moyc-_m_seltra_camposy))*_m_seltra_zoom),0);
	if(_m_seltra_redraw_map>0){
		_m_seltra_draw_walls();
		_m_seltra_redraw_map=(_m_seltra_redraw_map-1);
	}
	(_m_seltra_rarray)->clas->m_do_redraws((struct _m_seltra_redrawarray_obj*)_m_seltra_rarray);
	brl_max2d_SetViewport((_m_seltra_gw-100),0,_m_seltra_gw,_m_seltra_gh);
	_m_seltra_draw_editbar();
	brl_max2d_SetViewport(0,0,_m_seltra_gw,_m_seltra_gh);
	brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)_m_seltra_smi,((BBFLOAT)(_m_seltra_mox+15)),((BBFLOAT)(_m_seltra_moy+15)),0);
	brl_max2d_DrawImage((struct brl_max2d_image_TImage_obj*)_m_seltra_mousep,((BBFLOAT)_m_seltra_mox),((BBFLOAT)_m_seltra_moy),0);
	((BBINT*)BBARRAYDATA(_m_seltra_moxco,1))[((BBUINT)_m_seltra_frame)]=_m_seltra_moxc;
	((BBINT*)BBARRAYDATA(_m_seltra_moyco,1))[((BBUINT)_m_seltra_frame)]=_m_seltra_moyc;
	((BBINT*)BBARRAYDATA(_m_seltra_moxo,1))[((BBUINT)_m_seltra_frame)]=_m_seltra_mox;
	((BBINT*)BBARRAYDATA(_m_seltra_moyo,1))[((BBUINT)_m_seltra_frame)]=_m_seltra_moy;
	brl_graphics_Flip(0);
	if((_m_seltra_gamespeedbrake_setting!=0) && (_m_seltra_gamespeedbrake_setting!=4)){
		while((bbMilliSecs() % _m_seltra_gamespeedbrake)!=0){
		}
		while(brl_blitz_Abs(bbMilliSecs() % _m_seltra_gamespeedbrake)!=1){
		}
	}
	_m_seltra_frame=((BBBYTE)(1-((BBINT)_m_seltra_frame)));
	return 0;
}
void __m_seltra_cell_New(struct _m_seltra_cell_obj* o) {
	bbObjectCtor((BBOBJECT)o);
	o->clas = &_m_seltra_cell;
	o->__m_seltra_cell_x = 0;
	o->__m_seltra_cell_y = 0;
}
struct BBDebugScope_3 _m_seltra_cell_scope ={
	BBDEBUGSCOPE_USERTYPE,
	"cell",
	{
		{
			BBDEBUGDECL_FIELD,
			"x",
			"i",
			.field_offset=offsetof(struct _m_seltra_cell_obj,__m_seltra_cell_x)
		},
		{
			BBDEBUGDECL_FIELD,
			"y",
			"i",
			.field_offset=offsetof(struct _m_seltra_cell_obj,__m_seltra_cell_y)
		},
		{
			BBDEBUGDECL_TYPEMETHOD,
			"New",
			"()i",
			.var_address=(void*)&__m_seltra_cell_New
		},
		BBDEBUGDECL_END
	}
};
struct BBClass__m_seltra_cell _m_seltra_cell={
	&bbObjectClass,
	bbObjectFree,
	(BBDebugScope*)&_m_seltra_cell_scope,
	sizeof(struct _m_seltra_cell_obj),
	(void (*)(BBOBJECT))__m_seltra_cell_New,
	bbObjectDtor,
	bbObjectToString,
	bbObjectCompare,
	bbObjectSendMessage,
	0,
	0,
	offsetof(struct _m_seltra_cell_obj,__m_seltra_cell_y) - sizeof(void*) + sizeof(BBINT)
};

BBINT _m_seltra_placeBigSubstrate(BBINT bbt_x1,BBINT bbt_y1,BBINT bbt_x2,BBINT bbt_y2){
	BBINT bbt_x=0;
	BBINT bbt_y=0;
	BBINT bbt_t=0;
	BBINT bbt_=bbt_y2;
	for(bbt_y=bbt_y1;(bbt_y<=bbt_);bbt_y=(bbt_y+1)){
		BBINT bbt_2=bbt_x2;
		for(bbt_x=bbt_x1;(bbt_x<=bbt_2);bbt_x=(bbt_x+1)){
		}
	}
	return 0;
}
BBFLOAT _m_seltra_colfuncx(BBFLOAT bbt_x){
	while(bbt_x>1.00000000f){
		bbt_x=(bbt_x-1.00000000f);
	}
	if(bbt_x<0.333333343f){
		return 0.0f;
	}
	bbt_x=(bbt_x-0.333333343f);
	if(bbt_x<0.166666672f){
		return (bbt_x*6.0f);
	}
	bbt_x=(bbt_x-0.166666672f);
	if(bbt_x<0.333333343f){
		return 1.0f;
	}
	bbt_x=(bbt_x-0.333333343f);
	return (1.0f-(bbt_x*6.0f));
}
BBINT _m_seltra_demo_color_spread(){
	BBFLOAT bbt_w=.00000000f;
	while(bbt_w<255.0f){
		BBFLOAT bbt_w2=(bbt_w/255.0f);
		BBFLOAT bbt_red=(255.0f*_m_seltra_colfunc(bbt_w2));
		BBFLOAT bbt_gre=(255.0f*_m_seltra_colfunc((85.0f+bbt_w)/255.0f));
		BBFLOAT bbt_blu=(255.0f*_m_seltra_colfunc((170.0f+bbt_w)/255.0f));
		brl_max2d_SetColor(((BBINT)bbt_red),((BBINT)bbt_gre),((BBINT)bbt_blu));
		brl_max2d_DrawRect(bbt_w,50.0000000f,1.00000000f,150.000000f);
		bbt_w=(bbt_w+1.00000000f);
	}
	brl_graphics_Flip(-1);
	while(!(brl_polledinput_MouseHit(1)!=0)){
	}
	return 0;
}
BBOBJECT _m_seltra_io_and_display_thread(BBOBJECT bbt_data){
	_m_seltra_create_chem_numbers();
	_m_seltra_create_block_mix();
	_m_seltra_remove_block_image_templates();
	_m_seltra_gen_maze_map(1,1,40,1,40,40);
	while(!(brl_polledinput_KeyDown(27)!=0)){
		_m_seltra_get_mouse_input();
		_m_seltra_get_user_input();
		_m_seltra_update_display();
	}
	return (BBOBJECT)&_s25;
}
static int _bb_main_inited = 0;
int _bb_main(){
	if (!_bb_main_inited) {
		_bb_main_inited = 1;
		GC_add_roots(&_m_seltra_gw, &_m_seltra_gene + 1);
		__bb_brl_blitz_blitz();
		__bb_brl_appstub_appstub();
		__bb_brl_audio_audio();
		__bb_brl_bank_bank();
		__bb_brl_bankstream_bankstream();
		__bb_brl_base64_base64();
		__bb_brl_basic_basic();
		__bb_brl_bmploader_bmploader();
		__bb_brl_clipboard_clipboard();
		__bb_brl_collections_collections();
		__bb_brl_crypto_crypto();
		__bb_brl_d3d7max2d_d3d7max2d();
		__bb_brl_d3d9max2d_d3d9max2d();
		__bb_brl_data_data();
		__bb_brl_directsoundaudio_directsoundaudio();
		__bb_brl_eventqueue_eventqueue();
		__bb_brl_freeaudioaudio_freeaudioaudio();
		__bb_brl_freetypefont_freetypefont();
		__bb_brl_glgraphics_glgraphics();
		__bb_brl_glmax2d_glmax2d();
		__bb_brl_gnet_gnet();
		__bb_brl_jpgloader_jpgloader();
		__bb_brl_json_json();
		__bb_brl_map_map();
		__bb_brl_matrix_matrix();
		__bb_brl_maxlua_maxlua();
		__bb_brl_maxutil_maxutil();
		__bb_brl_oggloader_oggloader();
		__bb_brl_openalaudio_openalaudio();
		__bb_brl_pngloader_pngloader();
		__bb_brl_quaternion_quaternion();
		__bb_brl_retro_retro();
		__bb_brl_tgaloader_tgaloader();
		__bb_brl_threadpool_threadpool();
		__bb_brl_timer_timer();
		__bb_brl_timerdefault_timerdefault();
		__bb_brl_volumes_volumes();
		__bb_brl_wavloader_wavloader();
		__bb_brl_xml_xml();
		__bb_pub_freejoy_freejoy();
		__bb_pub_freeprocess_freeprocess();
		__bb_pub_glad_glad();
		__bb_pub_macos_macos();
		__bb_pub_nx_nx();
		__bb_pub_opengles_opengles();
		__bb_pub_vulkan_vulkan();
		__bb_pub_xmmintrin_xmmintrin();
		bbObjectRegisterType((BBCLASS)&_m_seltra_btemplate);
		bbObjectRegisterType((BBCLASS)&_m_seltra_grouparray);
		bbObjectRegisterType((BBCLASS)&_m_seltra_blockarray);
		bbObjectRegisterType((BBCLASS)&_m_seltra_subarray);
		bbObjectRegisterType((BBCLASS)&_m_seltra_subgrouparray);
		bbObjectRegisterType((BBCLASS)&_m_seltra_block);
		bbObjectRegisterType((BBCLASS)&_m_seltra_redrawarray);
		bbObjectRegisterType((BBCLASS)&_m_seltra_generatorarray);
		bbObjectRegisterType((BBCLASS)&_m_seltra_fastblockmap);
		bbObjectRegisterType((BBCLASS)&_m_seltra_fastintmap);
		bbObjectRegisterType((BBCLASS)&_m_seltra_substratemap);
		bbObjectRegisterType((BBCLASS)&_m_seltra_sgroup);
		bbObjectRegisterType((BBCLASS)&_m_seltra_substrate);
		bbObjectRegisterType((BBCLASS)&_m_seltra_redraw);
		bbObjectRegisterType((BBCLASS)&_m_seltra_bgroup);
		bbObjectRegisterType((BBCLASS)&_m_seltra_gen);
		bbObjectRegisterType((BBCLASS)&_m_seltra_cell);
		brl_graphics_Graphics(1024,768,0,60,0);
		_m_seltra_gw=brl_graphics_GraphicsWidth();
		_m_seltra_gh=brl_graphics_GraphicsHeight();
		_m_seltra_imagelist=bbArrayNew1D(":TImage", 200);
		brl_max2d_SetMaskColor(0,0,0);
		_m_seltra_blockart=bbArrayNew1D(":TImage", 10);
		brl_max2d_SetMaskColor(255,255,255);
		_m_seltra_blockw=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage3(&_s7);
		_m_seltra_blocko=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage3(&_s8);
		_m_seltra_blockc=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage3(&_s9);
		_m_seltra_blocks=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage3(&_s10);
		_m_seltra_blockq=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage3(&_s11);
		_m_seltra_blockx=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage3(&_s12);
		_m_seltra_blockd=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage3(&_s13);
		_m_seltra_blockb=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage3(&_s14);
		_m_seltra_gencell=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage3(&_s15);
		_m_seltra_btarray=bbArrayNew1D(":btemplate", 100);
		brl_max2d_SetMaskColor(0,0,0);
		_m_seltra_mousep=(struct brl_max2d_image_TImage_obj*)brl_max2d_LoadImage((BBOBJECT)brl_pixmap_MaskPixmap((struct brl_pixmap_TPixmap_obj*)brl_pixmap_LoadPixmap((BBOBJECT)&_s16),0,0,0),-1);
		_m_seltra_mousec=(struct brl_max2d_image_TImage_obj*)brl_max2d_LoadImage((BBOBJECT)brl_pixmap_MaskPixmap((struct brl_pixmap_TPixmap_obj*)brl_pixmap_LoadPixmap((BBOBJECT)&_s17),0,0,0),-1);
		brl_max2d_SetMaskColor(150,150,46);
		_m_seltra_blank=(struct brl_max2d_image_TImage_obj*)brl_max2d_LoadImage((BBOBJECT)&_s18,-1);
		_m_seltra_arroww=(struct brl_max2d_image_TImage_obj*)brl_max2d_LoadImage((BBOBJECT)&_s19,-1);
		_m_seltra_arrowe=(struct brl_max2d_image_TImage_obj*)brl_max2d_LoadImage((BBOBJECT)&_s20,-1);
		_m_seltra_arrown=(struct brl_max2d_image_TImage_obj*)brl_max2d_LoadImage((BBOBJECT)&_s21,-1);
		_m_seltra_arrows=(struct brl_max2d_image_TImage_obj*)brl_max2d_LoadImage((BBOBJECT)&_s22,-1);
		brl_random_SeedRnd(1);
		_m_seltra_moxo=bbArrayNew1D("i", 2);
		_m_seltra_moyo=bbArrayNew1D("i", 2);
		_m_seltra_smi=(struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[0U];
		_m_seltra_moxco=bbArrayNew1D("i", 2);
		_m_seltra_moyco=bbArrayNew1D("i", 2);
		_m_seltra_garray=(struct _m_seltra_grouparray_obj*)(struct _m_seltra_grouparray_obj*)bbObjectNew((BBClass *)&_m_seltra_grouparray);
		_m_seltra_barray=(struct _m_seltra_blockarray_obj*)(struct _m_seltra_blockarray_obj*)bbObjectNew((BBClass *)&_m_seltra_blockarray);
		_m_seltra_sarray=(struct _m_seltra_subarray_obj*)(struct _m_seltra_subarray_obj*)bbObjectNew((BBClass *)&_m_seltra_subarray);
		_m_seltra_sgarray=(struct _m_seltra_subgrouparray_obj*)(struct _m_seltra_subgrouparray_obj*)bbObjectNew((BBClass *)&_m_seltra_subgrouparray);
		_m_seltra_barray->__m_seltra_blockarray_ba =bbArraySlice(":block",_m_seltra_barray->__m_seltra_blockarray_ba ,0,999999);
		_m_seltra_rarray=(struct _m_seltra_redrawarray_obj*)(struct _m_seltra_redrawarray_obj*)bbObjectNew((BBClass *)&_m_seltra_redrawarray);
		_m_seltra_genarray=(struct _m_seltra_generatorarray_obj*)(struct _m_seltra_generatorarray_obj*)bbObjectNew((BBClass *)&_m_seltra_generatorarray);
		_m_seltra_bmap=(struct _m_seltra_fastblockmap_obj*)(struct _m_seltra_fastblockmap_obj*)bbObjectNew((BBClass *)&_m_seltra_fastblockmap);
		_m_seltra_thingmap=(struct _m_seltra_fastintmap_obj*)(struct _m_seltra_fastintmap_obj*)bbObjectNew((BBClass *)&_m_seltra_fastintmap);
		_m_seltra_smap=(struct _m_seltra_substratemap_obj*)(struct _m_seltra_substratemap_obj*)bbObjectNew((BBClass *)&_m_seltra_substratemap);
		_m_seltra_chem=bbArrayNew1D("i", 4);
		_m_seltra_create_chem_numbers();
		_m_seltra_create_block_mix();
		_m_seltra_remove_block_image_templates();
		brl_blitz_DebugStop();
		_m_seltra_sub0=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage2(&_s27);
		_m_seltra_subd=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage2(&_s28);
		_m_seltra_gene=(struct brl_max2d_image_TImage_obj*)_m_seltra_loadimage2(&_s15);
		_m_seltra_gen_maze_map(1,1,40,1,40,40);
		_m_seltra_smi=(struct brl_max2d_image_TImage_obj*)((struct brl_max2d_image_TImage_obj**)BBARRAYDATA(_m_seltra_imagelist,1))[((BBUINT)_m_seltra_smt)];
		while(!(brl_polledinput_KeyDown(27)!=0)){
			if(_m_seltra_gamespeedbrake_setting>0){
				_m_seltra_core_engine_thread((BBOBJECT)&bbEmptyString);
			}
			_m_seltra_get_mouse_input();
			_m_seltra_get_user_input();
			_m_seltra_update_display();
		}
		bbEnd();
		return 0;
	}
	return 0;
}